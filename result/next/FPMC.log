nohup: ignoring input
Namespace(batch_size=1024, data_size=1, drop_portion=1, hist_length=5, learn_rate=0.01, n_epoch=100, n_factor=10, n_neg=1, output='display', regular=0.001, top_n=30, valid_portion=8)
lastfm
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
loading data
reading train data
reading test old data
reading test new data
test_old sample size is: 248402
test_new sample size is: 107182
epoch 0 done
~~~~~~~~~~~~~ testing next item epoch: 0 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00210948 0.00405391 0.00432766 0.00447259 0.00456921 0.00470608
 0.00483893 0.00504424 0.00519722 0.00530189 0.0055072  0.00568433
 0.00574472 0.00580511 0.00651766 0.00663038 0.00665856 0.00667064
 0.00683167 0.00689205 0.00694439 0.00702088 0.00711347 0.00712555
 0.00725437 0.00728658 0.00729463 0.00733891 0.00740332 0.00744761]
MRR_all_avg_next: [0.00210948 0.0030817  0.00317295 0.00320918 0.0032285  0.00325132
 0.00327029 0.00329596 0.00331296 0.00332342 0.00334209 0.00335685
 0.00336149 0.00336581 0.00341331 0.00342036 0.00342201 0.00342268
 0.00343116 0.00343418 0.00343667 0.00344015 0.00344417 0.00344468
 0.00344983 0.00345107 0.00345137 0.00345295 0.00345517 0.00345665]
=========== testing next new item epoch: 0 ===========
recall_all_avg_next_new: [2.79897744e-05 5.59795488e-05 5.59795488e-05 9.32992480e-05
 1.39948872e-04 1.39948872e-04 1.58608722e-04 1.86598496e-04
 1.95928421e-04 2.70567819e-04 2.70567819e-04 3.17217443e-04
 3.45207218e-04 3.45207218e-04 3.63867067e-04 3.63867067e-04
 3.63867067e-04 3.91856842e-04 4.38506466e-04 4.47836390e-04
 4.66496240e-04 4.66496240e-04 4.66496240e-04 4.94486014e-04
 5.03815939e-04 5.31805714e-04 5.59795488e-04 6.53094736e-04
 6.90414435e-04 6.90414435e-04]
MRR_all_avg_next_new: [2.79897744e-05 4.19846616e-05 4.19846616e-05 5.13145864e-05
 6.06445112e-05 6.06445112e-05 6.33102040e-05 6.68089258e-05
 6.78455841e-05 7.53095240e-05 7.53095240e-05 7.91969926e-05
 8.13500522e-05 8.13500522e-05 8.25940422e-05 8.25940422e-05
 8.25940422e-05 8.41490296e-05 8.66042730e-05 8.70707692e-05
 8.79593335e-05 8.79593335e-05 8.79593335e-05 8.91255741e-05
 8.94987711e-05 9.05753009e-05 9.16119592e-05 9.49440752e-05
 9.62309614e-05 9.62309614e-05]
epoch 1 done
epoch 2 done
epoch 3 done
epoch 4 done
epoch 5 done
epoch 6 done
epoch 7 done
epoch 8 done
epoch 9 done
epoch 10 done
epoch 11 done
epoch 12 done
epoch 13 done
epoch 14 done
epoch 15 done
epoch 16 done
epoch 17 done
epoch 18 done
epoch 19 done
~~~~~~~~~~~~~ testing next item epoch: 19 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00531397 0.00953293 0.01168268 0.01369957 0.01547492 0.01724221
 0.01896925 0.02014074 0.02152962 0.02379208 0.02513667 0.02661009
 0.02803923 0.02937577 0.03054726 0.03167446 0.0331036  0.03427911
 0.03527749 0.03609069 0.03701661 0.03791032 0.03872352 0.03988293
 0.04082495 0.04197631 0.04312365 0.04435149 0.04537806 0.04650526]
MRR_all_avg_next: [0.00531397 0.00742345 0.00814003 0.00864425 0.00899932 0.00929387
 0.00954059 0.00968703 0.00984135 0.01006759 0.01018983 0.01031262
 0.01042255 0.01051802 0.01059612 0.01066657 0.01075063 0.01081594
 0.01086849 0.01090915 0.01095324 0.01099386 0.01102922 0.01107753
 0.01111521 0.01115949 0.01120198 0.01124583 0.01128123 0.01131881]
=========== testing next new item epoch: 19 ===========
recall_all_avg_next_new: [0.00022392 0.00030789 0.00058779 0.00082103 0.00105428 0.00113825
 0.00131552 0.00149279 0.0017447  0.00213655 0.00222052 0.00243511
 0.00265903 0.00279898 0.00303223 0.00330279 0.00350805 0.00378795
 0.00397455 0.00414249 0.00463697 0.00475826 0.00506615 0.005486
 0.00570058 0.00606445 0.00637234 0.00655894 0.00668956 0.00688548]
MRR_all_avg_next_new: [0.00022392 0.0002659  0.0003592  0.00041751 0.00046416 0.00047816
 0.00050348 0.00052564 0.00055363 0.00059282 0.00060045 0.00061833
 0.00063556 0.00064555 0.0006611  0.00067801 0.00069009 0.00070564
 0.00071546 0.00072386 0.0007474  0.00075292 0.0007663  0.0007838
 0.00079238 0.00080637 0.00081778 0.00082444 0.00082895 0.00083548]
epoch 20 done
epoch 21 done
epoch 22 done
epoch 23 done
epoch 24 done
epoch 25 done
epoch 26 done
epoch 27 done
epoch 28 done
epoch 29 done
epoch 30 done
epoch 31 done
epoch 32 done
epoch 33 done
epoch 34 done
epoch 35 done
epoch 36 done
epoch 37 done
epoch 38 done
epoch 39 done
epoch 40 done
epoch 41 done
epoch 42 done
epoch 43 done
epoch 44 done
epoch 45 done
epoch 46 done
epoch 47 done
epoch 48 done
epoch 49 done
~~~~~~~~~~~~~ testing next item epoch: 49 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00355472 0.00796692 0.00909413 0.01083727 0.01204097 0.01347413
 0.0148308  0.01604254 0.01724624 0.01915444 0.02008841 0.02134846
 0.02228646 0.02361495 0.02446438 0.02565197 0.02701266 0.0280191
 0.02901345 0.02986288 0.03083309 0.03164628 0.03251584 0.03358669
 0.03441196 0.0354506  0.03622354 0.0372179  0.03818407 0.0391422 ]
MRR_all_avg_next: [0.00355472 0.00576082 0.00613656 0.00657234 0.00681308 0.00705194
 0.00724575 0.00739722 0.00753096 0.00772178 0.00780669 0.0079117
 0.00798385 0.00807874 0.00813537 0.00820959 0.00828964 0.00834555
 0.00839788 0.00844035 0.00848655 0.00852352 0.00856132 0.00860594
 0.00863895 0.0086789  0.00870753 0.00874304 0.00877636 0.0088083 ]
=========== testing next new item epoch: 49 ===========
recall_all_avg_next_new: [0.00019593 0.00051315 0.00069974 0.00089567 0.00135284 0.00147413
 0.00163274 0.00180068 0.00206191 0.00238846 0.00266836 0.0029296
 0.00308821 0.00321882 0.0033681  0.00349872 0.0038346  0.00400254
 0.00419847 0.00442238 0.00460898 0.00486089 0.00500084 0.00532739
 0.00546734 0.00555131 0.00572857 0.00586852 0.00608311 0.00642832]
MRR_all_avg_next_new: [0.00019593 0.00035454 0.00041674 0.00046572 0.00055715 0.00057737
 0.00060003 0.00062102 0.00065004 0.0006827  0.00070814 0.00072991
 0.00074211 0.00075144 0.0007614  0.00076956 0.00078932 0.00079865
 0.00080896 0.00082016 0.00082904 0.00084049 0.00084658 0.00086018
 0.00086578 0.00086901 0.00087558 0.00088057 0.00088797 0.00089948]
epoch 50 done
epoch 51 done
epoch 52 done
epoch 53 done
epoch 54 done
epoch 55 done
epoch 56 done
epoch 57 done
epoch 58 done
epoch 59 done
epoch 60 done
epoch 61 done
epoch 62 done
epoch 63 done
epoch 64 done
epoch 65 done
epoch 66 done
epoch 67 done
epoch 68 done
epoch 69 done
epoch 70 done
epoch 71 done
epoch 72 done
epoch 73 done
epoch 74 done
epoch 75 done
epoch 76 done
epoch 77 done
epoch 78 done
epoch 79 done
epoch 80 done
epoch 81 done
epoch 82 done
epoch 83 done
epoch 84 done
epoch 85 done
epoch 86 done
epoch 87 done
epoch 88 done
epoch 89 done
epoch 90 done
epoch 91 done
epoch 92 done
epoch 93 done
epoch 94 done
epoch 95 done
epoch 96 done
epoch 97 done
epoch 98 done
epoch 99 done
~~~~~~~~~~~~~ testing next item epoch: 99 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00276568 0.00611509 0.00727047 0.00913036 0.01041054 0.01180345
 0.01349828 0.01458925 0.01586944 0.01728247 0.01844188 0.01928728
 0.02025749 0.02097407 0.02210127 0.02317212 0.0238887  0.02496357
 0.0255312  0.02642088 0.02712941 0.02785002 0.02892086 0.0295207
 0.03026546 0.03117527 0.03225417 0.03291439 0.03346591 0.03448442]
MRR_all_avg_next: [0.00276568 0.00444038 0.00482551 0.00529048 0.00554652 0.00577867
 0.00602079 0.00615716 0.0062994  0.00644071 0.00654611 0.00661656
 0.00669119 0.00674237 0.00681752 0.00688445 0.0069266  0.00698632
 0.00701619 0.00706067 0.00709441 0.00712717 0.00717373 0.00719872
 0.00722851 0.0072635  0.00730346 0.00732704 0.00734606 0.00738001]
=========== testing next new item epoch: 99 ===========
recall_all_avg_next_new: [0.00011196 0.00041985 0.00066242 0.00073706 0.000905   0.00121289
 0.00152078 0.00171671 0.00196861 0.00223918 0.0025564  0.00279898
 0.00292027 0.00304156 0.00325614 0.00339609 0.00351738 0.00380661
 0.00393723 0.00400254 0.0042078  0.00447836 0.00469295 0.00486089
 0.00497285 0.00517811 0.00534605 0.00550466 0.00584986 0.00610177]
MRR_all_avg_next_new: [0.00011196 0.0002659  0.00034676 0.00036542 0.00039901 0.00045032
 0.00049431 0.0005188  0.00054679 0.00057385 0.00060268 0.0006229
 0.00063223 0.00064089 0.0006552  0.00066394 0.00067108 0.00068715
 0.00069402 0.00069729 0.00070706 0.00071936 0.00072869 0.00073569
 0.00074017 0.00074806 0.00075428 0.00075995 0.00077185 0.00078025]
Final Out test_old sample
Recall_old: [0.00276568 0.00611509 0.00727047 0.00913036 0.01041054 0.01180345
 0.01349828 0.01458925 0.01586944 0.01728247 0.01844188 0.01928728
 0.02025749 0.02097407 0.02210127 0.02317212 0.0238887  0.02496357
 0.0255312  0.02642088 0.02712941 0.02785002 0.02892086 0.0295207
 0.03026546 0.03117527 0.03225417 0.03291439 0.03346591 0.03448442]
MRR_old: [0.00276568 0.00444038 0.00482551 0.00529048 0.00554652 0.00577867
 0.00602079 0.00615716 0.0062994  0.00644071 0.00654611 0.00661656
 0.00669119 0.00674237 0.00681752 0.00688445 0.0069266  0.00698632
 0.00701619 0.00706067 0.00709441 0.00712717 0.00717373 0.00719872
 0.00722851 0.0072635  0.00730346 0.00732704 0.00734606 0.00738001]
Final Out test_new sample
Recall_new: [0.00011196 0.00041985 0.00066242 0.00073706 0.000905   0.00121289
 0.00152078 0.00171671 0.00196861 0.00223918 0.0025564  0.00279898
 0.00292027 0.00304156 0.00325614 0.00339609 0.00351738 0.00380661
 0.00393723 0.00400254 0.0042078  0.00447836 0.00469295 0.00486089
 0.00497285 0.00517811 0.00534605 0.00550466 0.00584986 0.00610177]
MRR_new:[0.00011196 0.0002659  0.00034676 0.00036542 0.00039901 0.00045032
 0.00049431 0.0005188  0.00054679 0.00057385 0.00060268 0.0006229
 0.00063223 0.00064089 0.0006552  0.00066394 0.00067108 0.00068715
 0.00069402 0.00069729 0.00070706 0.00071936 0.00072869 0.00073569
 0.00074017 0.00074806 0.00075428 0.00075995 0.00077185 0.00078025]
------------- end top_n_item is: 50 -----------------
------------- end top_n_item is: 50 -----------------
30Music
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
loading data
reading train data
reading test old data
reading test new data
test_old sample size is: 616081
test_new sample size is: 337035
epoch 0 done
~~~~~~~~~~~~~ testing next item epoch: 0 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00093981 0.00155337 0.00231138 0.00282268 0.00317653 0.00373165
 0.00393455 0.00410498 0.0044004  0.00471204 0.00483703 0.00494253
 0.00520224 0.00539864 0.00557394 0.005634   0.00573139 0.00582066
 0.00611608 0.00620698 0.00630112 0.0064959  0.00659004 0.00672152
 0.00676859 0.00685462 0.00699421 0.00708348 0.00712893 0.0072247 ]
MRR_all_avg_next: [0.00093981 0.00124659 0.00149926 0.00162709 0.00169786 0.00179038
 0.00181936 0.00184067 0.00187349 0.00190465 0.00191602 0.00192481
 0.00194479 0.00195881 0.0019705  0.00197425 0.00197998 0.00198494
 0.00200049 0.00200504 0.00200952 0.00201837 0.00202247 0.00202794
 0.00202983 0.00203314 0.00203831 0.00204149 0.00204306 0.00204625]
=========== testing next new item epoch: 0 ===========
recall_all_avg_next_new: [3.85716617e-05 5.34069162e-05 1.27583189e-04 1.69121901e-04
 1.69121901e-04 2.04726512e-04 2.19561767e-04 2.37364072e-04
 2.75935734e-04 3.29342650e-04 3.56046108e-04 3.76815464e-04
 4.03518922e-04 4.33189431e-04 4.45057635e-04 4.56925839e-04
 4.86596348e-04 5.13299806e-04 5.25168009e-04 5.31102111e-04
 5.84509027e-04 6.05278384e-04 6.29014791e-04 6.40882994e-04
 6.85388758e-04 7.00224012e-04 7.32861572e-04 7.35828623e-04
 7.47696827e-04 7.62532081e-04]
MRR_all_avg_next_new: [3.85716617e-05 4.59892889e-05 7.07147131e-05 8.10993913e-05
 8.10993913e-05 8.70334931e-05 8.91528151e-05 9.13781033e-05
 9.56638435e-05 1.01004535e-04 1.03432122e-04 1.05162902e-04
 1.07217014e-04 1.09336336e-04 1.10127550e-04 1.10869312e-04
 1.12614636e-04 1.14098162e-04 1.14722804e-04 1.15019509e-04
 1.17562696e-04 1.18506757e-04 1.19538775e-04 1.20033284e-04
 1.21813514e-04 1.22384101e-04 1.23592899e-04 1.23698866e-04
 1.24108114e-04 1.24602622e-04]
epoch 1 done
epoch 2 done
epoch 3 done
epoch 4 done
epoch 5 done
epoch 6 done
epoch 7 done
epoch 8 done
epoch 9 done
epoch 10 done
epoch 11 done
epoch 12 done
epoch 13 done
epoch 14 done
epoch 15 done
epoch 16 done
epoch 17 done
epoch 18 done
epoch 19 done
~~~~~~~~~~~~~ testing next item epoch: 19 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00270094 0.00500908 0.0066014  0.00822619 0.00953608 0.01134916
 0.01251621 0.01395109 0.01535837 0.01647348 0.01763242 0.01873455
 0.01975552 0.0207846  0.02170981 0.02252626 0.02342224 0.02407313
 0.02504703 0.02571415 0.02638289 0.02717175 0.02797035 0.02866669
 0.02953995 0.03028173 0.03093587 0.03169064 0.03236912 0.03283497]
MRR_all_avg_next: [0.00270094 0.00385501 0.00438579 0.00479198 0.00505396 0.00535614
 0.00552286 0.00570222 0.00585859 0.0059701  0.00607546 0.0061673
 0.00624584 0.00631934 0.00638102 0.00643205 0.00648476 0.00652092
 0.00657217 0.00660553 0.00663738 0.00667323 0.00670795 0.00673697
 0.0067719  0.00680043 0.00682466 0.00685161 0.00687501 0.00689054]
=========== testing next new item epoch: 19 ===========
recall_all_avg_next_new: [0.00033824 0.00064682 0.00104143 0.00141232 0.00168528 0.00197902
 0.00221935 0.00248639 0.00272672 0.00299375 0.00329936 0.0036198
 0.00396101 0.00423101 0.00445948 0.00477102 0.00507069 0.00519234
 0.00546234 0.0056908  0.0059341  0.0061863  0.00638509 0.00658389
 0.00685685 0.00703488 0.0071862  0.00742059 0.00764906 0.00778257]
MRR_all_avg_next_new: [0.00033824 0.00049253 0.00062407 0.00071679 0.00077138 0.00082034
 0.00085467 0.00088805 0.00091476 0.00094146 0.00096924 0.00099595
 0.00102219 0.00104148 0.00105671 0.00107618 0.00109381 0.00110057
 0.00111478 0.0011262  0.00113779 0.00114925 0.00115789 0.00116618
 0.00117709 0.00118394 0.00118955 0.00119792 0.00120579 0.00121025]
epoch 20 done
epoch 21 done
epoch 22 done
epoch 23 done
epoch 24 done
epoch 25 done
epoch 26 done
epoch 27 done
epoch 28 done
epoch 29 done
epoch 30 done
epoch 31 done
epoch 32 done
epoch 33 done
epoch 34 done
epoch 35 done
epoch 36 done
epoch 37 done
epoch 38 done
epoch 39 done
epoch 40 done
epoch 41 done
epoch 42 done
epoch 43 done
epoch 44 done
epoch 45 done
epoch 46 done
epoch 47 done
epoch 48 done
epoch 49 done
~~~~~~~~~~~~~ testing next item epoch: 49 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00254025 0.00416017 0.00567296 0.00717276 0.00820996 0.00981851
 0.01112678 0.0121932  0.01350959 0.01463931 0.01554179 0.0165514
 0.01739382 0.01849108 0.01924747 0.02028305 0.02116767 0.02197276
 0.02291582 0.02375012 0.02436206 0.0251006  0.02579044 0.02655333
 0.02717824 0.02798496 0.02862124 0.02927212 0.03001066 0.0308401 ]
MRR_all_avg_next: [0.00254025 0.00335021 0.00385447 0.00422942 0.00443686 0.00470495
 0.00489185 0.00502515 0.00517142 0.00528439 0.00536643 0.00545057
 0.00551537 0.00559374 0.00564417 0.00570889 0.00576093 0.00580566
 0.00585529 0.00589701 0.00592615 0.00595972 0.00598971 0.0060215
 0.00604649 0.00607752 0.00610109 0.00612433 0.0061498  0.00617745]
=========== testing next new item epoch: 49 ===========
recall_all_avg_next_new: [0.00031747 0.00059638 0.00088715 0.00125803 0.0015399  0.00199089
 0.00240331 0.00289287 0.00314507 0.00344475 0.00377706 0.00407673
 0.00453959 0.0049075  0.00524575 0.00554245 0.00589256 0.00613883
 0.00651268 0.00683015 0.00708532 0.00739982 0.00764906 0.00788939
 0.0082751  0.00860445 0.00894269 0.0092305  0.00944412 0.00972896]
MRR_all_avg_next_new: [0.00031747 0.00045693 0.00055385 0.00064657 0.00070294 0.00077811
 0.00083703 0.00089822 0.00092624 0.00095621 0.00098642 0.00101139
 0.001047   0.00107328 0.00109583 0.00111437 0.00113497 0.00114865
 0.00116832 0.0011842  0.00119635 0.00121064 0.00122148 0.00123149
 0.00124692 0.00125959 0.00127212 0.0012824  0.00128976 0.00129926]
epoch 50 done
epoch 51 done
epoch 52 done
epoch 53 done
epoch 54 done
epoch 55 done
epoch 56 done
epoch 57 done
epoch 58 done
epoch 59 done
epoch 60 done
epoch 61 done
epoch 62 done
epoch 63 done
epoch 64 done
epoch 65 done
epoch 66 done
epoch 67 done
epoch 68 done
epoch 69 done
epoch 70 done
epoch 71 done
epoch 72 done
epoch 73 done
epoch 74 done
epoch 75 done
epoch 76 done
epoch 77 done
epoch 78 done
epoch 79 done
epoch 80 done
epoch 81 done
epoch 82 done
epoch 83 done
epoch 84 done
epoch 85 done
epoch 86 done
epoch 87 done
epoch 88 done
epoch 89 done
epoch 90 done
epoch 91 done
epoch 92 done
epoch 93 done
epoch 94 done
epoch 95 done
epoch 96 done
epoch 97 done
epoch 98 done
epoch 99 done
~~~~~~~~~~~~~ testing next item epoch: 99 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00292169 0.00493279 0.00683189 0.00834955 0.00998895 0.0114855
 0.01287168 0.01445265 0.01575118 0.01694745 0.01816807 0.01936921
 0.02079921 0.02202957 0.02295315 0.02412507 0.02517688 0.02607612
 0.0273081  0.02812293 0.02893938 0.02968116 0.03034828 0.03094561
 0.03177017 0.03262396 0.03346476 0.03423738 0.03500027 0.03566901]
MRR_all_avg_next: [0.00292169 0.00392724 0.00456028 0.00493969 0.00526757 0.005517
 0.00571502 0.00591264 0.00605692 0.00617655 0.00628752 0.00638761
 0.00649761 0.00658549 0.00664707 0.00672031 0.00678218 0.00683214
 0.00689698 0.00693772 0.0069766  0.00701032 0.00703932 0.00706421
 0.0070972  0.00713003 0.00716117 0.00718877 0.00721507 0.00723737]
=========== testing next new item epoch: 99 ===========
recall_all_avg_next_new: [0.00052814 0.00116012 0.00188111 0.00267628 0.00317474 0.00374145
 0.00444761 0.00500838 0.00560773 0.00622191 0.00670257 0.00715653
 0.00760455 0.00806741 0.00838192 0.00880621 0.00919786 0.00949456
 0.00996929 0.01035204 0.01072292 0.0110315  0.011346   0.0115537
 0.01187414 0.01222425 0.01266634 0.01298975 0.013417   0.01382052]
MRR_all_avg_next_new: [0.00052814 0.00084413 0.00108446 0.00128325 0.00138294 0.00147739
 0.00157827 0.00164837 0.00171496 0.00177638 0.00182008 0.00185791
 0.00189237 0.00192543 0.0019464  0.00197292 0.00199596 0.00201244
 0.00203743 0.00205656 0.00207422 0.00208825 0.00210192 0.00211058
 0.0021234  0.00213686 0.00215324 0.00216479 0.00217952 0.00219297]
Final Out test_old sample
Recall_old: [0.00292169 0.00493279 0.00683189 0.00834955 0.00998895 0.0114855
 0.01287168 0.01445265 0.01575118 0.01694745 0.01816807 0.01936921
 0.02079921 0.02202957 0.02295315 0.02412507 0.02517688 0.02607612
 0.0273081  0.02812293 0.02893938 0.02968116 0.03034828 0.03094561
 0.03177017 0.03262396 0.03346476 0.03423738 0.03500027 0.03566901]
MRR_old: [0.00292169 0.00392724 0.00456028 0.00493969 0.00526757 0.005517
 0.00571502 0.00591264 0.00605692 0.00617655 0.00628752 0.00638761
 0.00649761 0.00658549 0.00664707 0.00672031 0.00678218 0.00683214
 0.00689698 0.00693772 0.0069766  0.00701032 0.00703932 0.00706421
 0.0070972  0.00713003 0.00716117 0.00718877 0.00721507 0.00723737]
Final Out test_new sample
Recall_new: [0.00052814 0.00116012 0.00188111 0.00267628 0.00317474 0.00374145
 0.00444761 0.00500838 0.00560773 0.00622191 0.00670257 0.00715653
 0.00760455 0.00806741 0.00838192 0.00880621 0.00919786 0.00949456
 0.00996929 0.01035204 0.01072292 0.0110315  0.011346   0.0115537
 0.01187414 0.01222425 0.01266634 0.01298975 0.013417   0.01382052]
MRR_new:[0.00052814 0.00084413 0.00108446 0.00128325 0.00138294 0.00147739
 0.00157827 0.00164837 0.00171496 0.00177638 0.00182008 0.00185791
 0.00189237 0.00192543 0.0019464  0.00197292 0.00199596 0.00201244
 0.00203743 0.00205656 0.00207422 0.00208825 0.00210192 0.00211058
 0.0021234  0.00213686 0.00215324 0.00216479 0.00217952 0.00219297]
------------- end top_n_item is: 50 -----------------
------------- end top_n_item is: 50 -----------------
xiami
+++++++++++++ start top_n_item is: 10 ++++++++++++++++
+++++++++++++ start top_n_item is: 10 ++++++++++++++++
loading data
reading train data
reading test old data
reading test new data
test_old sample size is: 612641
test_new sample size is: 218593
epoch 0 done
~~~~~~~~~~~~~ testing next item epoch: 0 ~~~~~~~~~~~~~
recall_all_avg_next: [0.02216796 0.02564144 0.02814536 0.0291133  0.02960788 0.03014
 0.03099695 0.03159109 0.03227175 0.03258842 0.03269615 0.03373917
 0.0340036  0.03443126 0.03558854 0.03657933 0.03716206 0.03831281
 0.03886452 0.04035153 0.04108932 0.04184996 0.04249797 0.04343163
 0.04401436 0.0452402  0.04628975 0.04685452 0.04758415 0.04836111]
MRR_all_avg_next: [0.02216796 0.0239047  0.02473934 0.02498132 0.02508024 0.02516893
 0.02529135 0.02536562 0.02544125 0.02547291 0.02548271 0.02556962
 0.02558996 0.02562051 0.02569766 0.02575959 0.02579387 0.0258578
 0.02588683 0.02596118 0.02599632 0.02603089 0.02605907 0.02609797
 0.02612128 0.02616843 0.0262073  0.02622747 0.02625263 0.02627853]
=========== testing next new item epoch: 0 ===========
recall_all_avg_next_new: [8.69195262e-05 3.24804545e-04 4.43747055e-04 5.62689565e-04
 6.40459667e-04 7.31953905e-04 8.69195262e-04 9.88137772e-04
 1.10708028e-03 1.14825269e-03 1.16655154e-03 1.24432164e-03
 1.32666645e-03 1.39528713e-03 1.51880435e-03 1.61487330e-03
 1.70179283e-03 1.89850544e-03 1.96712612e-03 2.06319507e-03
 2.11809161e-03 2.25533297e-03 2.33767778e-03 2.38799962e-03
 2.47949385e-03 2.57098809e-03 2.63045935e-03 2.69450531e-03
 2.79057426e-03 2.87291908e-03]
MRR_all_avg_next_new: [8.69195262e-05 2.05862036e-04 2.45509539e-04 2.75245166e-04
 2.90799187e-04 3.06048227e-04 3.25654135e-04 3.40521948e-04
 3.53737783e-04 3.57855024e-04 3.59518555e-04 3.65999397e-04
 3.72333614e-04 3.77235091e-04 3.85469572e-04 3.91473881e-04
 3.96586795e-04 4.07515273e-04 4.11126888e-04 4.15930335e-04
 4.18544456e-04 4.24782700e-04 4.28362909e-04 4.30459652e-04
 4.34119422e-04 4.37638431e-04 4.39841070e-04 4.42128426e-04
 4.45441148e-04 4.48185975e-04]
epoch 1 done
epoch 2 done
epoch 3 done
epoch 4 done
epoch 5 done
epoch 6 done
epoch 7 done
epoch 8 done
epoch 9 done
epoch 10 done
epoch 11 done
epoch 12 done
epoch 13 done
epoch 14 done
epoch 15 done
epoch 16 done
epoch 17 done
epoch 18 done
epoch 19 done
~~~~~~~~~~~~~ testing next item epoch: 19 ~~~~~~~~~~~~~
recall_all_avg_next: [0.02825962 0.03752932 0.04313782 0.04801344 0.05150814 0.05418018
 0.0588844  0.06138342 0.06379593 0.06631127 0.06892128 0.07085389
 0.07333985 0.0747534  0.07669745 0.07854192 0.08019215 0.08252957
 0.08391538 0.08657109 0.08878936 0.09040041 0.09191354 0.09336789
 0.09524175 0.09686423 0.09850957 0.10006023 0.1021724  0.1035027 ]
MRR_all_avg_next: [0.02825962 0.03289447 0.03476397 0.03598287 0.03668181 0.03712715
 0.03779919 0.03811156 0.03837962 0.03863115 0.03886843 0.03902948
 0.03922071 0.03932167 0.03945128 0.03956656 0.03966363 0.03979349
 0.03986642 0.03999921 0.04010484 0.04017807 0.04024386 0.04030446
 0.04037941 0.04044181 0.04050275 0.04055813 0.04063097 0.04067531]
=========== testing next new item epoch: 19 ===========
recall_all_avg_next_new: [0.00059929 0.0011208  0.00156455 0.00212724 0.00268536 0.00317942
 0.00347678 0.00379244 0.00419959 0.00467536 0.0050825  0.00548508
 0.00609809 0.00637715 0.00685292 0.00728752 0.00772211 0.00816129
 0.00857301 0.00914942 0.00941018 0.00968467 0.01004607 0.01061791
 0.01081919 0.0111074  0.01148253 0.01191255 0.01242949 0.01283207]
MRR_all_avg_next_new: [0.00059929 0.00086005 0.00100796 0.00114863 0.00126026 0.0013426
 0.00138508 0.00142454 0.00146978 0.00151735 0.00155437 0.00158792
 0.00163507 0.001655   0.00168672 0.00171388 0.00173945 0.00176385
 0.00178552 0.00181434 0.00182675 0.00183923 0.00185494 0.00187877
 0.00188682 0.00189791 0.0019118  0.00192716 0.00194498 0.0019584 ]
epoch 20 done
epoch 21 done
epoch 22 done
epoch 23 done
epoch 24 done
epoch 25 done
epoch 26 done
epoch 27 done
epoch 28 done
epoch 29 done
epoch 30 done
epoch 31 done
epoch 32 done
epoch 33 done
epoch 34 done
epoch 35 done
epoch 36 done
epoch 37 done
epoch 38 done
epoch 39 done
epoch 40 done
epoch 41 done
epoch 42 done
epoch 43 done
epoch 44 done
epoch 45 done
epoch 46 done
epoch 47 done
epoch 48 done
epoch 49 done
~~~~~~~~~~~~~ testing next item epoch: 49 ~~~~~~~~~~~~~
recall_all_avg_next: [0.02575081 0.0356016  0.03946194 0.04237555 0.04512757 0.04898791
 0.05138899 0.05449358 0.05689466 0.05964015 0.06166744 0.06382204
 0.06603868 0.06840548 0.07021731 0.07230662 0.07411845 0.07572461
 0.07794777 0.07978408 0.08165794 0.08327716 0.08448014 0.08637359
 0.08802382 0.09033349 0.09182866 0.09333851 0.09465086 0.09597791]
MRR_all_avg_next: [0.02575081 0.0306762  0.03196298 0.03269139 0.03324179 0.03388518
 0.03422819 0.03461626 0.03488305 0.0351576  0.0353419  0.03552145
 0.03569196 0.03586102 0.03598181 0.03611239 0.03621897 0.0363082
 0.03642521 0.03651702 0.03660625 0.03667985 0.03673216 0.03681105
 0.03687706 0.03696589 0.03702127 0.03707519 0.03712045 0.03716468]
=========== testing next new item epoch: 49 ===========
recall_all_avg_next_new: [0.00055354 0.00108878 0.00156455 0.00215926 0.00274483 0.00312453
 0.00361402 0.00412182 0.00452896 0.00486292 0.00536156 0.00568637
 0.00608437 0.00661046 0.00693526 0.00740188 0.00784106 0.00842204
 0.00890696 0.00942848 0.00978531 0.01011926 0.01035257 0.01098846
 0.01136816 0.01165179 0.01199489 0.01238375 0.01280004 0.01323922]
MRR_all_avg_next_new: [0.00055354 0.00082116 0.00097975 0.00112843 0.00124554 0.00130883
 0.00137875 0.00144223 0.00148747 0.00152086 0.00156619 0.00159326
 0.00162387 0.00166145 0.00168311 0.00171227 0.0017381  0.00177038
 0.0017959  0.00182198 0.00183897 0.00185415 0.00186429 0.00189079
 0.00190598 0.00191689 0.00192959 0.00194348 0.00195784 0.00197248]
epoch 50 done
epoch 51 done
epoch 52 done
epoch 53 done
epoch 54 done
epoch 55 done
epoch 56 done
epoch 57 done
epoch 58 done
epoch 59 done
epoch 60 done
epoch 61 done
epoch 62 done
epoch 63 done
epoch 64 done
epoch 65 done
epoch 66 done
epoch 67 done
epoch 68 done
epoch 69 done
epoch 70 done
epoch 71 done
epoch 72 done
epoch 73 done
epoch 74 done
epoch 75 done
epoch 76 done
epoch 77 done
epoch 78 done
epoch 79 done
epoch 80 done
epoch 81 done
epoch 82 done
epoch 83 done
epoch 84 done
epoch 85 done
epoch 86 done
epoch 87 done
epoch 88 done
epoch 89 done
epoch 90 done
epoch 91 done
epoch 92 done
epoch 93 done
epoch 94 done
epoch 95 done
epoch 96 done
epoch 97 done
epoch 98 done
epoch 99 done
~~~~~~~~~~~~~ testing next item epoch: 99 ~~~~~~~~~~~~~
recall_all_avg_next: [0.02736839 0.03417825 0.03766153 0.04117909 0.04469828 0.047607
 0.05002277 0.05413937 0.05629888 0.05933328 0.06238727 0.0646088
 0.06668669 0.06857523 0.0709959  0.07306889 0.07529858 0.07693902
 0.0786725  0.08077814 0.08250999 0.08473968 0.08666413 0.08812828
 0.08940799 0.09073666 0.09228406 0.09350011 0.09475043 0.0966047 ]
MRR_all_avg_next: [0.02736839 0.03077332 0.03193442 0.03281381 0.03351764 0.03400243
 0.03434754 0.03486212 0.03510206 0.0354055  0.03568314 0.03586826
 0.0360281  0.036163   0.03632438 0.03645394 0.0365851  0.03667623
 0.03676747 0.03687275 0.03695522 0.03705657 0.03714024 0.03720125
 0.03725243 0.03730354 0.03736085 0.03740428 0.03744739 0.0375092 ]
=========== testing next new item epoch: 99 ===========
recall_all_avg_next_new: [0.00064046 0.00107506 0.00171094 0.00212267 0.00253439 0.00299644
 0.00339901 0.00397542 0.0043414  0.00493611 0.00537529 0.00595627
 0.00649152 0.00690781 0.00730124 0.00760317 0.00787765 0.00816586
 0.00853641 0.00905335 0.00956115 0.01020618 0.01064535 0.01118975
 0.01157402 0.01185765 0.01244779 0.01285952 0.01318889 0.01359604]
MRR_all_avg_next_new: [0.00064046 0.00085776 0.00106972 0.00117265 0.001255   0.001332
 0.00138951 0.00146157 0.00150223 0.0015617  0.00160163 0.00165004
 0.00169121 0.00172095 0.00174718 0.00176605 0.00178219 0.00179821
 0.00181771 0.00184356 0.00186774 0.00189706 0.00191615 0.00193883
 0.00195421 0.00196511 0.00198697 0.00200168 0.00201303 0.0020266 ]
Final Out test_old sample
Recall_old: [0.02736839 0.03417825 0.03766153 0.04117909 0.04469828 0.047607
 0.05002277 0.05413937 0.05629888 0.05933328 0.06238727 0.0646088
 0.06668669 0.06857523 0.0709959  0.07306889 0.07529858 0.07693902
 0.0786725  0.08077814 0.08250999 0.08473968 0.08666413 0.08812828
 0.08940799 0.09073666 0.09228406 0.09350011 0.09475043 0.0966047 ]
MRR_old: [0.02736839 0.03077332 0.03193442 0.03281381 0.03351764 0.03400243
 0.03434754 0.03486212 0.03510206 0.0354055  0.03568314 0.03586826
 0.0360281  0.036163   0.03632438 0.03645394 0.0365851  0.03667623
 0.03676747 0.03687275 0.03695522 0.03705657 0.03714024 0.03720125
 0.03725243 0.03730354 0.03736085 0.03740428 0.03744739 0.0375092 ]
Final Out test_new sample
Recall_new: [0.00064046 0.00107506 0.00171094 0.00212267 0.00253439 0.00299644
 0.00339901 0.00397542 0.0043414  0.00493611 0.00537529 0.00595627
 0.00649152 0.00690781 0.00730124 0.00760317 0.00787765 0.00816586
 0.00853641 0.00905335 0.00956115 0.01020618 0.01064535 0.01118975
 0.01157402 0.01185765 0.01244779 0.01285952 0.01318889 0.01359604]
MRR_new:[0.00064046 0.00085776 0.00106972 0.00117265 0.001255   0.001332
 0.00138951 0.00146157 0.00150223 0.0015617  0.00160163 0.00165004
 0.00169121 0.00172095 0.00174718 0.00176605 0.00178219 0.00179821
 0.00181771 0.00184356 0.00186774 0.00189706 0.00191615 0.00193883
 0.00195421 0.00196511 0.00198697 0.00200168 0.00201303 0.0020266 ]
------------- end top_n_item is: 10 -----------------
------------- end top_n_item is: 10 -----------------
