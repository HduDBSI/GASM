Namespace(cuda_device='3', data_size=1, drop_portion=1, hist_length=5, itera=100, output='display', valid_portion=8)
lastfm
============================================
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
init hrm ... 
init data_generation
------------------------------
Test records (next-new):107182
------------------------------
Test records (next-item):248402
building model ... 
running ... 
2022-07-08 11:03:02.671329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: GeForce RTX 2080 Ti
major: 7 minor: 5 memoryClockRate (GHz) 1.545
pciBusID 0000:3b:00.0
Total memory: 10.76GiB
Free memory: 8.59GiB
2022-07-08 11:03:03.042237: W tensorflow/stream_executor/cuda/cuda_driver.cc:523] A non-primary context 0x1b30100 exists before initializing the StreamExecutor. We haven't verified StreamExecutor works with that.
2022-07-08 11:03:03.043492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 1 with properties: 
name: GeForce RTX 2080 Ti
major: 7 minor: 5 memoryClockRate (GHz) 1.545
pciBusID 0000:b1:00.0
Total memory: 10.76GiB
Free memory: 10.60GiB
iteration 0 begin ...
all_loss 1395515.656425476
eval ...
~~~~~~~~~~~~~ testing next item epoch: 0 ~~~~~~~~~~~~~
recall_all_avg_next: [6.84247810e-05 1.44899536e-04 2.93824060e-04 4.46773570e-04
 7.20472694e-04 8.97572128e-04 1.14309634e-03 1.30812081e-03
 1.47717027e-03 1.75891937e-03 1.97224369e-03 2.22581788e-03
 2.57599176e-03 2.92214065e-03 3.13546497e-03 3.24413962e-03
 3.44941396e-03 3.63456337e-03 3.80763782e-03 4.01693715e-03
 4.22623648e-03 4.39931092e-03 4.56031041e-03 4.71325992e-03
 4.84608449e-03 4.94268418e-03 5.13185858e-03 5.30090804e-03
 5.43775760e-03 5.59070711e-03]
MRR_all_avg_next: [6.84247810e-05 1.06662159e-04 1.56303666e-04 1.94541044e-04
 2.49280869e-04 2.78797441e-04 3.13872329e-04 3.34500388e-04
 3.53283661e-04 3.81458571e-04 4.00851691e-04 4.21982873e-04
 4.48919325e-04 4.73644246e-04 4.87865867e-04 4.94658033e-04
 5.06732995e-04 5.17019073e-04 5.26128254e-04 5.36593221e-04
 5.46559855e-04 5.54426876e-04 5.61426853e-04 5.67799750e-04
 5.73112733e-04 5.76828105e-04 5.83834564e-04 5.89872045e-04
 5.94590995e-04 5.99689312e-04]
record_num: 248448.0
=========== testing next new item epoch: 0 ===========
recall_all_avg_next_new: [5.59367542e-05 1.30519093e-04 2.61038186e-04 4.10202864e-04
 6.71241050e-04 8.29728520e-04 1.05347554e-03 1.20264021e-03
 1.37045048e-03 1.64081146e-03 1.83659010e-03 2.09762828e-03
 2.44257160e-03 2.78751492e-03 2.99261635e-03 3.08584427e-03
 3.29094570e-03 3.46807876e-03 3.64521181e-03 3.85031325e-03
 4.05541468e-03 4.22322494e-03 4.39103520e-03 4.54952267e-03
 4.68004177e-03 4.77326969e-03 4.97837112e-03 5.14618138e-03
 5.27670048e-03 5.42586516e-03]
MRR_all_avg_next_new: [5.59367542e-05 9.32279236e-05 1.36734288e-04 1.74025457e-04
 2.26233095e-04 2.52647673e-04 2.84611533e-04 3.03257117e-04
 3.21902702e-04 3.48938800e-04 3.66736858e-04 3.88490040e-04
 4.15024142e-04 4.39662950e-04 4.53336379e-04 4.59163124e-04
 4.71227914e-04 4.81068639e-04 4.90391432e-04 5.00646503e-04
 5.10413238e-04 5.18040977e-04 5.25337076e-04 5.31940720e-04
 5.37161484e-04 5.40747173e-04 5.48343523e-04 5.54336746e-04
 5.58837405e-04 5.63809561e-04]
record_num_new: 107264.0
iteration 1 begin ...
all_loss 1390186.7180786133
iteration 2 begin ...
all_loss 1359822.595779419
iteration 3 begin ...
all_loss 1277796.291595459
iteration 4 begin ...
all_loss 1196470.460220337
iteration 5 begin ...
all_loss 1131392.2585601807
iteration 6 begin ...
all_loss 1074028.1803894043
iteration 7 begin ...
all_loss 1023108.6749267578
iteration 8 begin ...
all_loss 978554.1108627319
iteration 9 begin ...
all_loss 939869.0004882812
eval ...
~~~~~~~~~~~~~ testing next item epoch: 9 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00046287 0.00115115 0.00182332 0.00237072 0.00296239 0.00355406
 0.00399279 0.00447579 0.00486218 0.00540153 0.00584428 0.0064279
 0.00681028 0.00718058 0.00746635 0.00793325 0.00840015 0.00886302
 0.009342   0.00967607 0.01008662 0.01048107 0.01084332 0.01124581
 0.01162416 0.01196226 0.01232854 0.01266261 0.01308121 0.01346761]
MRR_all_avg_next: [0.00046287 0.00080701 0.00103107 0.00116792 0.00128625 0.00138486
 0.00144754 0.00150791 0.00155085 0.00160478 0.00164503 0.00169367
 0.00172308 0.00174953 0.00176858 0.00179776 0.00182523 0.00185094
 0.00187615 0.00189286 0.00191241 0.00193033 0.00194608 0.00196286
 0.00197799 0.00199099 0.00200456 0.00201649 0.00203092 0.0020438 ]
record_num: 248448.0
=========== testing next new item epoch: 9 ===========
recall_all_avg_next_new: [0.00045682 0.00116535 0.0018832  0.00243325 0.00299262 0.00355198
 0.00398083 0.00445629 0.00483853 0.00538857 0.00585471 0.00644205
 0.00681496 0.00720652 0.00750485 0.00798963 0.00845577 0.00893124
 0.00944399 0.00976096 0.01018981 0.01058137 0.01094496 0.01135516
 0.0117374  0.01208234 0.01244593 0.01277223 0.01321972 0.0136206 ]
MRR_all_avg_next_new: [0.00045682 0.00081108 0.00105037 0.00118788 0.00129975 0.00139298
 0.00145424 0.00151368 0.00155615 0.00161115 0.00165353 0.00170247
 0.00173116 0.00175913 0.00177902 0.00180931 0.00183673 0.00186315
 0.00189014 0.00190599 0.00192641 0.0019442  0.00196001 0.0019771
 0.00199239 0.00200566 0.00201913 0.00203078 0.00204621 0.00205957]
record_num_new: 107264.0
iteration 10 begin ...
all_loss 905997.083404541
iteration 11 begin ...
all_loss 876306.3653259277
iteration 12 begin ...
all_loss 850192.7823181152
iteration 13 begin ...
all_loss 827287.1294326782
iteration 14 begin ...
all_loss 807178.8345184326
iteration 15 begin ...
all_loss 789540.8883132935
iteration 16 begin ...
all_loss 774105.6785736084
iteration 17 begin ...
all_loss 760588.105140686
iteration 18 begin ...
all_loss 748736.2682418823
iteration 19 begin ...
all_loss 738358.3266906738
eval ...
~~~~~~~~~~~~~ testing next item epoch: 19 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00076877 0.00165427 0.00251562 0.00334879 0.00413366 0.00486621
 0.00567121 0.00643595 0.00730133 0.00822305 0.00891937 0.00967607
 0.01040459 0.01110494 0.01192604 0.01265456 0.01335491 0.01389023
 0.01455838 0.01524665 0.0160436  0.01684457 0.01746442 0.01806012
 0.01873229 0.01934409 0.01985124 0.02041473 0.02113118 0.02169066]
MRR_all_avg_next: [0.00076877 0.00121152 0.00149864 0.00170693 0.0018639  0.001986
 0.002101   0.00219659 0.00229274 0.00238491 0.00244822 0.00251127
 0.00256731 0.00261734 0.00267208 0.00271761 0.00275881 0.00278855
 0.00282371 0.00285813 0.00289608 0.00293249 0.00295944 0.00298426
 0.00301114 0.00303467 0.00305346 0.00307358 0.00309829 0.00311694]
record_num: 248448.0
=========== testing next new item epoch: 19 ===========
recall_all_avg_next_new: [0.00079244 0.00172472 0.00259174 0.00344943 0.00426984 0.00501566
 0.00583607 0.00661918 0.00747688 0.00839984 0.00910837 0.00988216
 0.01060934 0.01133652 0.01215692 0.01287478 0.01353669 0.01406809
 0.01473933 0.0154199  0.01622166 0.01703274 0.0176294  0.0182447
 0.01894391 0.01961516 0.02011859 0.02071524 0.02144242 0.0220484 ]
MRR_all_avg_next_new: [0.00079244 0.00125858 0.00154758 0.00176201 0.00192609 0.00205039
 0.00216759 0.00226548 0.00236078 0.00245308 0.00251749 0.00258197
 0.00263791 0.00268985 0.00274454 0.00278941 0.00282835 0.00285787
 0.0028932  0.00292723 0.0029654  0.00300227 0.00302821 0.00305385
 0.00308182 0.00310764 0.00312628 0.00314759 0.00317267 0.00319287]
record_num_new: 107264.0
iteration 20 begin ...
all_loss 729186.492111206
iteration 21 begin ...
all_loss 721125.7230377197
iteration 22 begin ...
all_loss 713945.4585876465
iteration 23 begin ...
all_loss 707727.8598403931
iteration 24 begin ...
all_loss 702058.6439971924
iteration 25 begin ...
all_loss 697036.6093597412
iteration 26 begin ...
all_loss 692573.9048995972
iteration 27 begin ...
all_loss 688591.5996627808
iteration 28 begin ...
all_loss 684911.7080993652
iteration 29 begin ...
all_loss 681744.0181427002
eval ...
~~~~~~~~~~~~~ testing next item epoch: 29 ~~~~~~~~~~~~~
recall_all_avg_next: [0.0010465  0.00217752 0.00320791 0.00437516 0.00560681 0.00682235
 0.00793727 0.00904817 0.01016712 0.01116129 0.01222389 0.01345151
 0.01417198 0.01526678 0.01616837 0.01711425 0.01783874 0.01873632
 0.01951314 0.02024971 0.02115131 0.02199655 0.0227613  0.0235985
 0.02431897 0.0249348  0.02564319 0.02651662 0.02728941 0.02796964]
MRR_all_avg_next: [0.0010465  0.00161201 0.00195547 0.00224728 0.00249361 0.0026962
 0.00285548 0.00299434 0.00311867 0.00321809 0.00331469 0.00341699
 0.00347241 0.00355061 0.00361071 0.00366983 0.00371245 0.00376231
 0.0038032  0.00384003 0.00388296 0.00392138 0.00395463 0.00398951
 0.00401833 0.00404202 0.00406826 0.00409945 0.0041261  0.00414877]
record_num: 248448.0
=========== testing next new item epoch: 29 ===========
recall_all_avg_next_new: [0.0010628  0.00224679 0.00330959 0.00452155 0.00584539 0.00709464
 0.0082227  0.00938805 0.01052543 0.01157891 0.01266967 0.01386299
 0.01461814 0.01568094 0.01661322 0.01757346 0.01829132 0.01917698
 0.01999739 0.02076186 0.02167549 0.02250522 0.02328834 0.02413671
 0.02488253 0.02548851 0.02619705 0.02705474 0.02787515 0.02856504]
MRR_all_avg_next_new: [0.0010628  0.0016548  0.00200906 0.00231205 0.00257682 0.00278503
 0.00294618 0.00309185 0.00321822 0.00332357 0.00342273 0.00352218
 0.00358026 0.00365618 0.00371833 0.00377835 0.00382057 0.00386978
 0.00391295 0.00395118 0.00399468 0.0040324  0.00406645 0.0041018
 0.00413163 0.00415494 0.00418118 0.00421181 0.0042401  0.0042631 ]
record_num_new: 107264.0
iteration 30 begin ...
all_loss 678774.5522232056
iteration 31 begin ...
all_loss 676099.1186828613
iteration 32 begin ...
all_loss 673659.0525512695
iteration 33 begin ...
all_loss 671514.3574752808
iteration 34 begin ...
all_loss 669497.4310836792
iteration 35 begin ...
all_loss 667616.0433120728
iteration 36 begin ...
all_loss 665976.9219360352
iteration 37 begin ...
all_loss 664430.7701950073
iteration 38 begin ...
all_loss 663011.4825286865
iteration 39 begin ...
all_loss 661666.7956695557
eval ...
~~~~~~~~~~~~~ testing next item epoch: 39 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00115115 0.00256392 0.00413366 0.00548606 0.0066694  0.00807815
 0.00939029 0.01062999 0.01179321 0.01287593 0.01404721 0.0153191
 0.0164461  0.01758517 0.01882084 0.01980696 0.02089371 0.0219402
 0.02286998 0.02355825 0.02450815 0.02534534 0.02620669 0.02710829
 0.02798976 0.02881086 0.02988955 0.03071065 0.03151162 0.03230857]
MRR_all_avg_next: [0.00115115 0.00185753 0.00238078 0.00271888 0.00295555 0.00319034
 0.00337779 0.00353275 0.003662   0.00377027 0.00387675 0.00398274
 0.00406943 0.00415079 0.00423317 0.0042948  0.00435873 0.00441687
 0.00446581 0.00450022 0.00454545 0.00458351 0.00462096 0.00465852
 0.00469378 0.00472536 0.00476531 0.00479464 0.00482226 0.00484882]
record_num: 248448.0
=========== testing next new item epoch: 39 ===========
recall_all_avg_next_new: [0.00120264 0.002657   0.00426052 0.00566826 0.00689887 0.00838119
 0.00974232 0.01105683 0.0122315  0.01333159 0.0144783  0.01576484
 0.01690222 0.0180396  0.01927021 0.0202864  0.02137716 0.02246793
 0.02339089 0.02412739 0.02506899 0.02592669 0.02684032 0.02775395
 0.02865826 0.02947867 0.03060673 0.03142713 0.03223822 0.03306794]
MRR_all_avg_next_new: [0.00120264 0.00192982 0.00246432 0.00281626 0.00306238 0.00330944
 0.00350388 0.0036682  0.00379872 0.00390872 0.00401297 0.00412018
 0.00420767 0.00428892 0.00437096 0.00443447 0.00449863 0.00455923
 0.0046078  0.00464463 0.00468947 0.00472845 0.00476818 0.00480625
 0.00484242 0.00487397 0.00491575 0.00494505 0.00497302 0.00500068]
record_num_new: 107264.0
iteration 40 begin ...
all_loss 660506.7917175293
iteration 41 begin ...
all_loss 659354.8277206421
iteration 42 begin ...
all_loss 658304.945854187
iteration 43 begin ...
all_loss 657375.1779708862
iteration 44 begin ...
all_loss 656468.4370803833
iteration 45 begin ...
all_loss 655683.761642456
iteration 46 begin ...
all_loss 654818.5948867798
iteration 47 begin ...
all_loss 654173.7743148804
iteration 48 begin ...
all_loss 653455.9365081787
iteration 49 begin ...
all_loss 652807.8219223022
eval ...
~~~~~~~~~~~~~ testing next item epoch: 49 ~~~~~~~~~~~~~
recall_all_avg_next: [0.0014168  0.00301472 0.00460056 0.00623068 0.0075871  0.00907635
 0.01032409 0.01168856 0.01290008 0.01426858 0.01559683 0.01672785
 0.01793937 0.01916699 0.02045498 0.02162223 0.02274923 0.0238561
 0.0247577  0.02584042 0.02699156 0.02806624 0.02886318 0.0298332
 0.03081128 0.03175715 0.03277547 0.03356034 0.03430899 0.03518644]
MRR_all_avg_next: [0.0014168  0.00221576 0.00274437 0.0031519  0.00342318 0.00367139
 0.00384964 0.0040202  0.00415481 0.00429166 0.00441241 0.00450666
 0.00459986 0.00468755 0.00477341 0.00484637 0.00491266 0.00497415
 0.0050216  0.00507574 0.00513056 0.00517941 0.00521406 0.00525447
 0.0052936  0.00532998 0.00536769 0.00539572 0.00542154 0.00545079]
record_num: 248448.0
=========== testing next new item epoch: 49 ===========
recall_all_avg_next_new: [0.00148232 0.00312314 0.00475462 0.00640476 0.00782182 0.0094067
 0.01070257 0.01210098 0.01331295 0.01472069 0.01604453 0.01720987
 0.01843116 0.01965245 0.02097628 0.02215095 0.02330698 0.02442572
 0.02538596 0.02651402 0.0276514  0.02874217 0.02956257 0.03053214
 0.03155765 0.0325179  0.03360867 0.03439178 0.0351376  0.03602327]
MRR_all_avg_next_new: [0.00148232 0.00230273 0.00284656 0.00325909 0.00354251 0.00380665
 0.00399178 0.00416658 0.00430124 0.00444201 0.00456236 0.00465948
 0.00475342 0.00484066 0.00492891 0.00500233 0.00507033 0.00513248
 0.00518302 0.00523942 0.00529359 0.00534317 0.00537884 0.00541923
 0.00546025 0.00549719 0.00553759 0.00556555 0.00559127 0.00562079]
record_num_new: 107264.0
iteration 50 begin ...
all_loss 652254.980178833
iteration 51 begin ...
all_loss 651635.0619125366
iteration 52 begin ...
all_loss 651140.0012207031
iteration 53 begin ...
all_loss 650639.1529312134
iteration 54 begin ...
all_loss 650191.5721054077
iteration 55 begin ...
all_loss 649711.0258331299
iteration 56 begin ...
all_loss 649300.2543869019
iteration 57 begin ...
all_loss 648872.2140960693
iteration 58 begin ...
all_loss 648565.13697052
iteration 59 begin ...
all_loss 648144.9878692627
eval ...
~~~~~~~~~~~~~ testing next item epoch: 59 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00146912 0.00322401 0.00487023 0.00663318 0.00815865 0.00937017
 0.01096809 0.01232854 0.01366886 0.01508163 0.0163978  0.01763749
 0.01890939 0.02018934 0.02144111 0.02249565 0.02348177 0.02479392
 0.02605777 0.02709219 0.02827553 0.02914493 0.03017935 0.03109705
 0.03198255 0.03310954 0.03406347 0.03506569 0.03606791 0.03692926]
MRR_all_avg_next: [0.00146912 0.00234657 0.00289531 0.00333604 0.00364114 0.00384306
 0.00407133 0.00424139 0.00439031 0.00453159 0.00465124 0.00475455
 0.00485239 0.00494381 0.00502726 0.00509317 0.00515118 0.00522408
 0.00529059 0.00534232 0.00539867 0.00543818 0.00548316 0.0055214
 0.00555682 0.00560016 0.00563549 0.00567129 0.00570585 0.00573456]
record_num: 248448.0
=========== testing next new item epoch: 59 ===========
recall_all_avg_next_new: [0.00152894 0.00332824 0.00498769 0.00678699 0.00839984 0.00966774
 0.01129922 0.01269764 0.01409606 0.01553177 0.01684629 0.01813283
 0.01939141 0.0206966  0.02200179 0.02307391 0.0240901  0.02541393
 0.02664454 0.02770734 0.0289193  0.02981429 0.03088641 0.03180937
 0.032723   0.03386038 0.0348486  0.03586478 0.036853   0.03773866]
MRR_all_avg_next_new: [0.00152894 0.00242859 0.00298174 0.00343156 0.00375413 0.00396545
 0.00419852 0.00437332 0.0045287  0.00467227 0.00479177 0.00489899
 0.0049958  0.00508903 0.00517604 0.00524305 0.00530282 0.00537637
 0.00544114 0.00549428 0.00555199 0.00559267 0.00563929 0.00567774
 0.00571429 0.00575803 0.00579463 0.00583093 0.005865   0.00589453]
record_num_new: 107264.0
iteration 60 begin ...
all_loss 647873.2690353394
iteration 61 begin ...
all_loss 647495.469078064
iteration 62 begin ...
all_loss 647218.8629074097
iteration 63 begin ...
all_loss 646881.6420440674
iteration 64 begin ...
all_loss 646624.7052764893
iteration 65 begin ...
all_loss 646392.0794296265
iteration 66 begin ...
all_loss 646083.4302520752
iteration 67 begin ...
all_loss 645889.1193847656
iteration 68 begin ...
all_loss 645621.7885055542
iteration 69 begin ...
all_loss 645426.7747650146
eval ...
~~~~~~~~~~~~~ testing next item epoch: 69 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00150937 0.00328036 0.00489841 0.00666538 0.00817072 0.00964387
 0.01118946 0.01277531 0.01426053 0.01563305 0.0169935  0.01847067
 0.01966609 0.02092591 0.02215353 0.02334493 0.02456852 0.02573174
 0.02714049 0.02831176 0.02918921 0.03029608 0.03120975 0.0323609
 0.03353217 0.03461489 0.03566139 0.03675216 0.0378711  0.03875258]
MRR_all_avg_next: [0.00150937 0.00239487 0.00293422 0.00337596 0.00367703 0.00392255
 0.00414335 0.00434158 0.00450661 0.00464386 0.00476753 0.00489063
 0.00498259 0.00507257 0.00515442 0.00522888 0.00530085 0.00536548
 0.00543962 0.00549819 0.00553997 0.00559028 0.00563001 0.00567797
 0.00572482 0.00576646 0.00580522 0.00584418 0.00588276 0.00591215]
record_num: 248448.0
=========== testing next new item epoch: 69 ===========
recall_all_avg_next_new: [0.00156623 0.0033935  0.00503431 0.00683361 0.00840916 0.00990081
 0.01150433 0.01313581 0.01469272 0.01608182 0.01748956 0.01896256
 0.02017452 0.02147039 0.02269168 0.02389432 0.02513425 0.02632757
 0.02776328 0.02895659 0.0298609  0.03098896 0.03191192 0.0330493
 0.03425194 0.03538    0.0364428  0.03752424 0.03867094 0.03957525]
MRR_all_avg_next_new: [0.00156623 0.00247986 0.0030268  0.00347662 0.00379174 0.00404034
 0.00426942 0.00447335 0.00464634 0.00478525 0.00491323 0.00503598
 0.00512921 0.00522177 0.00530319 0.00537835 0.00545129 0.00551759
 0.00559315 0.00565282 0.00569588 0.00574715 0.00578728 0.00583467
 0.00588278 0.00592616 0.00596553 0.00600415 0.00604369 0.00607384]
record_num_new: 107264.0
iteration 70 begin ...
all_loss 645211.5111083984
iteration 71 begin ...
all_loss 644972.1003265381
iteration 72 begin ...
all_loss 644763.8025283813
iteration 73 begin ...
all_loss 644564.5882110596
iteration 74 begin ...
all_loss 644450.7710342407
iteration 75 begin ...
all_loss 644249.6563873291
iteration 76 begin ...
all_loss 644102.76612854
iteration 77 begin ...
all_loss 643846.9148330688
iteration 78 begin ...
all_loss 643732.3392868042
iteration 79 begin ...
all_loss 643620.8698120117
eval ...
~~~~~~~~~~~~~ testing next item epoch: 79 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00156572 0.00348161 0.00501111 0.00677405 0.0083116  0.00987732
 0.01124984 0.01287593 0.01445373 0.01589467 0.01733562 0.01871619
 0.02018934 0.02140488 0.02256408 0.02399697 0.02534534 0.02638782
 0.02760739 0.02908456 0.03010288 0.03129025 0.03225222 0.03334299
 0.03438949 0.03547624 0.03647443 0.0375813  0.03868818 0.03989165]
MRR_all_avg_next: [0.00156572 0.00252367 0.0030335  0.00347423 0.00378174 0.0040427
 0.00423877 0.00444203 0.00461734 0.00476144 0.00489243 0.00500748
 0.0051208  0.00520762 0.0052849  0.00537446 0.00545378 0.00551169
 0.00557588 0.00564974 0.00569823 0.0057522  0.00579403 0.00583947
 0.00588133 0.00592313 0.0059601  0.00599963 0.0060378  0.00607792]
record_num: 248448.0
=========== testing next new item epoch: 79 ===========
recall_all_avg_next_new: [0.00162217 0.00360792 0.00517415 0.00694548 0.00852103 0.01012455
 0.01156959 0.01323837 0.01486985 0.0163615  0.0178345  0.0192236
 0.02068728 0.02192721 0.02312985 0.02456556 0.02596398 0.02701745
 0.02822009 0.02970242 0.03073725 0.03195853 0.03295607 0.03408413
 0.03515625 0.03627499 0.03731914 0.0384472  0.03952864 0.04070331]
MRR_all_avg_next_new: [0.00162217 0.00261504 0.00313712 0.00357995 0.00389506 0.00416232
 0.00436875 0.00457735 0.00475862 0.00490779 0.0050417  0.00515746
 0.00527005 0.00535861 0.00543879 0.00552852 0.00561078 0.00566931
 0.0057326  0.00580672 0.005856   0.00591151 0.00595488 0.00600188
 0.00604477 0.0060878  0.00612647 0.00616676 0.00620405 0.0062432 ]
record_num_new: 107264.0
iteration 80 begin ...
all_loss 643445.9370803833
iteration 81 begin ...
all_loss 643301.4901657104
iteration 82 begin ...
all_loss 643155.4747085571
iteration 83 begin ...
all_loss 643038.7723999023
iteration 84 begin ...
all_loss 642935.5645217896
iteration 85 begin ...
all_loss 642747.2103652954
iteration 86 begin ...
all_loss 642659.4809188843
iteration 87 begin ...
all_loss 642523.7921829224
iteration 88 begin ...
all_loss 642440.2540206909
iteration 89 begin ...
all_loss 642344.4931030273
eval ...
~~~~~~~~~~~~~ testing next item epoch: 89 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00162207 0.00342929 0.00507953 0.0066855  0.0084726  0.01007454
 0.01151146 0.01302083 0.01471535 0.01609995 0.01756102 0.01901001
 0.02057976 0.02185971 0.0232282  0.02452827 0.02575187 0.02707609
 0.02818296 0.02932606 0.03054965 0.0316042  0.03288012 0.03408762
 0.03498116 0.03601156 0.03721503 0.03820518 0.0392879  0.0405276 ]
MRR_all_avg_next: [0.00162207 0.00252568 0.00307576 0.00347725 0.00383467 0.00410166
 0.00430694 0.00449561 0.00468389 0.00482235 0.00495517 0.00507592
 0.00519667 0.0052881  0.00537933 0.00546058 0.00553256 0.00560613
 0.00566438 0.00572154 0.00577981 0.00582774 0.00588321 0.00593353
 0.00596927 0.0060089  0.00605347 0.00608883 0.00612617 0.00616749]
record_num: 248448.0
=========== testing next new item epoch: 89 ===========
recall_all_avg_next_new: [0.00165946 0.00357063 0.00525805 0.00684293 0.00867952 0.01033898
 0.01183062 0.01337821 0.01514021 0.01654796 0.01806757 0.01952193
 0.02109748 0.02238402 0.02380109 0.02514357 0.02637418 0.02767005
 0.02877946 0.02995413 0.03122203 0.03232212 0.03359934 0.03482995
 0.03573426 0.03676909 0.03800902 0.03898792 0.04007868 0.04137455]
MRR_all_avg_next_new: [0.00165946 0.00261504 0.00317752 0.00357374 0.00394106 0.00421763
 0.00443072 0.00462417 0.00481995 0.00496072 0.00509887 0.00522007
 0.00534126 0.00543316 0.00552763 0.00561154 0.00568392 0.00575592
 0.00581431 0.00587304 0.00593342 0.00598342 0.00603895 0.00609023
 0.0061264  0.0061662  0.00621213 0.00624709 0.0062847  0.00632789]
record_num_new: 107264.0
iteration 90 begin ...
all_loss 642156.8639297485
iteration 91 begin ...
all_loss 642110.6382751465
iteration 92 begin ...
all_loss 642002.4539718628
iteration 93 begin ...
all_loss 641942.3214492798
iteration 94 begin ...
all_loss 641781.1483078003
iteration 95 begin ...
all_loss 641708.5818023682
iteration 96 begin ...
all_loss 641622.1305618286
iteration 97 begin ...
all_loss 641527.6162109375
iteration 98 begin ...
all_loss 641432.9115219116
iteration 99 begin ...
all_loss 641335.9284591675
eval ...
~~~~~~~~~~~~~ testing next item epoch: 99 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00166634 0.00342929 0.00522443 0.00679015 0.00860542 0.01011077
 0.01168051 0.01338308 0.0149649  0.01640182 0.01791522 0.01928774
 0.02076893 0.0221978  0.02357032 0.02487442 0.02596117 0.02745846
 0.02856533 0.02986138 0.03117755 0.03240115 0.03347582 0.03475576
 0.03563321 0.03656298 0.0376296  0.03868818 0.0397387  0.04099852]
MRR_all_avg_next: [0.00166634 0.00254782 0.0031462  0.00353763 0.00390068 0.00415157
 0.00437582 0.00458864 0.0047644  0.00490809 0.00504567 0.00516005
 0.00527399 0.00537605 0.00546755 0.00554906 0.00561299 0.00569617
 0.00575442 0.00581923 0.0058819  0.00593752 0.00598424 0.00603758
 0.00607267 0.00610843 0.00614794 0.00618574 0.00622197 0.00626396]
record_num: 248448.0
=========== testing next new item epoch: 99 ===========
recall_all_avg_next_new: [0.00172472 0.00357063 0.00537925 0.00696413 0.00879139 0.01036695
 0.01197047 0.01372315 0.01537328 0.01683696 0.01841251 0.01980161
 0.02127461 0.02273829 0.02415536 0.02547919 0.02657928 0.02808957
 0.02919899 0.03050418 0.03183734 0.03309591 0.034196   0.03555713
 0.03645212 0.0373844  0.03845652 0.03957525 0.04058212 0.04185934]
MRR_all_avg_next_new: [0.00172472 0.00264767 0.00325055 0.00364677 0.00401222 0.00427481
 0.00450389 0.00472297 0.00490632 0.00505269 0.00519592 0.00531168
 0.00542498 0.00552953 0.005624   0.00570674 0.00577146 0.00585536
 0.00591375 0.00597901 0.00604249 0.0060997  0.00614753 0.00620425
 0.00624004 0.0062759  0.00631561 0.00635556 0.00639028 0.00643286]
record_num_new: 107264.0
------------- end top_n_item is: 50 -----------------
------------- end top_n_item is: 50 -----------------
30Music
============================================
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
init hrm ... 
init data_generation
------------------------------
Test records (next-new):337035
------------------------------
Test records (next-item):616081
building model ... 
running ... 
2022-07-08 12:28:46.086267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0)
2022-07-08 12:28:46.086323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:b1:00.0)
iteration 0 begin ...
all_loss 3464002.398727417
eval ...
~~~~~~~~~~~~~ testing next item epoch: 0 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00044954 0.00063617 0.00100131 0.00123987 0.00148006 0.00166344
 0.00181112 0.00210649 0.00231097 0.00241159 0.00260795 0.00279134
 0.00302665 0.00325061 0.00346645 0.00365633 0.0038527  0.0040588
 0.0042146  0.00442395 0.00466251 0.00487835 0.0050666  0.00526784
 0.00550478 0.00565246 0.00590725 0.00619612 0.00636814 0.00661644]
MRR_all_avg_next: [0.00044954 0.00054285 0.00066457 0.00072421 0.00077224 0.00080281
 0.0008239  0.00086082 0.00088354 0.00089361 0.00091146 0.00092674
 0.00094484 0.00096084 0.00097523 0.0009871  0.00099865 0.0010101
 0.0010183  0.00102876 0.00104012 0.00104993 0.00105812 0.0010665
 0.00107598 0.00108166 0.0010911  0.00110142 0.00110735 0.00111562]
record_num: 616192.0
=========== testing next new item epoch: 0 ===========
recall_all_avg_next_new: [0.00045084 0.00063769 0.00099065 0.00123683 0.00148004 0.00166394
 0.00181521 0.00210884 0.00231646 0.00242324 0.00262493 0.00280882
 0.00304907 0.00326856 0.00348804 0.00366897 0.00386473 0.00407235
 0.00424141 0.00445793 0.00468928 0.0049058  0.00509859 0.00530918
 0.00555239 0.00570959 0.00596763 0.00626424 0.00644813 0.00669431]
MRR_all_avg_next_new: [0.00045084 0.00054426 0.00066192 0.00072346 0.0007721  0.00080275
 0.00082436 0.00086107 0.00088414 0.00089481 0.00091315 0.00092847
 0.00094695 0.00096263 0.00097726 0.00098857 0.00100009 0.00101162
 0.00102052 0.00103135 0.00104236 0.0010522  0.00106059 0.00106936
 0.00107909 0.00108514 0.00109469 0.00110529 0.00111163 0.00111983]
record_num_new: 337152.0
iteration 1 begin ...
all_loss 3312468.66166687
iteration 2 begin ...
all_loss 3082623.049423218
iteration 3 begin ...
all_loss 2930835.551727295
iteration 4 begin ...
all_loss 2800513.417442322
iteration 5 begin ...
all_loss 2659888.826148987
iteration 6 begin ...
all_loss 2534514.197906494
iteration 7 begin ...
all_loss 2434344.6948547363
iteration 8 begin ...
all_loss 2348566.754043579
iteration 9 begin ...
all_loss 2270405.684158325
eval ...
~~~~~~~~~~~~~ testing next item epoch: 9 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00079521 0.00149629 0.00222009 0.00298446 0.00359141 0.00419512
 0.00482642 0.00537657 0.00598515 0.00662943 0.00720392 0.00769241
 0.0081955  0.00876837 0.0092812  0.00982486 0.01036041 0.01085214
 0.01132439 0.01179827 0.01227539 0.01272818 0.01325399 0.01371975
 0.01427639 0.01473729 0.01520955 0.01567044 0.01614919 0.01661008]
MRR_all_avg_next: [0.00079521 0.00114575 0.00138701 0.00157811 0.0016995  0.00180012
 0.0018903  0.00195907 0.00202669 0.00209112 0.00214334 0.00218405
 0.00222275 0.00226367 0.00229786 0.00233184 0.00236334 0.00239066
 0.00241551 0.00243921 0.00246193 0.00248251 0.00250537 0.00252478
 0.00254704 0.00256477 0.00258226 0.00259872 0.00261523 0.00263059]
record_num: 616192.0
=========== testing next new item epoch: 9 ===========
recall_all_avg_next_new: [0.00081566 0.00151267 0.00221562 0.00299272 0.00360668 0.00421768
 0.00485538 0.00539223 0.00599729 0.00663202 0.00720743 0.00769089
 0.00820105 0.00877349 0.00928661 0.00982643 0.01036624 0.01084377
 0.0113213  0.0117751  0.01224967 0.01269754 0.01322549 0.01369115
 0.01424877 0.01470553 0.01518306 0.01563983 0.01611736 0.01658006]
MRR_all_avg_next_new: [0.00081566 0.00116416 0.00139848 0.00159275 0.00171555 0.00181738
 0.00190848 0.00197559 0.00204282 0.00210629 0.0021586  0.00219889
 0.00223813 0.00227902 0.00231323 0.00234696 0.00237872 0.00240525
 0.00243038 0.00245307 0.00247567 0.00249603 0.00251898 0.00253838
 0.00256069 0.00257826 0.00259594 0.00261226 0.00262872 0.00264415]
record_num_new: 337152.0
iteration 10 begin ...
all_loss 2199253.752380371
iteration 11 begin ...
all_loss 2136425.216316223
iteration 12 begin ...
all_loss 2082705.8638458252
iteration 13 begin ...
all_loss 2037362.0037612915
iteration 14 begin ...
all_loss 1999484.1080322266
iteration 15 begin ...
all_loss 1967769.6321487427
iteration 16 begin ...
all_loss 1941032.5989074707
iteration 17 begin ...
all_loss 1918321.963546753
iteration 18 begin ...
all_loss 1898999.3357467651
iteration 19 begin ...
all_loss 1882334.840171814
eval ...
~~~~~~~~~~~~~ testing next item epoch: 19 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00134374 0.00258686 0.00364821 0.00472418 0.00582448 0.00685663
 0.00784983 0.00884302 0.00989302 0.01084402 0.01176581 0.01260321
 0.01374085 0.01470321 0.01559092 0.01647538 0.01736796 0.01827028
 0.01910443 0.01997105 0.02082955 0.0217773  0.02251084 0.02342614
 0.02430736 0.02508471 0.02578904 0.02666864 0.02748494 0.02826229]
MRR_all_avg_next: [0.00134374 0.0019653  0.00231908 0.00258807 0.00280813 0.00298016
 0.00312204 0.00324619 0.00336286 0.00345796 0.00354176 0.00361154
 0.00369905 0.00376779 0.00382697 0.00388225 0.00393476 0.00398489
 0.00402879 0.00407212 0.004113   0.00415608 0.00418797 0.00422611
 0.00426136 0.00429126 0.00431734 0.00434876 0.00437691 0.00440282]
record_num: 616192.0
=========== testing next new item epoch: 19 ===========
recall_all_avg_next_new: [0.0013614  0.00258637 0.00363931 0.00471894 0.00581044 0.00686337
 0.00785106 0.00884468 0.00991244 0.0108586  0.01176917 0.01260856
 0.01371785 0.01466698 0.01555975 0.01644362 0.01734529 0.01824103
 0.01907745 0.01993166 0.02078291 0.02173204 0.02247354 0.02337818
 0.02424426 0.02503025 0.02576583 0.02663784 0.02745349 0.02823059]
MRR_all_avg_next_new: [0.0013614  0.00197389 0.00232487 0.00259477 0.00281307 0.00298856
 0.00312966 0.00325386 0.0033725  0.00346712 0.0035499  0.00361985
 0.00370518 0.00377297 0.00383249 0.00388773 0.00394077 0.00399054
 0.00403456 0.00407727 0.0041178  0.00416095 0.00419319 0.00423088
 0.00426552 0.00429575 0.004323   0.00435414 0.00438226 0.00440817]
record_num_new: 337152.0
iteration 20 begin ...
all_loss 1868057.1462097168
iteration 21 begin ...
all_loss 1855480.3203735352
iteration 22 begin ...
all_loss 1844563.1219711304
iteration 23 begin ...
all_loss 1834987.6181793213
iteration 24 begin ...
all_loss 1826531.0573883057
iteration 25 begin ...
all_loss 1819020.1202392578
iteration 26 begin ...
all_loss 1812290.473892212
iteration 27 begin ...
all_loss 1806360.8838806152
iteration 28 begin ...
all_loss 1801027.6554260254
iteration 29 begin ...
all_loss 1796192.5610580444
eval ...
~~~~~~~~~~~~~ testing next item epoch: 29 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00177055 0.00344049 0.00487997 0.00621884 0.0076421  0.00919356
 0.01067849 0.01190213 0.01326535 0.01453768 0.01577755 0.01706286
 0.01818427 0.01951502 0.02071919 0.02206455 0.02321354 0.02440311
 0.02558943 0.02676601 0.02798965 0.02897311 0.03008153 0.03114614
 0.03230487 0.03332241 0.03421661 0.03526985 0.03621274 0.03720756]
MRR_all_avg_next: [0.00177055 0.00260552 0.00308535 0.00342006 0.00370472 0.00396329
 0.00417543 0.00432838 0.00447985 0.00460708 0.0047198  0.00482691
 0.00491317 0.00500822 0.0050885  0.00517259 0.00524017 0.00530626
 0.0053687  0.00542753 0.0054858  0.0055305  0.00557869 0.00562305
 0.0056694  0.00570854 0.00574165 0.00577927 0.00581178 0.00584494]
record_num: 616192.0
=========== testing next new item epoch: 29 ===========
recall_all_avg_next_new: [0.00176478 0.00344948 0.00489987 0.00625237 0.00764937 0.00917094
 0.01064208 0.01187892 0.01325515 0.0145424  0.0158     0.01707835
 0.01820544 0.01954015 0.02075028 0.0220672  0.02320318 0.0243718
 0.02557304 0.02674461 0.02795475 0.02893947 0.03003097 0.03109577
 0.03224065 0.03326986 0.03415967 0.03521854 0.03616173 0.03717018]
MRR_all_avg_next_new: [0.00176478 0.00260713 0.00309059 0.00342872 0.00370812 0.00396171
 0.00417188 0.00432648 0.0044794  0.00460812 0.00472245 0.00482898
 0.00491568 0.00501101 0.00509169 0.005174   0.00524082 0.00530574
 0.00536897 0.00542754 0.00548517 0.00552993 0.00557739 0.00562175
 0.00566755 0.00570713 0.00574009 0.00577791 0.00581043 0.00584405]
record_num_new: 337152.0
iteration 30 begin ...
all_loss 1791835.540687561
iteration 31 begin ...
all_loss 1787908.9790115356
iteration 32 begin ...
all_loss 1784363.2602920532
iteration 33 begin ...
all_loss 1781085.1365585327
iteration 34 begin ...
all_loss 1778102.527496338
iteration 35 begin ...
all_loss 1775365.2128448486
iteration 36 begin ...
all_loss 1772885.7599868774
iteration 37 begin ...
all_loss 1770612.393989563
iteration 38 begin ...
all_loss 1768438.5569992065
iteration 39 begin ...
all_loss 1766498.939590454
eval ...
~~~~~~~~~~~~~ testing next item epoch: 39 ~~~~~~~~~~~~~
recall_all_avg_next: [0.0020221  0.00379265 0.00562162 0.0072591  0.00892092 0.01046589
 0.01204819 0.01350878 0.01502616 0.01661008 0.01792299 0.01933488
 0.02082143 0.02211973 0.02352838 0.02510581 0.02642521 0.02776894
 0.02908022 0.0303136  0.03154049 0.03271221 0.03394883 0.03520494
 0.0364724  0.03750941 0.03855454 0.03970191 0.04074866 0.04175647]
MRR_all_avg_next: [0.0020221  0.00290737 0.00351703 0.0039264  0.00425876 0.00451626
 0.0047423  0.00492488 0.00509347 0.00525187 0.00537122 0.00548888
 0.00560323 0.00569596 0.00578987 0.00588846 0.00596608 0.00604073
 0.00610974 0.00617141 0.00622983 0.00628309 0.00633686 0.0063892
 0.0064399  0.00647978 0.00651849 0.00655947 0.00659556 0.00662916]
record_num: 616192.0
=========== testing next new item epoch: 39 ===========
recall_all_avg_next_new: [0.0019991  0.00379058 0.00561764 0.00726675 0.00891289 0.01043446
 0.01203018 0.0134776  0.01499324 0.01660082 0.0179296  0.01933253
 0.02083927 0.02215025 0.02353834 0.02509254 0.02639462 0.02771747
 0.02901659 0.03024748 0.03146949 0.03265886 0.03388383 0.03513252
 0.03641681 0.03745195 0.03849006 0.03967647 0.04072644 0.04178234]
MRR_all_avg_next_new: [0.0019991  0.00289484 0.00350386 0.00391614 0.00424537 0.00449896
 0.00472692 0.00490785 0.00507625 0.00523701 0.00535781 0.00547472
 0.00559062 0.00568426 0.0057768  0.00587394 0.00595053 0.00602402
 0.0060924  0.00615394 0.00621213 0.0062662  0.00631946 0.00637149
 0.00642286 0.00646267 0.00650112 0.00654349 0.0065797  0.00661489]
record_num_new: 337152.0
iteration 40 begin ...
all_loss 1764625.6818771362
iteration 41 begin ...
all_loss 1762983.9274368286
iteration 42 begin ...
all_loss 1761410.466430664
iteration 43 begin ...
all_loss 1759915.6559371948
iteration 44 begin ...
all_loss 1758580.4775009155
iteration 45 begin ...
all_loss 1757274.2210464478
iteration 46 begin ...
all_loss 1756067.1373519897
iteration 47 begin ...
all_loss 1754946.123840332
iteration 48 begin ...
all_loss 1753876.3058700562
iteration 49 begin ...
all_loss 1752864.122428894
eval ...
~~~~~~~~~~~~~ testing next item epoch: 49 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00208539 0.00402147 0.0059462  0.0076421  0.00940291 0.01107772
 0.01272168 0.01424718 0.0158311  0.01731279 0.01883017 0.02031834
 0.0218909  0.0234375  0.02506362 0.02633432 0.02761964 0.02895526
 0.03037852 0.03178717 0.03316174 0.03448763 0.03582163 0.03711992
 0.03832896 0.03950879 0.04071783 0.04191875 0.04304502 0.04417454]
MRR_all_avg_next: [0.00208539 0.00305343 0.00369501 0.00411898 0.00447114 0.00475028
 0.00498513 0.00517582 0.00535181 0.00549998 0.00563792 0.00576194
 0.0058829  0.00599337 0.00610178 0.0061812  0.00625681 0.00633101
 0.00640592 0.00647635 0.0065418  0.00660207 0.00666007 0.00671417
 0.00676253 0.00680791 0.00685269 0.00689558 0.00693441 0.00697206]
record_num: 616192.0
=========== testing next new item epoch: 49 ===========
recall_all_avg_next_new: [0.00207621 0.0039982  0.00591425 0.00761674 0.00938449 0.01104546
 0.01270644 0.01422207 0.01582372 0.0173008  0.0188372  0.02033801
 0.02188924 0.02343453 0.02503322 0.02631454 0.02759586 0.02893354
 0.03036019 0.03175719 0.03316012 0.03451856 0.03586216 0.03716425
 0.03839218 0.03959638 0.04079169 0.04202556 0.04316154 0.04427677]
MRR_all_avg_next_new: [0.00207621 0.00303721 0.00367589 0.00410151 0.00445506 0.00473189
 0.00496917 0.00515863 0.00533659 0.0054843  0.00562397 0.00574904
 0.00586836 0.00597874 0.00608532 0.0061654  0.00624077 0.00631509
 0.00639018 0.00646003 0.00652683 0.00658858 0.006647   0.00670125
 0.00675037 0.00679668 0.00684095 0.00688502 0.00692419 0.00696137]
record_num_new: 337152.0
iteration 50 begin ...
all_loss 1751936.7257843018
iteration 51 begin ...
all_loss 1751102.1866836548
iteration 52 begin ...
all_loss 1750166.9491729736
iteration 53 begin ...
all_loss 1749407.090171814
iteration 54 begin ...
all_loss 1748625.2069015503
iteration 55 begin ...
all_loss 1747937.2675170898
iteration 56 begin ...
all_loss 1747255.0752944946
iteration 57 begin ...
all_loss 1746603.7861480713
iteration 58 begin ...
all_loss 1745931.6941223145
iteration 59 begin ...
all_loss 1745437.3861236572
eval ...
~~~~~~~~~~~~~ testing next item epoch: 59 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00212758 0.00417889 0.0062513  0.00805918 0.00991899 0.01164734
 0.01332864 0.01488984 0.01657113 0.01826379 0.01966919 0.02121904
 0.0227348  0.02439986 0.02583286 0.02735673 0.02880758 0.03018864
 0.03149343 0.03295888 0.03432047 0.03581676 0.03705988 0.03830462
 0.03970516 0.04100021 0.04212486 0.04323166 0.04434494 0.045541  ]
MRR_all_avg_next: [0.00212758 0.00315324 0.00384404 0.00429601 0.00466797 0.00495603
 0.00519622 0.00539137 0.00557818 0.00574744 0.00587521 0.00600436
 0.00612096 0.00623989 0.00633542 0.00643067 0.00651601 0.00659273
 0.00666141 0.00673468 0.00679952 0.00686753 0.00692158 0.00697344
 0.00702947 0.00707928 0.00712093 0.00716046 0.00719885 0.00723872]
record_num: 616192.0
=========== testing next new item epoch: 59 ===========
recall_all_avg_next_new: [0.00210884 0.00417319 0.00624941 0.00804088 0.00987685 0.01160308
 0.01328778 0.01485977 0.01655633 0.01824696 0.01968548 0.02123968
 0.02275532 0.02442519 0.02586667 0.0274001  0.02885345 0.03020893
 0.03152584 0.03298809 0.03433466 0.03587699 0.03716425 0.03842481
 0.03980401 0.04110312 0.04224504 0.0433662  0.04446066 0.04567376]
MRR_all_avg_next_new: [0.00210884 0.00314102 0.00383309 0.00428096 0.00464815 0.00493585
 0.00517653 0.00537303 0.00556153 0.0057306  0.00586137 0.00599089
 0.00610747 0.00622675 0.00632285 0.00641869 0.00650418 0.00657948
 0.0066488  0.00672191 0.00678603 0.00685614 0.0069121  0.00696463
 0.0070198  0.00706976 0.00711205 0.0071521  0.00718984 0.00723027]
record_num_new: 337152.0
iteration 60 begin ...
all_loss 1744758.9578857422
iteration 61 begin ...
all_loss 1744277.4615402222
iteration 62 begin ...
all_loss 1743794.1164627075
iteration 63 begin ...
all_loss 1743191.2187576294
iteration 64 begin ...
all_loss 1742819.8098220825
iteration 65 begin ...
all_loss 1742309.540008545
iteration 66 begin ...
all_loss 1741923.0903396606
iteration 67 begin ...
all_loss 1741464.026550293
iteration 68 begin ...
all_loss 1741071.78049469
iteration 69 begin ...
all_loss 1740618.6293640137
eval ...
~~~~~~~~~~~~~ testing next item epoch: 69 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00214219 0.00434443 0.00631621 0.0083302  0.0100764  0.01182424
 0.01337083 0.01517871 0.01666039 0.01834169 0.01999539 0.0215144
 0.02307073 0.02473255 0.02619151 0.02761315 0.02905588 0.03039799
 0.03194297 0.03334999 0.03485764 0.03630362 0.03759542 0.03881096
 0.0401482  0.04145948 0.04264742 0.04394247 0.04509309 0.04626805]
MRR_all_avg_next: [0.00214219 0.00324331 0.00390057 0.00440407 0.00475331 0.00504461
 0.00526555 0.00549154 0.00565617 0.0058243  0.00597464 0.00610122
 0.00622094 0.00633964 0.0064369  0.00652576 0.00661062 0.00668519
 0.0067665  0.00683685 0.00690864 0.00697437 0.00703054 0.00708118
 0.00713467 0.00718511 0.0072291  0.00727536 0.00731503 0.0073542 ]
record_num: 616192.0
=========== testing next new item epoch: 69 ===========
recall_all_avg_next_new: [0.0021385  0.00433336 0.00629983 0.00830486 0.01002812 0.01177807
 0.01331447 0.0151534  0.01664828 0.01831815 0.01999395 0.02151552
 0.02307861 0.02473958 0.0261959  0.02760476 0.02905811 0.03045214
 0.0320271  0.03341816 0.0349249  0.03636045 0.03768033 0.03893496
 0.04026077 0.04159252 0.04277892 0.04408397 0.04524962 0.0464301 ]
MRR_all_avg_next_new: [0.0021385  0.00323593 0.00389142 0.00439268 0.00473733 0.00502899
 0.00524847 0.00547834 0.00564444 0.00581142 0.00596377 0.00609057
 0.00621081 0.00632945 0.00642653 0.00651459 0.00660008 0.00667752
 0.00676042 0.00682997 0.00690172 0.00696697 0.00702436 0.00707663
 0.00712967 0.00718089 0.00722483 0.00727144 0.00731163 0.00735098]
record_num_new: 337152.0
iteration 70 begin ...
all_loss 1740281.9277496338
iteration 71 begin ...
all_loss 1739939.524597168
iteration 72 begin ...
all_loss 1739575.111793518
iteration 73 begin ...
all_loss 1739238.4939117432
iteration 74 begin ...
all_loss 1738961.153793335
iteration 75 begin ...
all_loss 1738572.676361084
iteration 76 begin ...
all_loss 1738278.4480667114
iteration 77 begin ...
all_loss 1738038.3210220337
iteration 78 begin ...
all_loss 1737612.4875946045
iteration 79 begin ...
all_loss 1737483.8075027466
eval ...
~~~~~~~~~~~~~ testing next item epoch: 79 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00222009 0.00441096 0.00640547 0.00836752 0.010289   0.01192972
 0.01360453 0.01529718 0.01699308 0.01865977 0.02023558 0.02188117
 0.0234586  0.02494677 0.02662482 0.02811948 0.02955085 0.03100982
 0.03236816 0.03387418 0.03538994 0.03674666 0.03804496 0.03939032
 0.04072757 0.04198691 0.04315538 0.04432709 0.04560105 0.04672732]
MRR_all_avg_next: [0.00222009 0.00331553 0.00398036 0.00447087 0.00485517 0.00512862
 0.00536788 0.00557946 0.0057679  0.00593456 0.00607782 0.00621495
 0.00633629 0.00644259 0.00655446 0.00664788 0.00673208 0.00681313
 0.00688462 0.00695992 0.0070321  0.00709377 0.00715022 0.00720628
 0.00725976 0.0073082  0.00735148 0.00739332 0.00743725 0.0074748 ]
record_num: 616192.0
=========== testing next new item epoch: 79 ===========
recall_all_avg_next_new: [0.00221858 0.00440751 0.00639771 0.00834638 0.01026837 0.01188188
 0.01357548 0.01527798 0.0169953  0.01866814 0.02023716 0.02187144
 0.02346123 0.02495907 0.0266497  0.0281772  0.02960682 0.03108094
 0.03243641 0.03396688 0.03547361 0.03684095 0.03814007 0.03952223
 0.04087177 0.0421353  0.04331577 0.04449625 0.04574495 0.04688983]
MRR_all_avg_next_new: [0.00221858 0.00331305 0.00397645 0.00446361 0.00484801 0.00511693
 0.00535887 0.00557169 0.0057625  0.00592978 0.00607242 0.00620861
 0.0063309  0.00643789 0.0065506  0.00664607 0.00673016 0.00681206
 0.0068834  0.00695992 0.00703167 0.00709382 0.00715031 0.0072079
 0.00726188 0.00731048 0.0073542  0.00739636 0.00743942 0.00747758]
record_num_new: 337152.0
iteration 80 begin ...
all_loss 1737140.3156356812
iteration 81 begin ...
all_loss 1736882.4184494019
iteration 82 begin ...
all_loss 1736615.8193588257
iteration 83 begin ...
all_loss 1736401.911529541
iteration 84 begin ...
all_loss 1736150.8407440186
iteration 85 begin ...
all_loss 1735876.7181777954
iteration 86 begin ...
all_loss 1735704.3960418701
iteration 87 begin ...
all_loss 1735437.8213119507
iteration 88 begin ...
all_loss 1735242.5140914917
iteration 89 begin ...
all_loss 1735057.9460372925
eval ...
~~~~~~~~~~~~~ testing next item epoch: 89 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00228013 0.00431846 0.00654342 0.00849411 0.01039449 0.01219425
 0.01391287 0.01567369 0.01728195 0.0189957  0.02059748 0.02218951
 0.02371988 0.02535086 0.02694128 0.02839375 0.029916   0.03141391
 0.03291344 0.03442109 0.03583461 0.03718322 0.03852208 0.03981064
 0.04118359 0.04245755 0.04368444 0.04495028 0.04617392 0.04733914]
MRR_all_avg_next: [0.00228013 0.0032993  0.00404095 0.00452862 0.0049087  0.00520866
 0.00545418 0.00567428 0.00585297 0.00602435 0.00616996 0.00630263
 0.00642035 0.00653685 0.00664288 0.00673366 0.0068232  0.00690642
 0.00698534 0.00706073 0.00712804 0.00718934 0.00724755 0.00730124
 0.00735616 0.00740516 0.0074506  0.0074958  0.007538   0.00757684]
record_num: 616192.0
=========== testing next new item epoch: 89 ===========
recall_all_avg_next_new: [0.00228087 0.00433336 0.00654304 0.00849172 0.01038107 0.01215772
 0.01386912 0.0156161  0.01723852 0.01897957 0.02057826 0.02223626
 0.02378156 0.02541287 0.02700562 0.0284738  0.02999537 0.03151101
 0.03301182 0.03452449 0.03592742 0.03729772 0.03865022 0.03996714
 0.04135523 0.04263062 0.04385559 0.04514284 0.04635891 0.04753346]
MRR_all_avg_next_new: [0.00228087 0.00330711 0.00404368 0.00453084 0.00490872 0.00520482
 0.00544931 0.00566768 0.00584795 0.00602206 0.00616739 0.00630556
 0.00642443 0.00654095 0.00664713 0.00673889 0.0068284  0.0069126
 0.00699159 0.00706722 0.00713403 0.00719632 0.00725512 0.00730999
 0.00736552 0.00741457 0.00745994 0.00750591 0.00754784 0.007587  ]
record_num_new: 337152.0
iteration 90 begin ...
all_loss 1734789.2738571167
iteration 91 begin ...
all_loss 1734628.1263656616
iteration 92 begin ...
all_loss 1734426.6097946167
iteration 93 begin ...
all_loss 1734216.6211090088
iteration 94 begin ...
all_loss 1734044.0995635986
iteration 95 begin ...
all_loss 1733892.7170944214
iteration 96 begin ...
all_loss 1733643.7629470825
iteration 97 begin ...
all_loss 1733542.8439407349
iteration 98 begin ...
all_loss 1733380.799484253
iteration 99 begin ...
all_loss 1733184.2906417847
eval ...
~~~~~~~~~~~~~ testing next item epoch: 99 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00225254 0.0044986  0.00665864 0.00855902 0.01033282 0.01216179
 0.01396805 0.01569803 0.0175124  0.01912716 0.02074678 0.02236316
 0.02389677 0.02555697 0.02716037 0.02864529 0.03020163 0.03155835
 0.03301568 0.03453794 0.03600501 0.03735362 0.03869735 0.03989341
 0.04128096 0.0425111  0.04392462 0.04516612 0.04633621 0.04751441]
MRR_all_avg_next: [0.00225254 0.00337557 0.00409558 0.00457068 0.00492544 0.00523027
 0.00548831 0.00570455 0.00590615 0.00606763 0.00621486 0.00634956
 0.00646753 0.00658612 0.00669301 0.00678582 0.00687737 0.00695274
 0.00702944 0.00710556 0.00717542 0.00723672 0.00729514 0.00734498
 0.00740048 0.00744779 0.00750014 0.00754448 0.00758483 0.0076241 ]
record_num: 616192.0
=========== testing next new item epoch: 99 ===========
recall_all_avg_next_new: [0.00224528 0.00451428 0.00664982 0.00854214 0.01031582 0.01212509
 0.01395216 0.01566356 0.01746987 0.01914863 0.02076511 0.02239643
 0.02395062 0.02560566 0.02721918 0.02872295 0.03029791 0.03166228
 0.03314232 0.03467575 0.03612614 0.03750237 0.03884301 0.04005315
 0.04142345 0.04266622 0.04409584 0.0453386  0.04650128 0.04769066]
MRR_all_avg_next_new: [0.00224528 0.00337978 0.00409163 0.00456471 0.00491944 0.00522099
 0.005482   0.00569592 0.00589662 0.0060645  0.00621145 0.0063474
 0.00646695 0.00658517 0.00669273 0.00678672 0.00687936 0.00695516
 0.00703306 0.00710973 0.0071788  0.00724135 0.00729964 0.00735006
 0.00740488 0.00745268 0.00750562 0.00755001 0.0075901  0.00762975]
record_num_new: 337152.0
------------- end top_n_item is: 50 -----------------
------------- end top_n_item is: 50 -----------------
xiami
============================================
+++++++++++++ start top_n_item is: 10 ++++++++++++++++
+++++++++++++ start top_n_item is: 10 ++++++++++++++++
init hrm ... 
init data_generation
------------------------------
Test records (next-new):218593
------------------------------
Test records (next-item):612641
building model ... 
running ... 
2022-07-08 16:26:28.094381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0)
2022-07-08 16:26:28.094438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:b1:00.0)
iteration 0 begin ...
all_loss 3316126.0186691284
eval ...
~~~~~~~~~~~~~ testing next item epoch: 0 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00072462 0.00121586 0.00177891 0.00221466 0.0027059  0.00311717
 0.00348437 0.00392991 0.00451418 0.00514251 0.0056517  0.006156
 0.0065232  0.00678759 0.00707483 0.00765093 0.00802793 0.00839024
 0.00868563 0.00915076 0.0095147  0.00988354 0.0105086  0.01095741
 0.01131156 0.01162164 0.01183544 0.01213247 0.01243439 0.01278528]
MRR_all_avg_next: [0.00072462 0.00097024 0.00115792 0.00126686 0.00136511 0.00143365
 0.00148611 0.0015418  0.00160672 0.00166955 0.00171584 0.00175787
 0.00178612 0.001805   0.00182415 0.00186016 0.00188233 0.00190246
 0.00191801 0.00194126 0.00195859 0.00197536 0.00200254 0.00202124
 0.0020354  0.00204733 0.00205525 0.00206586 0.00207627 0.00208796]
record_num: 612736.0
=========== testing next new item epoch: 0 ===========
recall_all_avg_next_new: [0.0007227  0.00121213 0.00176101 0.00219555 0.00267583 0.00308749
 0.00344884 0.00389253 0.00449173 0.00511838 0.00563525 0.00613382
 0.00649974 0.00676047 0.00704406 0.00761124 0.00798631 0.00835681
 0.00864955 0.00911611 0.00946831 0.00985253 0.01047918 0.01091829
 0.01127964 0.01158153 0.01179194 0.01208468 0.01239114 0.01277078]
MRR_all_avg_next_new: [0.0007227  0.00096741 0.00115038 0.00125901 0.00135507 0.00142368
 0.0014753  0.00153076 0.00159734 0.00166    0.00170699 0.00174854
 0.00177669 0.00179531 0.00181421 0.00184966 0.00187173 0.00189231
 0.00190772 0.00193105 0.00194782 0.00196528 0.00199253 0.00201082
 0.00202528 0.00203689 0.00204468 0.00205514 0.0020657  0.00207836]
record_num_new: 218624.0
iteration 1 begin ...
all_loss 2892707.469894409
iteration 2 begin ...
all_loss 2676204.8917388916
iteration 3 begin ...
all_loss 2545842.2435684204
iteration 4 begin ...
all_loss 2424535.6930770874
iteration 5 begin ...
all_loss 2298222.0117111206
iteration 6 begin ...
all_loss 2179135.811340332
iteration 7 begin ...
all_loss 2078269.6766281128
iteration 8 begin ...
all_loss 1997638.7253112793
iteration 9 begin ...
all_loss 1934042.906211853
eval ...
~~~~~~~~~~~~~ testing next item epoch: 9 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00122728 0.00246599 0.00351701 0.00462189 0.00566312 0.00654768
 0.00758238 0.00849469 0.00943636 0.01048576 0.01136215 0.01220428
 0.01301376 0.01394891 0.01476492 0.01569518 0.01650793 0.01740227
 0.01825746 0.01913222 0.01996292 0.0206141  0.02143174 0.02222164
 0.02297401 0.023728   0.02445099 0.02536982 0.02617114 0.02693982]
MRR_all_avg_next: [0.00122728 0.00184664 0.00219698 0.0024732  0.00268144 0.00282887
 0.00297668 0.00309072 0.00319535 0.00330029 0.00337996 0.00345014
 0.00351241 0.00357921 0.00363361 0.00369175 0.00373956 0.00378924
 0.00383425 0.00387799 0.00391755 0.00394715 0.0039827  0.00401561
 0.0040457  0.0040747  0.00410148 0.0041343  0.00416193 0.00418755]
record_num: 612736.0
=========== testing next new item epoch: 9 ===========
recall_all_avg_next_new: [0.00125329 0.00249286 0.0035266  0.00462438 0.00568099 0.00655006
 0.00759752 0.00849861 0.00943172 0.0104746  0.01135282 0.01219903
 0.01301778 0.01393717 0.0147605  0.01571648 0.01653981 0.01742261
 0.01827796 0.0191516  0.01997951 0.02064275 0.02148438 0.02229398
 0.02305328 0.02378513 0.02449868 0.02542264 0.02625055 0.02703729]
MRR_all_avg_next_new: [0.00125329 0.00187308 0.00221766 0.0024921  0.00270342 0.00284827
 0.00299791 0.00311054 0.00321422 0.00331851 0.00339835 0.00346887
 0.00353185 0.00359752 0.00365241 0.00371215 0.00376059 0.00380963
 0.00385465 0.00389833 0.00393775 0.0039679  0.00400449 0.00403823
 0.0040686  0.00409675 0.00412318 0.00415617 0.00418472 0.00421095]
record_num_new: 218624.0
iteration 10 begin ...
all_loss 1883186.7186813354
iteration 11 begin ...
all_loss 1841996.2468414307
iteration 12 begin ...
all_loss 1808432.9001159668
iteration 13 begin ...
all_loss 1780955.807609558
iteration 14 begin ...
all_loss 1758523.4082870483
iteration 15 begin ...
all_loss 1740117.709350586
iteration 16 begin ...
all_loss 1725020.8164672852
iteration 17 begin ...
all_loss 1712405.7621688843
iteration 18 begin ...
all_loss 1701924.901626587
iteration 19 begin ...
all_loss 1693104.1610107422
eval ...
~~~~~~~~~~~~~ testing next item epoch: 19 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00158633 0.00284788 0.00413065 0.00515883 0.00638285 0.00739307
 0.00849469 0.00959957 0.01066691 0.01171793 0.01259107 0.01372043
 0.01478124 0.01579636 0.01690287 0.01785108 0.01873074 0.019692
 0.02053902 0.02158189 0.02262475 0.02362355 0.0246452  0.02566358
 0.02657099 0.02749634 0.02838906 0.02927688 0.03028547 0.03103131]
MRR_all_avg_next: [0.00158633 0.0022171  0.0026447  0.00290174 0.00314654 0.00331491
 0.00347229 0.0036104  0.00372899 0.00383409 0.00391347 0.00400758
 0.00408918 0.00416169 0.00423546 0.00429472 0.00434647 0.00439987
 0.00444445 0.00449659 0.00454625 0.00459165 0.00463607 0.00467851
 0.0047148  0.00475039 0.00478346 0.00481516 0.00484994 0.0048748 ]
record_num: 612736.0
=========== testing next new item epoch: 19 ===========
recall_all_avg_next_new: [0.0016055  0.00288166 0.00414868 0.00518241 0.00643113 0.007442
 0.00854892 0.0096467  0.01070331 0.01176449 0.01264271 0.01378623
 0.01485656 0.01586285 0.01696977 0.01793033 0.01882684 0.0197874
 0.02064732 0.02169021 0.02274224 0.02379885 0.02481887 0.02583431
 0.02674912 0.02768223 0.02859247 0.02946612 0.03048156 0.0312317 ]
MRR_all_avg_next_new: [0.0016055  0.00224358 0.00266592 0.00292435 0.00317409 0.00334257
 0.0035007  0.00363793 0.00375533 0.00386145 0.00394128 0.00403658
 0.00411891 0.00419079 0.00426458 0.00432462 0.00437735 0.00443072
 0.00447598 0.00452812 0.00457822 0.00462625 0.00467059 0.0047129
 0.0047495  0.00478539 0.0048191  0.0048503  0.00488532 0.00491032]
record_num_new: 218624.0
iteration 20 begin ...
all_loss 1685619.6643600464
iteration 21 begin ...
all_loss 1679271.871635437
iteration 22 begin ...
all_loss 1673738.6855316162
iteration 23 begin ...
all_loss 1668989.4283752441
iteration 24 begin ...
all_loss 1664784.7410736084
iteration 25 begin ...
all_loss 1661157.5896377563
iteration 26 begin ...
all_loss 1657899.7648162842
iteration 27 begin ...
all_loss 1655020.9062042236
iteration 28 begin ...
all_loss 1652458.4326705933
iteration 29 begin ...
all_loss 1650106.756439209
eval ...
~~~~~~~~~~~~~ testing next item epoch: 29 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00147045 0.00302577 0.00445053 0.0056876  0.0069002  0.00817155
 0.00941352 0.01059347 0.01178485 0.0128881  0.0139636  0.01505542
 0.01618805 0.01726518 0.0182036  0.01921872 0.02029259 0.02135667
 0.02238648 0.02355337 0.02443793 0.02535839 0.02626253 0.02719605
 0.02809693 0.02898965 0.02996723 0.03102315 0.03189955 0.03279063]
MRR_all_avg_next: [0.00147045 0.00224811 0.00272303 0.0030323  0.00327482 0.00348671
 0.00366414 0.00381163 0.003944   0.00405433 0.0041521  0.00424309
 0.00433021 0.00440715 0.00446971 0.00453316 0.00459633 0.00465544
 0.00470964 0.00476799 0.00481011 0.00485195 0.00489126 0.00493015
 0.00496619 0.00500053 0.00503673 0.00507444 0.00510466 0.00513437]
record_num: 612736.0
=========== testing next new item epoch: 29 ===========
recall_all_avg_next_new: [0.00150487 0.00305547 0.00447343 0.00570386 0.00695258 0.00822874
 0.00946831 0.01066214 0.01184682 0.01299034 0.01409726 0.01519504
 0.01630654 0.01736772 0.01831912 0.01935744 0.02043691 0.0214981
 0.02255471 0.02369365 0.02459016 0.02550498 0.02641064 0.0273529
 0.02825399 0.02915508 0.03015222 0.03120883 0.03208705 0.03298357]
MRR_all_avg_next_new: [0.00150487 0.00228017 0.00275282 0.00306043 0.00331017 0.00352287
 0.00369995 0.00384918 0.00398081 0.00409516 0.00419579 0.00428727
 0.00437277 0.00444857 0.004512   0.00457689 0.00464039 0.00469934
 0.00475496 0.0048119  0.00485459 0.00489618 0.00493555 0.00497481
 0.00501086 0.00504551 0.00508245 0.00512018 0.00515047 0.00518035]
record_num_new: 218624.0
iteration 30 begin ...
all_loss 1647991.905960083
iteration 31 begin ...
all_loss 1646115.9104232788
iteration 32 begin ...
all_loss 1644369.7574996948
iteration 33 begin ...
all_loss 1642798.8996124268
iteration 34 begin ...
all_loss 1641356.0319976807
iteration 35 begin ...
all_loss 1639974.0650177002
iteration 36 begin ...
all_loss 1638685.7200546265
iteration 37 begin ...
all_loss 1637570.5303268433
iteration 38 begin ...
all_loss 1636533.480331421
iteration 39 begin ...
all_loss 1635436.0589447021
eval ...
~~~~~~~~~~~~~ testing next item epoch: 39 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00147045 0.00290174 0.00430691 0.00579205 0.0070634  0.00834454
 0.00964853 0.01080726 0.01191541 0.01311495 0.01436834 0.01548954
 0.01650956 0.01772378 0.01882377 0.01995639 0.02089481 0.02195073
 0.0228614  0.02400871 0.0249308  0.025848   0.02686312 0.02787824
 0.02905819 0.03002109 0.0309595  0.03182447 0.03273677 0.03355605]
MRR_all_avg_next: [0.00147045 0.0021861  0.00265449 0.00302577 0.00328004 0.00349357
 0.00367985 0.00382469 0.00394782 0.00406777 0.00418172 0.00427515
 0.00435361 0.00444034 0.00451368 0.00458447 0.00463967 0.00469833
 0.00474626 0.00480362 0.00484753 0.00488922 0.00493336 0.00497566
 0.00502285 0.00505989 0.00509464 0.00512554 0.005157   0.0051843 ]
record_num: 612736.0
=========== testing next new item epoch: 39 ===========
recall_all_avg_next_new: [0.00150029 0.00293197 0.00434079 0.00582278 0.00711724 0.00838426
 0.00968787 0.0108634  0.01198862 0.01320532 0.01445404 0.01557926
 0.016613   0.01785257 0.01896864 0.0201213  0.02105899 0.02212932
 0.02302583 0.02416478 0.02509331 0.02602185 0.02703271 0.02804816
 0.02922369 0.03020711 0.03114022 0.03202759 0.0329607  0.03378403]
MRR_all_avg_next_new: [0.00150029 0.00221613 0.00268574 0.00305624 0.00331513 0.0035263
 0.00371253 0.00385947 0.00398449 0.00410616 0.00421968 0.00431345
 0.00439297 0.00448151 0.00455592 0.00462796 0.00468312 0.00474258
 0.00478976 0.00484671 0.00489093 0.00493313 0.00497708 0.00501939
 0.00506641 0.00510424 0.0051388  0.00517049 0.00520267 0.00523011]
record_num_new: 218624.0
iteration 40 begin ...
all_loss 1634523.2035598755
iteration 41 begin ...
all_loss 1633685.6267929077
iteration 42 begin ...
all_loss 1632836.5663833618
iteration 43 begin ...
all_loss 1632046.550491333
iteration 44 begin ...
all_loss 1631289.12525177
iteration 45 begin ...
all_loss 1630602.4738693237
iteration 46 begin ...
all_loss 1629898.6247558594
iteration 47 begin ...
all_loss 1629287.9117660522
iteration 48 begin ...
all_loss 1628709.8257293701
iteration 49 begin ...
all_loss 1628152.2458648682
eval ...
~~~~~~~~~~~~~ testing next item epoch: 49 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00138069 0.00289031 0.00432976 0.00571372 0.00702423 0.00842614
 0.00963384 0.01078768 0.01211941 0.01344625 0.01462783 0.01577351
 0.01692899 0.01797511 0.01906204 0.0201604  0.02119999 0.02225755
 0.02328246 0.0242225  0.02527842 0.02624948 0.02731845 0.02836295
 0.0294613  0.03048295 0.03144258 0.0324936  0.03336021 0.03428393]
MRR_all_avg_next: [0.00138069 0.0021355  0.00261532 0.00296131 0.00322341 0.00345706
 0.00362959 0.00377382 0.00392179 0.00405447 0.00416189 0.00425737
 0.00434625 0.00442097 0.00449343 0.00456208 0.00462323 0.00468199
 0.00473593 0.00478293 0.00483321 0.00487735 0.00492383 0.00496735
 0.00501128 0.00505058 0.00508612 0.00512366 0.00515354 0.00518433]
record_num: 612736.0
=========== testing next new item epoch: 49 ===========
recall_all_avg_next_new: [0.00141796 0.00293197 0.00435908 0.00574502 0.00708522 0.00847574
 0.00970616 0.01086797 0.01221732 0.01354838 0.01474221 0.01587657
 0.01704753 0.01809499 0.01920192 0.02031341 0.02133343 0.02240376
 0.02342835 0.02440263 0.02546381 0.02643351 0.02749469 0.02855588
 0.0296445  0.03069196 0.0316388  0.03268168 0.03355533 0.03448386]
MRR_all_avg_next_new: [0.00141796 0.00217497 0.00265067 0.00299715 0.0032652  0.00349695
 0.00367272 0.00381795 0.00396788 0.00410098 0.00420951 0.00430404
 0.00439412 0.00446893 0.00454273 0.0046122  0.0046722  0.00473166
 0.00478559 0.0048343  0.00488483 0.00492891 0.00497505 0.00501927
 0.00506281 0.0051031  0.00513817 0.00517541 0.00520554 0.00523649]
record_num_new: 218624.0
iteration 50 begin ...
all_loss 1627561.586845398
iteration 51 begin ...
all_loss 1627081.9888305664
iteration 52 begin ...
all_loss 1626534.4911117554
iteration 53 begin ...
all_loss 1626128.3485183716
iteration 54 begin ...
all_loss 1625610.3030319214
iteration 55 begin ...
all_loss 1625167.4887237549
iteration 56 begin ...
all_loss 1624764.9411392212
iteration 57 begin ...
all_loss 1624320.8016662598
iteration 58 begin ...
all_loss 1623953.7401809692
iteration 59 begin ...
all_loss 1623582.0456924438
eval ...
~~~~~~~~~~~~~ testing next item epoch: 59 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00147861 0.00295886 0.00443584 0.00590466 0.00719886 0.00841472
 0.00978399 0.0110129  0.01237401 0.01376286 0.01485305 0.01596283
 0.01702528 0.01816443 0.01922035 0.02042315 0.02144153 0.02262149
 0.0237329  0.02492591 0.025848   0.02686312 0.0278048  0.0288754
 0.03003741 0.03115697 0.03208723 0.03314804 0.03410604 0.03503793]
MRR_all_avg_next: [0.00147861 0.00221874 0.00271106 0.00307827 0.00333711 0.00353975
 0.00373536 0.00388898 0.00404021 0.0041791  0.0042782  0.00437069
 0.00445241 0.00453378 0.00460417 0.00467935 0.00473925 0.00480481
 0.0048633  0.00492295 0.00496686 0.005013   0.00505395 0.00509856
 0.00514504 0.0051881  0.00522255 0.00526044 0.00529347 0.00532453]
record_num: 612736.0
=========== testing next new item epoch: 59 ===========
recall_all_avg_next_new: [0.00150029 0.00297772 0.00448258 0.00594628 0.00724989 0.00847117
 0.00984338 0.01107381 0.01244603 0.01381825 0.01491602 0.01603209
 0.0170887  0.01822764 0.01930255 0.02053754 0.02158043 0.02277426
 0.02387204 0.02505672 0.02597611 0.02700984 0.02795667 0.02903158
 0.03022084 0.03133691 0.03226544 0.03332662 0.03430547 0.03524773]
MRR_all_avg_next_new: [0.00150029 0.002239   0.00274063 0.00310655 0.00336727 0.00357082
 0.00376685 0.00392065 0.00407312 0.00421034 0.00431014 0.00440315
 0.00448442 0.00456578 0.00463744 0.00471463 0.00477597 0.0048423
 0.00490007 0.00495931 0.00500309 0.00505008 0.00509124 0.00513603
 0.0051836  0.00522653 0.00526092 0.00529882 0.00533257 0.00536398]
record_num_new: 218624.0
iteration 60 begin ...
all_loss 1623234.9368896484
iteration 61 begin ...
all_loss 1622838.726272583
iteration 62 begin ...
all_loss 1622492.798500061
iteration 63 begin ...
all_loss 1622202.0093078613
iteration 64 begin ...
all_loss 1621835.0048980713
iteration 65 begin ...
all_loss 1621536.269958496
iteration 66 begin ...
all_loss 1621251.2460632324
iteration 67 begin ...
all_loss 1620946.6744308472
iteration 68 begin ...
all_loss 1620660.4303970337
iteration 69 begin ...
all_loss 1620443.424659729
eval ...
~~~~~~~~~~~~~ testing next item epoch: 69 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00148514 0.0031596  0.00454356 0.00584101 0.00716785 0.00859261
 0.00989823 0.01110266 0.01241318 0.01357681 0.01480409 0.01614888
 0.01720643 0.01838802 0.01951411 0.0204003  0.02159168 0.02263618
 0.02370678 0.02489163 0.02614176 0.0272238  0.02826013 0.02916591
 0.03023162 0.03124674 0.03229613 0.03338632 0.03453526 0.03541656]
MRR_all_avg_next: [0.00148514 0.00232237 0.00278369 0.00310805 0.00337342 0.00361088
 0.0037974  0.00394795 0.00409356 0.00420993 0.0043215  0.00443357
 0.00451492 0.00459931 0.00467439 0.00472977 0.00479986 0.00485788
 0.00491423 0.00497347 0.005033   0.00508219 0.00512724 0.00516498
 0.00520761 0.00524666 0.00528552 0.00532446 0.00536408 0.00539345]
record_num: 612736.0
=========== testing next new item epoch: 69 ===========
recall_all_avg_next_new: [0.00150029 0.00318355 0.00456034 0.0058731  0.00724532 0.00864955
 0.00995774 0.01118358 0.01247804 0.01362156 0.01487028 0.01623335
 0.01728996 0.01847464 0.01961358 0.0205101  0.02172223 0.02277883
 0.02384002 0.02499726 0.02622768 0.02733918 0.02839578 0.0293106
 0.03038093 0.03139637 0.0324667  0.0335599  0.03471257 0.03560908]
MRR_all_avg_next_new: [0.00150029 0.00234192 0.00280085 0.00312904 0.00340348 0.00363752
 0.00382441 0.00397764 0.00412147 0.00423582 0.00434934 0.00446293
 0.00454421 0.00462883 0.00470475 0.00476079 0.00483209 0.00489079
 0.00494664 0.0050045  0.00506309 0.00511362 0.00515956 0.00519767
 0.00524049 0.00527954 0.00531918 0.00535823 0.00539797 0.00542786]
record_num_new: 218624.0
iteration 70 begin ...
all_loss 1620109.7191619873
iteration 71 begin ...
all_loss 1619896.6338424683
iteration 72 begin ...
all_loss 1619623.3863983154
iteration 73 begin ...
all_loss 1619384.070465088
iteration 74 begin ...
all_loss 1619069.8342285156
iteration 75 begin ...
all_loss 1618904.9342269897
iteration 76 begin ...
all_loss 1618656.3091964722
iteration 77 begin ...
all_loss 1618393.237625122
iteration 78 begin ...
all_loss 1618264.3007507324
iteration 79 begin ...
all_loss 1618030.1332473755
eval ...
~~~~~~~~~~~~~ testing next item epoch: 79 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00154389 0.00308942 0.0045256  0.00593078 0.00714827 0.0084343
 0.00972523 0.0110488  0.01231525 0.01358987 0.01474371 0.016002
 0.01731251 0.01849573 0.01958755 0.02051454 0.02160474 0.02272757
 0.02381939 0.02492427 0.0260977  0.02713893 0.02814263 0.02932421
 0.03035728 0.03132671 0.03245117 0.0334924  0.03445856 0.0355308 ]
MRR_all_avg_next: [0.00154389 0.00231666 0.00279539 0.00314668 0.00339018 0.00360452
 0.00378893 0.00395438 0.0040951  0.00422256 0.00432745 0.00443231
 0.00453312 0.00461764 0.00469042 0.00474836 0.00481249 0.00487487
 0.00493233 0.00498758 0.00504346 0.00509078 0.00513442 0.00518366
 0.00522498 0.00526226 0.00530391 0.0053411  0.00537441 0.00541015]
record_num: 612736.0
=========== testing next new item epoch: 79 ===========
recall_all_avg_next_new: [0.00157348 0.00311951 0.00455577 0.0059783  0.0072133  0.00850318
 0.00978392 0.0111104  0.01236369 0.01363986 0.01479252 0.01607326
 0.01739516 0.01858442 0.01969134 0.02062445 0.02172223 0.02285202
 0.02393607 0.02506129 0.02620023 0.02725684 0.02826314 0.02946612
 0.030509   0.03146498 0.03259477 0.03364224 0.03463023 0.03570056]
MRR_all_avg_next_new: [0.00157348 0.00234649 0.00282525 0.00318088 0.00342788 0.00364286
 0.00382582 0.00399163 0.00413089 0.0042585  0.00436329 0.00447002
 0.0045717  0.00465665 0.00473045 0.00478877 0.00485334 0.00491611
 0.00497316 0.00502942 0.00508366 0.00513169 0.00517544 0.00522556
 0.00526728 0.00530405 0.00534589 0.0053833  0.00541737 0.00545305]
record_num_new: 218624.0
iteration 80 begin ...
all_loss 1617807.6947021484
iteration 81 begin ...
all_loss 1617595.2111968994
iteration 82 begin ...
all_loss 1617387.6002120972
iteration 83 begin ...
all_loss 1617209.5028076172
iteration 84 begin ...
all_loss 1617058.3759918213
iteration 85 begin ...
all_loss 1616865.7863311768
iteration 86 begin ...
all_loss 1616636.4785385132
iteration 87 begin ...
all_loss 1616452.538383484
iteration 88 begin ...
all_loss 1616349.954612732
iteration 89 begin ...
all_loss 1616145.9863967896
eval ...
~~~~~~~~~~~~~ testing next item epoch: 89 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00143945 0.00304536 0.00444074 0.0056974  0.00716622 0.00840329
 0.00982315 0.01124628 0.01252742 0.01370737 0.01494445 0.01609339
 0.01722602 0.01841576 0.01937866 0.02056024 0.02174346 0.02298543
 0.02406583 0.02498629 0.02602589 0.02718952 0.02808061 0.02905003
 0.03007821 0.03125    0.03222105 0.03321333 0.03433126 0.03546389]
MRR_all_avg_next: [0.00143945 0.0022424  0.00270753 0.00302169 0.00331546 0.00352164
 0.00372447 0.00390236 0.00404471 0.00416271 0.00427517 0.00437092
 0.00445804 0.00454302 0.00460721 0.00468106 0.00475066 0.00481966
 0.00487653 0.00492255 0.00497205 0.00502495 0.00506369 0.00510408
 0.00514521 0.00519028 0.00522624 0.00526168 0.00530023 0.00533799]
record_num: 612736.0
=========== testing next new item epoch: 89 ===========
recall_all_avg_next_new: [0.00147742 0.00307834 0.00447801 0.00572673 0.00722702 0.00848031
 0.0098937  0.01131166 0.01258782 0.01376793 0.0150075  0.01616017
 0.01728538 0.01848836 0.01948551 0.02067477 0.02184573 0.02312189
 0.02419222 0.02511161 0.02616822 0.02733003 0.0282174  0.02917795
 0.03019797 0.03138722 0.03234778 0.03336322 0.03447929 0.03560451]
MRR_all_avg_next_new: [0.00147742 0.00227788 0.00274444 0.00305662 0.00335668 0.00356556
 0.00376747 0.00394472 0.00408651 0.00420452 0.00431721 0.00441327
 0.00449982 0.00458575 0.00465222 0.00472655 0.00479543 0.00486633
 0.00492266 0.00496863 0.00501895 0.00507176 0.00511034 0.00515036
 0.00519116 0.0052369  0.00527248 0.00530875 0.00534723 0.00538474]
record_num_new: 218624.0
iteration 90 begin ...
all_loss 1616002.1492156982
iteration 91 begin ...
all_loss 1615829.2249450684
iteration 92 begin ...
all_loss 1615640.4812469482
iteration 93 begin ...
all_loss 1615537.7279968262
iteration 94 begin ...
all_loss 1615365.564704895
iteration 95 begin ...
all_loss 1615213.601135254
iteration 96 begin ...
all_loss 1615052.6115646362
iteration 97 begin ...
all_loss 1614947.0704345703
iteration 98 begin ...
all_loss 1614723.3867645264
iteration 99 begin ...
all_loss 1614676.373802185
eval ...
~~~~~~~~~~~~~ testing next item epoch: 99 ~~~~~~~~~~~~~
recall_all_avg_next: [0.00154389 0.00295233 0.00442605 0.00579369 0.00705198 0.00839024
 0.00970565 0.0110488  0.01239359 0.01377755 0.01485142 0.01612277
 0.01734515 0.01856428 0.0197018  0.02073976 0.02176468 0.02275695
 0.02374758 0.02500261 0.02620868 0.02720095 0.02818343 0.02920997
 0.03018755 0.03117493 0.03230429 0.0334108  0.03456464 0.03557976]
MRR_all_avg_next: [0.00154389 0.00224811 0.00273935 0.00308126 0.00333292 0.00355596
 0.00374388 0.00391177 0.00406119 0.00419959 0.00429721 0.00440316
 0.00449719 0.00458427 0.00466011 0.00472498 0.00478527 0.00484039
 0.00489253 0.00495528 0.00501271 0.00505782 0.00510053 0.00514331
 0.00518241 0.00522039 0.00526221 0.00530173 0.00534152 0.00537536]
record_num: 612736.0
=========== testing next new item epoch: 99 ===========
recall_all_avg_next_new: [0.00157348 0.00299144 0.00445971 0.00583193 0.00709895 0.00843457
 0.00976562 0.0111104  0.0124506  0.01384112 0.01490687 0.01616931
 0.01740431 0.01862101 0.0197874  0.02083486 0.0218503  0.02285202
 0.02386289 0.02512533 0.02634203 0.02731631 0.02830888 0.02934262
 0.03032604 0.03131404 0.03243011 0.03351416 0.03467597 0.03573258]
MRR_all_avg_next_new: [0.00157348 0.00228246 0.00277188 0.00311494 0.00336834 0.00359094
 0.00378109 0.00394919 0.0040981  0.00423715 0.00433404 0.00443924
 0.00453424 0.00462115 0.00469891 0.00476438 0.00482411 0.00487976
 0.00493296 0.00499609 0.00505402 0.00509831 0.00514146 0.00518454
 0.00522387 0.00526187 0.00530321 0.00534193 0.00538199 0.00541721]
record_num_new: 218624.0
------------- end top_n_item is: 10 -----------------
------------- end top_n_item is: 10 -----------------
