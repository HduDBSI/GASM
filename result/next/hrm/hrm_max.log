Namespace(cuda_device='3', data_size=1, drop_portion=1, hist_length=5, itera=100, output='display', valid_portion=8)
lastfm
============================================
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
init hrm ... 
init data_generation
------------------------------
Test records (next-new):107182
------------------------------
Test records (next-item):248402
building model ... 
running ... 
2022-07-08 11:03:06.589244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: GeForce RTX 2080 Ti
major: 7 minor: 5 memoryClockRate (GHz) 1.545
pciBusID 0000:3b:00.0
Total memory: 10.76GiB
Free memory: 8.36GiB
2022-07-08 11:03:06.873066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 1 with properties: 
name: GeForce RTX 2080 Ti
major: 7 minor: 5 memoryClockRate (GHz) 1.545
pciBusID 0000:b1:00.0
Total memory: 10.76GiB
Free memory: 10.45GiB
all_loss 1378011.379600525
eval ...
~~~~~~~~~~~~~ testing next item epoch: 0 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.0003542  0.00055947 0.00074865 0.00098612 0.00110687 0.00124372
 0.00147315 0.00165829 0.00188772 0.00204872 0.00225399 0.00242707
 0.00263234 0.00280542 0.00291409 0.00307107 0.00325219 0.00344539
 0.00354199 0.00376739 0.00390424 0.00402096 0.00408939 0.00423026
 0.00433491 0.00443554 0.00461666 0.00472533 0.00497086 0.00509966]
MRR_all_avg_next:
 [0.0003542  0.00045684 0.00051989 0.00057926 0.00060341 0.00062622
 0.000659   0.00068214 0.00070763 0.00072373 0.00074239 0.00075682
 0.00077261 0.00078497 0.00079221 0.00080202 0.00081268 0.00082341
 0.0008285  0.00083977 0.00084628 0.00085159 0.00085456 0.00086043
 0.00086462 0.00086849 0.0008752  0.00087908 0.00088754 0.00089184]
record_num:
 248448.0
=========== testing next new item epoch: 0 ===========
recall_all_avg_next_new:
 [0.00037291 0.00057801 0.00076447 0.00099754 0.00111874 0.00123993
 0.001473   0.00165946 0.0018832  0.00205101 0.00226544 0.00244257
 0.00264767 0.00280616 0.00291803 0.00304855 0.00321636 0.00340282
 0.00349605 0.00371979 0.00385031 0.00396219 0.00403677 0.00417661
 0.00427916 0.00438171 0.00454952 0.00464275 0.00487582 0.00499702]
MRR_all_avg_next_new:
 [0.00037291 0.00047546 0.00053761 0.00059588 0.00062012 0.00064032
 0.00067362 0.00069692 0.00072178 0.00073856 0.00075806 0.00077282
 0.0007886  0.00079992 0.00080737 0.00081553 0.0008254  0.00083576
 0.00084067 0.00085186 0.00085807 0.00086316 0.0008664  0.00087223
 0.00087633 0.00088027 0.00088649 0.00088982 0.00089785 0.00090189]
record_num_new:
 107264.0
all_loss 1274917.0037231445
all_loss 1189371.0712127686
all_loss 1121926.1135406494
all_loss 1053639.1605987549
all_loss 980748.6191253662
all_loss 906004.1462631226
all_loss 835815.3353881836
all_loss 774868.4962692261
all_loss 724271.2491073608
eval ...
~~~~~~~~~~~~~ testing next item epoch: 9 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00078085 0.00147315 0.00252769 0.00330854 0.00403304 0.00483803
 0.00566316 0.0064601  0.00726108 0.00804997 0.00862957 0.00933797
 0.01000209 0.01072659 0.01157184 0.01225609 0.01281556 0.01349176
 0.0140955  0.01468315 0.01524665 0.01566525 0.01619252 0.01669967
 0.01723097 0.01789107 0.01840224 0.01890134 0.01933201 0.01974256]
MRR_all_avg_next:
 [0.00078085 0.001127   0.00147851 0.00167372 0.00181862 0.00195279
 0.00207066 0.00217028 0.00225928 0.00233817 0.00239086 0.00244989
 0.00250098 0.00255273 0.00260908 0.00265184 0.00268475 0.00272232
 0.0027541  0.00278348 0.00281031 0.00282934 0.00285227 0.0028734
 0.00289465 0.00292004 0.00293897 0.00295679 0.00297165 0.00298533]
record_num:
 248448.0
=========== testing next new item epoch: 9 ===========
recall_all_avg_next_new:
 [0.00081108 0.00149165 0.00249851 0.00326298 0.00399948 0.00478259
 0.005603   0.00640476 0.00718787 0.00797099 0.00852103 0.00923889
 0.00990081 0.01064663 0.01148568 0.01217557 0.01274426 0.01342482
 0.01407742 0.01467408 0.01522412 0.01565297 0.01618437 0.0166878
 0.01723784 0.01790908 0.01844048 0.01894391 0.01938209 0.01981093]
MRR_all_avg_next_new:
 [0.00081108 0.00115136 0.00148699 0.0016781  0.0018254  0.00195592
 0.00207312 0.00217334 0.00226036 0.00233867 0.00238867 0.00244849
 0.00249941 0.00255268 0.00260862 0.00265174 0.00268519 0.002723
 0.00275735 0.00278718 0.00281337 0.00283286 0.00285597 0.00287694
 0.00289895 0.00292476 0.00294444 0.00296242 0.00297753 0.00299183]
record_num_new:
 107264.0
all_loss 683361.3530197144
all_loss 650256.6940917969
all_loss 623465.6720123291
all_loss 601647.8551483154
all_loss 583750.920967102
all_loss 568935.730091095
all_loss 556523.7714538574
all_loss 546095.4659347534
all_loss 537275.7971725464
all_loss 529678.3907051086
eval ...
~~~~~~~~~~~~~ testing next item epoch: 19 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00067217 0.00134837 0.00225399 0.00307912 0.00390021 0.00482193
 0.00574366 0.00672978 0.0076837  0.008376   0.00928162 0.01005039
 0.01074672 0.01145511 0.01221584 0.01292021 0.01360043 0.01433298
 0.0150293  0.01550828 0.01628912 0.0169291  0.01758517 0.01832577
 0.01928774 0.01976269 0.02058781 0.02134853 0.02178323 0.02237893]
MRR_all_avg_next:
 [0.00067217 0.00101027 0.00131215 0.00151843 0.00168265 0.00183627
 0.00196794 0.00209121 0.0021972  0.00226643 0.00234876 0.00241282
 0.00246638 0.00251698 0.0025677  0.00261172 0.00265174 0.00269243
 0.00272908 0.00275303 0.00279021 0.0028193  0.00284783 0.00287869
 0.00291716 0.00293543 0.00296599 0.00299316 0.00300815 0.00302801]
record_num:
 248448.0
=========== testing next new item epoch: 19 ===========
recall_all_avg_next_new:
 [0.00069921 0.00137045 0.00228408 0.00310449 0.0039249  0.00482921
 0.00576149 0.00679632 0.00772859 0.00841848 0.00931347 0.01007794
 0.01074918 0.01145771 0.01225015 0.012968   0.01364857 0.0143571
 0.01507496 0.01555042 0.01630556 0.01696748 0.01759211 0.01832861
 0.01929818 0.01980161 0.02065931 0.02144242 0.02188992 0.02244928]
MRR_all_avg_next_new:
 [0.00069921 0.00103483 0.00133937 0.00154448 0.00170856 0.00185928
 0.00199246 0.00212181 0.0022254  0.00229439 0.00237575 0.00243946
 0.00249109 0.0025417  0.00259453 0.00263939 0.00267943 0.00271879
 0.00275657 0.00278035 0.0028163  0.00284639 0.00287355 0.00290424
 0.00294302 0.00296238 0.00299415 0.00302212 0.00303755 0.00305619]
record_num_new:
 107264.0
all_loss 523190.69312286377
all_loss 517538.46925735474
all_loss 512597.8716621399
all_loss 508304.2901611328
all_loss 504424.52753067017
all_loss 501055.6952896118
all_loss 498016.30966567993
all_loss 495311.996383667
all_loss 492873.33891677856
all_loss 490592.64406967163
eval ...
~~~~~~~~~~~~~ testing next item epoch: 29 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.0007728  0.0015617  0.00249952 0.00350979 0.00449591 0.00541763
 0.00655268 0.00757905 0.0084082  0.00939834 0.01039654 0.01126594
 0.01227621 0.01308121 0.01396268 0.01475158 0.01558475 0.01658697
 0.01735574 0.01808024 0.01894964 0.01988746 0.02085748 0.02178726
 0.02267678 0.02336103 0.0240654  0.02498712 0.02574382 0.02653272]
MRR_all_avg_next:
 [0.0007728  0.00116725 0.00147985 0.00173242 0.00192965 0.00208327
 0.00224542 0.00237371 0.00246584 0.00256485 0.0026556  0.00272805
 0.00280576 0.00286326 0.00292203 0.00297133 0.00302034 0.00307602
 0.00311648 0.00315271 0.00319411 0.00323674 0.00327891 0.00331765
 0.00335323 0.00337955 0.00340564 0.00343856 0.00346465 0.00349095]
record_num:
 248448.0
=========== testing next new item epoch: 29 ===========
recall_all_avg_next_new:
 [0.00079244 0.00157555 0.00255445 0.00357995 0.00456817 0.00550977
 0.00663783 0.00764469 0.00849306 0.0094906  0.01051611 0.01135516
 0.01236202 0.01317311 0.01404013 0.01484189 0.01565297 0.0166878
 0.01745227 0.01817945 0.01906511 0.02005333 0.02100425 0.02195518
 0.02284084 0.02351208 0.02422994 0.02515289 0.02592669 0.02671912]
MRR_all_avg_next_new:
 [0.00079244 0.00118399 0.00151029 0.00176667 0.00196431 0.00212125
 0.0022824  0.00240825 0.00250252 0.00260227 0.0026955  0.00276542
 0.00284287 0.00290081 0.00295861 0.00300872 0.00305643 0.00311392
 0.00315415 0.00319051 0.00323269 0.00327761 0.00331895 0.00335857
 0.003394   0.00341982 0.0034464  0.00347937 0.00350605 0.00353246]
record_num_new:
 107264.0
all_loss 488600.72663879395
all_loss 486742.2391357422
all_loss 485069.8033103943
all_loss 483486.18452453613
all_loss 482068.7876777649
all_loss 480719.293132782
all_loss 479496.7470359802
all_loss 478337.6668243408
all_loss 477247.8904876709
all_loss 476262.3630409241
eval ...
~~~~~~~~~~~~~ testing next item epoch: 39 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.0008372  0.00164219 0.00260819 0.00370701 0.00490243 0.00602541
 0.0071202  0.0082633  0.0093581  0.01046497 0.01174491 0.01282361
 0.01366081 0.0145463  0.01558475 0.0163978  0.01723499 0.01813257
 0.01900599 0.02006859 0.02102653 0.0219563  0.0227935  0.02383597
 0.0246611  0.02549829 0.02637172 0.02730954 0.02815881 0.02878671]
MRR_all_avg_next:
 [0.0008372  0.0012397  0.0015617  0.0018364  0.00207548 0.00226265
 0.00241905 0.00256193 0.00268358 0.00279426 0.00291062 0.00300051
 0.00306491 0.00312816 0.00319739 0.00324821 0.00329746 0.00334732
 0.00339329 0.00344642 0.00349204 0.0035343  0.0035707  0.00361414
 0.00364714 0.00367934 0.00371169 0.00374518 0.00377447 0.0037954 ]
record_num:
 248448.0
=========== testing next new item epoch: 39 ===========
recall_all_avg_next_new:
 [0.00087634 0.00165946 0.00263835 0.00379438 0.00497837 0.00609711
 0.00717855 0.00830661 0.00943467 0.01053476 0.0118213  0.01289342
 0.01376044 0.0146834  0.01572755 0.01655728 0.01739633 0.01830064
 0.01915834 0.02020249 0.02115342 0.0220857  0.02297136 0.02398754
 0.02483592 0.02565632 0.02656996 0.02751156 0.02836926 0.02899388]
MRR_all_avg_next_new:
 [0.00087634 0.0012679  0.0015942  0.0018832  0.00212    0.00230646
 0.00246095 0.00260196 0.0027273  0.00283731 0.00295427 0.00304361
 0.0031103  0.00317623 0.00324584 0.0032977  0.00334705 0.00339729
 0.00344243 0.00349464 0.00353992 0.0035823  0.00362081 0.00366315
 0.00369708 0.00372864 0.00376248 0.0037961  0.00382568 0.0038465 ]
record_num_new:
 107264.0
all_loss 475259.1849899292
all_loss 474408.726146698
all_loss 473540.92095565796
all_loss 472756.35959243774
all_loss 471995.44345474243
all_loss 471253.84189224243
all_loss 470592.6025390625
all_loss 469935.13204193115
all_loss 469295.93771362305
all_loss 468729.97200012207
eval ...
~~~~~~~~~~~~~ testing next item epoch: 49 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00080097 0.00177099 0.00286982 0.00398474 0.00522846 0.00669758
 0.0078447  0.0087624  0.01005039 0.01124984 0.01245331 0.01349578
 0.0144497  0.01533923 0.01629315 0.01734769 0.01840627 0.01940044
 0.02035033 0.02136866 0.0221817  0.0231799  0.0241459  0.02505554
 0.02595312 0.02687886 0.02782474 0.02897588 0.029962   0.0307026 ]
MRR_all_avg_next:
 [0.00080097 0.00128598 0.00165226 0.00193099 0.00217973 0.00242459
 0.00258846 0.00270317 0.00284628 0.00296623 0.00307563 0.00316251
 0.00323588 0.00329942 0.00336302 0.00342893 0.00349119 0.00354643
 0.00359642 0.00364734 0.00368605 0.00373143 0.00377343 0.00381133
 0.00384723 0.00388284 0.00391787 0.00395898 0.00399299 0.00401767]
record_num:
 248448.0
=========== testing next new item epoch: 49 ===========
recall_all_avg_next_new:
 [0.00082973 0.00178998 0.00291803 0.00409271 0.00534196 0.00680564
 0.00794302 0.00885665 0.01015252 0.01136448 0.01256712 0.01363925
 0.0145622  0.01546651 0.01642676 0.01749888 0.01856168 0.01955922
 0.02055676 0.02159159 0.02238402 0.02340021 0.02440707 0.02533003
 0.02622501 0.02716662 0.02815483 0.02930154 0.03027111 0.03103558]
MRR_all_avg_next_new:
 [0.00082973 0.00130985 0.00168587 0.00197954 0.00222939 0.00247334
 0.00263582 0.00275002 0.00289401 0.00301521 0.00312454 0.00321388
 0.00328488 0.00334947 0.00341349 0.00348049 0.00354301 0.00359843
 0.00365093 0.00370267 0.00374041 0.0037866  0.00383038 0.00386883
 0.00390463 0.00394085 0.00397745 0.0040184  0.00405184 0.00407732]
record_num_new:
 107264.0
all_loss 468130.5241088867
all_loss 467574.5951805115
all_loss 467084.866519928
all_loss 466570.61935424805
all_loss 466070.55170059204
all_loss 465605.9987335205
all_loss 465180.1650085449
all_loss 464760.90350723267
all_loss 464271.4918022156
all_loss 463901.963848114
eval ...
~~~~~~~~~~~~~ testing next item epoch: 59 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00083317 0.00179514 0.00298654 0.00431479 0.00563096 0.00679418
 0.00784872 0.0091488  0.01034422 0.01150744 0.01274311 0.01388218
 0.0148683  0.01587857 0.0169291  0.01802792 0.01919516 0.02052341
 0.02157393 0.02241918 0.02328858 0.0240654  0.02525679 0.02621877
 0.02742626 0.02836006 0.02929788 0.03021558 0.03116145 0.03214757]
MRR_all_avg_next:
 [0.00083317 0.00131416 0.00171129 0.00204335 0.00230659 0.00250046
 0.00265111 0.00281361 0.00294644 0.00306276 0.00317509 0.00327002
 0.00334587 0.00341804 0.00348807 0.00355675 0.00362541 0.0036992
 0.00375449 0.00379675 0.00383815 0.00387346 0.00392526 0.00396534
 0.00401364 0.00404956 0.00408429 0.00411707 0.00414968 0.00418256]
record_num:
 248448.0
=========== testing next new item epoch: 59 ===========
recall_all_avg_next_new:
 [0.0008577  0.0017993  0.00302058 0.00438171 0.00567758 0.00684293
 0.00790573 0.00922956 0.01047882 0.01166281 0.01291207 0.01406809
 0.01505631 0.01606317 0.01711665 0.01823538 0.01941938 0.02077118
 0.02178737 0.02265439 0.02353073 0.02432317 0.02549784 0.02648605
 0.02767005 0.02863962 0.02959987 0.03053214 0.03150172 0.03248993]
MRR_all_avg_next_new:
 [0.0008577  0.0013285  0.00173559 0.00207588 0.00233505 0.00252927
 0.0026811  0.00284658 0.00298539 0.00310379 0.00321736 0.00331369
 0.00338971 0.00346163 0.00353186 0.00360178 0.00367143 0.00374653
 0.00380001 0.00384336 0.00388509 0.00392111 0.00397218 0.00401336
 0.00406072 0.00409801 0.00413357 0.00416687 0.0042003  0.00423324]
record_num_new:
 107264.0
all_loss 463489.6811141968
all_loss 463129.9545288086
all_loss 462778.63489151
all_loss 462348.82610321045
all_loss 462070.26958465576
all_loss 461677.2512550354
all_loss 461382.6417198181
all_loss 461050.9159851074
all_loss 460728.47941970825
all_loss 460449.73612213135
eval ...
~~~~~~~~~~~~~ testing next item epoch: 69 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00084122 0.00173074 0.00296642 0.00431479 0.00550216 0.00682235
 0.00796545 0.0092454  0.01039252 0.01193811 0.01299266 0.01420015
 0.0153835  0.01653465 0.01766164 0.01872022 0.01986331 0.02089773
 0.0219241  0.02293035 0.0239366  0.02502334 0.02615034 0.02741016
 0.02842848 0.02936631 0.03030815 0.0311212  0.03205902 0.03288817]
MRR_all_avg_next:
 [0.00084122 0.00128598 0.00169787 0.00203497 0.00227244 0.00249247
 0.00265577 0.00281577 0.00294322 0.00309778 0.00319365 0.00329428
 0.0033853  0.00346753 0.00354266 0.00360882 0.00367606 0.00373353
 0.00378755 0.00383786 0.00388578 0.00393518 0.00398418 0.00403667
 0.0040774  0.00411347 0.00414835 0.00417739 0.00420973 0.00423737]
record_num:
 248448.0
=========== testing next new item epoch: 69 ===========
recall_all_avg_next_new:
 [0.0008577  0.00175268 0.00302058 0.00440036 0.00556571 0.00689887
 0.0080176  0.00934144 0.0105534  0.0121476  0.01320107 0.01443168
 0.01561568 0.01678103 0.01790908 0.01895324 0.02008129 0.02113477
 0.02217892 0.02316714 0.02419265 0.02528341 0.02639283 0.02767937
 0.02869555 0.02967445 0.03065334 0.03147375 0.03241535 0.03320779]
MRR_all_avg_next_new:
 [0.0008577  0.00130519 0.00172782 0.00207277 0.00230584 0.00252803
 0.00268785 0.00285333 0.00298799 0.00314741 0.00324318 0.00334573
 0.00343681 0.00352005 0.00359525 0.00366051 0.00372687 0.00378539
 0.00384035 0.00388976 0.00393859 0.00398817 0.00403641 0.00409002
 0.00413066 0.00416831 0.00420457 0.00423387 0.00426634 0.00429275]
record_num_new:
 107264.0
all_loss 460130.08434677124
all_loss 459820.5841140747
all_loss 459594.4764328003
all_loss 459284.1916770935
all_loss 459022.22898864746
all_loss 458779.1028213501
all_loss 458493.75926208496
all_loss 458282.79427337646
all_loss 457985.7034187317
all_loss 457764.10188293457
eval ...
~~~~~~~~~~~~~ testing next item epoch: 79 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00088147 0.00195212 0.00318376 0.00425039 0.00565108 0.00687065
 0.0080862  0.00925345 0.01073062 0.01196226 0.01331466 0.01446178
 0.01561293 0.016913   0.01792327 0.01897379 0.02025374 0.02132036
 0.02235478 0.02332078 0.0247416  0.02579614 0.02673799 0.02779656
 0.02876256 0.02974465 0.0307348  0.03183765 0.03281974 0.03375757]
MRR_all_avg_next:
 [0.00088147 0.0014168  0.00182734 0.002094   0.00237414 0.0025774
 0.00275105 0.00289696 0.00306109 0.00318425 0.0033072  0.00340279
 0.00349134 0.0035842  0.00365155 0.00371721 0.0037925  0.00385176
 0.0039062  0.0039545  0.00402216 0.00407009 0.00411104 0.00415515
 0.00419379 0.00423156 0.00426823 0.00430762 0.00434149 0.00437275]
record_num:
 248448.0
=========== testing next new item epoch: 79 ===========
recall_all_avg_next_new:
 [0.00089499 0.00199508 0.00325365 0.00430713 0.00573352 0.00696413
 0.00818541 0.00933212 0.01087038 0.01213828 0.01351805 0.01473001
 0.01584875 0.01717258 0.01819809 0.01926089 0.02051947 0.02160091
 0.02258913 0.02359599 0.02502237 0.02608517 0.02702678 0.02808025
 0.02905914 0.03004736 0.03105422 0.03215431 0.03316117 0.03412142]
MRR_all_avg_next_new:
 [0.00089499 0.00144503 0.00186456 0.00212793 0.0024132  0.00261831
 0.00279278 0.00293611 0.00310703 0.00323382 0.00335926 0.00346025
 0.00354631 0.00364087 0.00370924 0.00377566 0.00384969 0.00390977
 0.00396179 0.00401213 0.00408005 0.00412836 0.0041693  0.0042132
 0.00425235 0.00429036 0.00432765 0.00436694 0.00440166 0.00443367]
record_num_new:
 107264.0
all_loss 457558.8090438843
all_loss 457306.0836868286
all_loss 457063.785030365
all_loss 456878.93814849854
all_loss 456615.3157196045
all_loss 456419.0311203003
all_loss 456207.32552337646
all_loss 456003.7800292969
all_loss 455816.477432251
all_loss 455597.20693969727
eval ...
~~~~~~~~~~~~~ testing next item epoch: 89 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00089355 0.00201249 0.00313144 0.00428259 0.00559473 0.00682638
 0.00813852 0.00959959 0.01104859 0.01217559 0.01343943 0.01482
 0.01597517 0.01721487 0.01820099 0.01956546 0.02068843 0.02184361
 0.0228257  0.02394465 0.02507567 0.02620669 0.02724514 0.02837213
 0.02926166 0.03032023 0.03138685 0.03243737 0.03327457 0.03410774]
MRR_all_avg_next:
 [0.00089355 0.00145302 0.001826   0.00211379 0.00237622 0.00258149
 0.00276894 0.00295158 0.00311258 0.00322527 0.00334017 0.00345522
 0.00354408 0.00363263 0.00369837 0.00378365 0.0038497  0.00391388
 0.00396557 0.00402152 0.00407538 0.00412679 0.00417194 0.00421889
 0.00425447 0.00429519 0.00433469 0.00437221 0.00440108 0.00442885]
record_num:
 248448.0
=========== testing next new item epoch: 89 ===========
recall_all_avg_next_new:
 [0.00093228 0.00205101 0.00317907 0.00435374 0.00566826 0.00689887
 0.0082227  0.00972367 0.01121532 0.0123527  0.0136206  0.01508428
 0.01622166 0.01751753 0.0184871  0.0198389  0.02097628 0.02214163
 0.02313917 0.02424858 0.02537664 0.02651402 0.0275675  0.0287142
 0.02962783 0.03064402 0.03174411 0.03278826 0.03362731 0.03447569]
MRR_all_avg_next_new:
 [0.00093228 0.00149165 0.00186767 0.00216133 0.00242424 0.00262934
 0.00281846 0.00300608 0.00317182 0.00328556 0.00340082 0.00352279
 0.00361028 0.00370285 0.00376748 0.00385197 0.00391888 0.00398362
 0.00403612 0.00409159 0.00414531 0.00419701 0.00424281 0.00429059
 0.00432713 0.00436622 0.00440696 0.00444425 0.00447319 0.00450147]
record_num_new:
 107264.0
all_loss 455442.54289245605
all_loss 455215.9712982178
all_loss 455005.94985198975
all_loss 454873.32107925415
all_loss 454663.2851371765
all_loss 454507.77116012573
all_loss 454291.8701171875
all_loss 454171.85552215576
all_loss 453977.24950027466
all_loss 453805.3162498474
eval ...
~~~~~~~~~~~~~ testing next item epoch: 99 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00085732 0.00204872 0.00328439 0.00443151 0.00578391 0.00692298
 0.0080218  0.00959557 0.01104054 0.01250966 0.01372521 0.01488843
 0.01614825 0.01723902 0.01849079 0.01964596 0.02071661 0.02185971
 0.02291425 0.02398892 0.02542182 0.02637172 0.02740211 0.02864583
 0.0296883  0.03060198 0.0316525  0.03264265 0.03353217 0.03447804]
MRR_all_avg_next:
 [0.00085732 0.00145302 0.00186491 0.00215169 0.00242217 0.00261202
 0.00276899 0.00296571 0.00312626 0.00327318 0.00338368 0.00348061
 0.00357752 0.00365544 0.00373889 0.00381109 0.00387407 0.00393757
 0.00399307 0.00404681 0.00411504 0.00415822 0.00420302 0.00425484
 0.00429654 0.00433168 0.00437059 0.00440595 0.00443662 0.00446815]
record_num:
 248448.0
=========== testing next new item epoch: 99 ===========
recall_all_avg_next_new:
 [0.00088567 0.00209763 0.00336553 0.00451223 0.00587336 0.00700142
 0.00812015 0.00972367 0.01123396 0.01271629 0.01395622 0.01514954
 0.01640811 0.0175082  0.01873881 0.01990416 0.02099493 0.02216028
 0.02319511 0.02423926 0.02565632 0.02661657 0.02764208 0.02890066
 0.02996345 0.03090506 0.03195853 0.03293743 0.03383241 0.03477402]
MRR_all_avg_next_new:
 [0.00088567 0.00149165 0.00191428 0.00220096 0.00247318 0.00266119
 0.00282101 0.00302145 0.00318926 0.00333749 0.00345021 0.00354966
 0.00364647 0.00372505 0.00380709 0.00387992 0.00394409 0.00400883
 0.00406329 0.0041155  0.00418298 0.00422663 0.00427121 0.00432366
 0.00436617 0.00440238 0.0044414  0.00447636 0.00450722 0.00453861]
record_num_new:
 107264.0
------------- end top_n_item is: 50 -----------------
------------- end top_n_item is: 50 -----------------

Namespace(data_size=1, drop_portion=1, hist_length=5, itera=100, output='display', valid_portion=8)
30Music
============================================
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
+++++++++++++ start top_n_item is: 50 ++++++++++++++++
init hrm ... 
init data_generation
------------------------------
Test records (next-new):337035
------------------------------
Test records (next-item):616081
building model ... 
running ... 
2022-07-08 15:09:35.901732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: GeForce RTX 2080 Ti
major: 7 minor: 5 memoryClockRate (GHz) 1.545
pciBusID 0000:5e:00.0
Total memory: 10.76GiB
Free memory: 10.60GiB
2022-07-08 15:09:36.168466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 1 with properties: 
name: GeForce RTX 2080 Ti
major: 7 minor: 5 memoryClockRate (GHz) 1.545
pciBusID 0000:b1:00.0
Total memory: 10.76GiB
Free memory: 8.75GiB
all_loss 3301239.171775818
eval ...
~~~~~~~~~~~~~ testing next item epoch: 0 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00031159 0.00055827 0.00084389 0.00121715 0.00147357 0.00165208
 0.00187928 0.00202697 0.00216653 0.0022704  0.0024554  0.00261607
 0.00279783 0.00296823 0.00312403 0.003335   0.00358492 0.00382998
 0.00401011 0.00414319 0.00431034 0.00458786 0.00476475 0.00495625
 0.00509581 0.00528407 0.00545771 0.00559566 0.00574659 0.00588615]
MRR_all_avg_next:
 [0.00031159 0.00043493 0.00053014 0.00062345 0.00067474 0.00070449
 0.00073695 0.00075541 0.00077091 0.0007813  0.00079812 0.00081151
 0.00082549 0.00083766 0.00084805 0.00086123 0.00087593 0.00088955
 0.00089903 0.00090568 0.00091364 0.00092626 0.00093395 0.00094193
 0.00094751 0.00095475 0.00096118 0.00096611 0.00097131 0.00097596]
record_num:
 616192.0
=========== testing next new item epoch: 0 ===========
recall_all_avg_next_new:
 [0.0003055  0.00055761 0.00084532 0.00122497 0.00147411 0.00166097
 0.00189825 0.00204655 0.00218596 0.00229273 0.0024707  0.00263383
 0.00282069 0.00299272 0.00314991 0.0033694  0.00361855 0.00387956
 0.00405752 0.00419692 0.00437192 0.00465369 0.00482868 0.00501258
 0.00514605 0.00532401 0.00549604 0.00564434 0.00580154 0.00593501]
MRR_all_avg_next_new:
 [0.0003055  0.00043156 0.00052746 0.00062237 0.0006722  0.00070334
 0.00073724 0.00075578 0.00077127 0.00078194 0.00079812 0.00081172
 0.00082609 0.00083838 0.00084886 0.00086258 0.00087723 0.00089173
 0.0009011  0.00090807 0.0009164  0.00092921 0.00093682 0.00094448
 0.00094982 0.00095666 0.00096304 0.00096833 0.00097375 0.0009782 ]
record_num_new:
 337152.0
all_loss 2989073.2509155273
all_loss 2823791.2304153442
all_loss 2659182.601425171
all_loss 2472418.659538269
all_loss 2285687.134033203
all_loss 2118884.3840789795
all_loss 1978230.4904174805
all_loss 1862401.232498169
all_loss 1768893.3692855835
eval ...
~~~~~~~~~~~~~ testing next item epoch: 9 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00209999 0.00446939 0.00671869 0.00883653 0.0106152  0.01240036
 0.01394046 0.01569478 0.0170158  0.0183287  0.01965459 0.02103241
 0.02223658 0.02346022 0.02465303 0.02585233 0.02707273 0.02819738
 0.02929769 0.03037365 0.03156159 0.03269273 0.03385471 0.03496151
 0.0360115  0.03707124 0.03819751 0.03915014 0.04008491 0.04109758]
MRR_all_avg_next:
 [0.00209999 0.00328469 0.00403446 0.00456392 0.00491965 0.00521718
 0.00543719 0.00565648 0.00580326 0.00593455 0.00605509 0.00616991
 0.00626253 0.00634994 0.00642946 0.00650442 0.0065762  0.00663868
 0.00669659 0.00675039 0.00680696 0.00685838 0.0069089  0.00695501
 0.00699701 0.00703777 0.00707949 0.00711351 0.00714574 0.0071795 ]
record_num:
 616192.0
=========== testing next new item epoch: 9 ===========
recall_all_avg_next_new:
 [0.00207621 0.0044342  0.00666168 0.00876756 0.01052641 0.01227636
 0.01379793 0.01555085 0.0168559  0.01814315 0.0194482  0.0208185
 0.02202864 0.02324471 0.02443705 0.02562346 0.02683359 0.02795772
 0.02904328 0.03009029 0.03126483 0.03239192 0.0335546  0.0346372
 0.0356842  0.03673121 0.03784347 0.03880742 0.03975358 0.04077093]
MRR_all_avg_next_new:
 [0.00207621 0.00325521 0.0039977  0.00452417 0.00487594 0.0051676
 0.00538497 0.00560408 0.00574909 0.00587781 0.00599645 0.00611065
 0.00620373 0.00629059 0.00637008 0.00644423 0.00651542 0.00657787
 0.00663501 0.00668736 0.00674329 0.00679452 0.00684507 0.00689018
 0.00693206 0.00697233 0.00701352 0.00704795 0.00708057 0.00711449]
record_num_new:
 337152.0
all_loss 1694194.225616455
all_loss 1634757.9155731201
all_loss 1587314.310798645
all_loss 1549146.681503296
all_loss 1518258.7473258972
all_loss 1492947.045906067
all_loss 1471930.988067627
all_loss 1454451.981666565
all_loss 1439575.5470428467
all_loss 1426924.6415672302
eval ...
~~~~~~~~~~~~~ testing next item epoch: 19 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00166182 0.00385594 0.00615717 0.00802023 0.00986705 0.01164734
 0.01332377 0.01489146 0.01637963 0.01814045 0.01973735 0.02114276
 0.02253843 0.02390813 0.02528595 0.02655341 0.02792798 0.02932365
 0.03068037 0.03206468 0.0334636  0.03477812 0.03616568 0.0374445
 0.03876551 0.03989503 0.04107161 0.04227578 0.04342315 0.04457701]
MRR_all_avg_next:
 [0.00166182 0.00275888 0.00352596 0.00399172 0.00436109 0.0046578
 0.00489729 0.00509325 0.0052586  0.00543469 0.00557986 0.00569698
 0.00580434 0.00590217 0.00599403 0.00607324 0.0061541  0.00623164
 0.00630304 0.00637226 0.00643887 0.00649862 0.00655895 0.00661224
 0.00666508 0.00670852 0.0067521  0.0067951  0.00683467 0.00687313]
record_num:
 616192.0
=========== testing next new item epoch: 19 ===========
recall_all_avg_next_new:
 [0.00163428 0.0038143  0.00610704 0.0079608  0.0098205  0.01159121
 0.01326405 0.01483307 0.01628642 0.01800375 0.01956981 0.02098757
 0.02234897 0.02369554 0.02504212 0.02629081 0.02764035 0.02901362
 0.03036019 0.0317305  0.03310376 0.03441474 0.03581471 0.03709306
 0.03841294 0.03954893 0.04072051 0.04191878 0.04307256 0.04422931]
MRR_all_avg_next_new:
 [0.00163428 0.00272429 0.00348854 0.00395198 0.00432392 0.00461903
 0.00485801 0.00505414 0.00521562 0.00538736 0.00552972 0.00564787
 0.00575259 0.00584878 0.00593855 0.00601659 0.00609598 0.00617227
 0.00624314 0.00631166 0.00637705 0.00643664 0.00649751 0.00655077
 0.00660357 0.00664726 0.00669065 0.00673345 0.00677323 0.00681179]
record_num_new:
 337152.0
all_loss 1415996.6837043762
all_loss 1406460.0232429504
all_loss 1398252.2559242249
all_loss 1390916.2339515686
all_loss 1384424.2026443481
all_loss 1378622.772857666
all_loss 1373459.1711540222
all_loss 1368725.2657470703
all_loss 1364432.9578094482
all_loss 1360513.2634124756
eval ...
~~~~~~~~~~~~~ testing next item epoch: 29 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00166507 0.00395169 0.00615555 0.00824094 0.01017378 0.01201898
 0.01394046 0.01557631 0.01727221 0.01903952 0.02071108 0.02233719
 0.02393897 0.02537196 0.02701755 0.02841484 0.02995333 0.03135386
 0.03289397 0.03438863 0.03588492 0.03741691 0.03876714 0.04022123
 0.04150979 0.04292656 0.04406094 0.04535437 0.0467192  0.04802237]
MRR_all_avg_next:
 [0.00166507 0.00280838 0.003543   0.00406434 0.00445091 0.00475845
 0.00503294 0.00523743 0.00542586 0.00560259 0.00575455 0.00589006
 0.00601327 0.00611563 0.00622533 0.00631267 0.00640316 0.00648097
 0.00656203 0.00663676 0.00670802 0.00677765 0.00683636 0.00689694
 0.00694849 0.00700298 0.00704499 0.00709119 0.00713825 0.00718169]
record_num:
 616192.0
=========== testing next new item epoch: 29 ===========
recall_all_avg_next_new:
 [0.00164614 0.00391515 0.00609517 0.00817732 0.01010523 0.01194417
 0.01382166 0.01544407 0.01711098 0.01887873 0.02055749 0.02213542
 0.023743   0.02516669 0.0268158  0.0282039  0.02973733 0.03112543
 0.03263513 0.03411814 0.03560115 0.03713162 0.03849302 0.03994341
 0.04123659 0.04263656 0.04375475 0.04503013 0.04637078 0.04767583]
MRR_all_avg_next_new:
 [0.00164614 0.00278064 0.00350732 0.00402786 0.00441344 0.00471993
 0.00498814 0.00519094 0.00537615 0.00555293 0.00570554 0.00583704
 0.0059607  0.00606239 0.00617233 0.00625909 0.00634929 0.00642641
 0.00650586 0.00658001 0.00665063 0.0067202  0.00677939 0.00683983
 0.00689155 0.0069454  0.00698681 0.00703236 0.00707859 0.00712209]
record_num_new:
 337152.0
all_loss 1356915.269645691
all_loss 1353648.751548767
all_loss 1350585.0546226501
all_loss 1347643.977657318
all_loss 1345007.1366653442
all_loss 1342560.0167732239
all_loss 1340184.7490577698
all_loss 1338062.7455863953
all_loss 1335965.1322288513
all_loss 1333969.262397766
eval ...
~~~~~~~~~~~~~ testing next item epoch: 39 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00167643 0.00408477 0.0063292  0.0083448  0.0102322  0.01217478
 0.01387555 0.01553574 0.01743937 0.01933813 0.02088797 0.02255953
 0.02427815 0.02592536 0.02745573 0.02902504 0.03064954 0.03211986
 0.03356259 0.03501993 0.03643345 0.03808391 0.03959156 0.04103429
 0.04248027 0.04391002 0.04542578 0.04680197 0.04835181 0.04971178]
MRR_all_avg_next:
 [0.00167643 0.0028806  0.00362874 0.00413264 0.00451012 0.00483388
 0.00507685 0.00528437 0.00549589 0.00568576 0.00582666 0.00596596
 0.00609816 0.00621582 0.00631784 0.00641592 0.00651148 0.00659316
 0.0066691  0.00674197 0.00680928 0.0068843  0.00694985 0.00700996
 0.0070678  0.00712279 0.00717893 0.00722808 0.00728152 0.00732685]
record_num:
 616192.0
=========== testing next new item epoch: 39 ===========
recall_all_avg_next_new:
 [0.00165504 0.00404269 0.00628203 0.0082752  0.01016752 0.01207467
 0.01376234 0.01542628 0.01731563 0.01919609 0.02071766 0.02240236
 0.02410189 0.0257243  0.0272518  0.02882676 0.03044028 0.03190252
 0.03332325 0.0347944  0.03620622 0.0378583  0.0393591  0.04079169
 0.04222131 0.04362424 0.04514284 0.04652501 0.04805548 0.04941095]
MRR_all_avg_next_new:
 [0.00165504 0.00284886 0.00359531 0.0040936  0.00447207 0.00478993
 0.00503102 0.00523901 0.00544894 0.00563699 0.00577531 0.0059157
 0.00604644 0.00616232 0.00626416 0.00636259 0.0064575  0.00653874
 0.00661352 0.00668707 0.0067543  0.0068294  0.00689465 0.00695434
 0.00701153 0.00706548 0.00712173 0.00717109 0.00722387 0.00726905]
record_num_new:
 337152.0
all_loss 1332186.6851234436
all_loss 1330358.6930770874
all_loss 1328684.6852645874
all_loss 1327137.1057014465
all_loss 1325521.5899353027
all_loss 1324157.823890686
all_loss 1322698.2676010132
all_loss 1321373.1879768372
all_loss 1320107.4858283997
all_loss 1318852.7285842896
eval ...
~~~~~~~~~~~~~ testing next item epoch: 49 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00172187 0.00407665 0.00615879 0.00822795 0.01023058 0.01215043
 0.01391936 0.01583435 0.01763411 0.01946958 0.02121417 0.02303827
 0.02469198 0.02643657 0.02807566 0.02975371 0.03131491 0.0329248
 0.03448114 0.0361105  0.03767819 0.03919882 0.040588   0.04211512
 0.04366172 0.04538683 0.04696913 0.0483437  0.04965335 0.05110096]
MRR_all_avg_next:
 [0.00172187 0.00289926 0.00359331 0.0041106  0.00451112 0.0048311
 0.0050838  0.00532317 0.00552315 0.0057067  0.00586529 0.0060173
 0.00614451 0.00626912 0.0063784  0.00648328 0.00657511 0.00666455
 0.00674646 0.00682793 0.00690258 0.0069717  0.0070321  0.00709573
 0.00715759 0.00722394 0.00728255 0.00733164 0.0073768  0.00742505]
record_num:
 616192.0
=========== testing next new item epoch: 49 ===========
recall_all_avg_next_new:
 [0.00169656 0.00404862 0.0061189  0.00818325 0.01015566 0.01205094
 0.01380683 0.01572881 0.01752325 0.01932956 0.02108545 0.02289768
 0.02455866 0.02628191 0.02791619 0.02959199 0.03113729 0.03273301
 0.03431687 0.03591259 0.03746975 0.03897945 0.04036458 0.04186539
 0.04339882 0.04509835 0.04664365 0.04802582 0.04932197 0.05075456]
MRR_all_avg_next_new:
 [0.00169656 0.00287259 0.00356269 0.00407877 0.00447325 0.00478914
 0.00503998 0.00528022 0.00547961 0.00566024 0.00581986 0.00597088
 0.00609865 0.00622174 0.00633069 0.00643543 0.00652633 0.00661498
 0.00669834 0.00677813 0.00685228 0.0069209  0.00698112 0.00704366
 0.00710499 0.00717036 0.00722759 0.00727696 0.00732165 0.00736941]
record_num_new:
 337152.0
all_loss 1317716.2047080994
all_loss 1316500.136756897
all_loss 1315442.4707832336
all_loss 1314355.098892212
all_loss 1313324.997619629
all_loss 1312292.1436309814
all_loss 1311408.7077140808
all_loss 1310417.1412963867
all_loss 1309584.6054000854
all_loss 1308669.918258667
eval ...
~~~~~~~~~~~~~ testing next item epoch: 59 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00162612 0.00398415 0.00627726 0.00839186 0.01045129 0.01228838
 0.01420337 0.01587005 0.01778504 0.01956371 0.02139431 0.02308858
 0.02503927 0.02659885 0.02845542 0.03024869 0.03200626 0.03354636
 0.03509296 0.03668013 0.0383955  0.03992749 0.04149356 0.0430223
 0.04457701 0.04604896 0.04759555 0.0491811  0.05065304 0.05213797]
MRR_all_avg_next:
 [0.00162612 0.00280513 0.0035695  0.00409815 0.00451004 0.00481622
 0.00508979 0.00529813 0.0055109  0.00568877 0.00585519 0.00599638
 0.00614643 0.00625783 0.0063816  0.00649368 0.00659707 0.00668263
 0.00676403 0.00684339 0.00692507 0.00699471 0.0070628  0.00712649
 0.00718868 0.00724529 0.00730258 0.0073592  0.00740996 0.00745946]
record_num:
 616192.0
=========== testing next new item epoch: 59 ===========
recall_all_avg_next_new:
 [0.00161055 0.00396557 0.00623458 0.00832562 0.01036328 0.01218442
 0.0140886  0.01574364 0.01765672 0.01945117 0.02128417 0.02294811
 0.02492348 0.0264836  0.02830474 0.03010215 0.03183727 0.03337664
 0.03488931 0.03643461 0.03812227 0.03964681 0.04120397 0.04272554
 0.04425897 0.04570639 0.04722796 0.04880588 0.0502444  0.05174817]
MRR_all_avg_next_new:
 [0.00161055 0.00278806 0.0035444  0.00406716 0.00447469 0.00477821
 0.00505024 0.00525712 0.00546968 0.00564913 0.00581576 0.00595442
 0.00610638 0.00621781 0.00633922 0.00645156 0.00655363 0.00663915
 0.00671876 0.00679603 0.00687639 0.00694569 0.00701339 0.00707679
 0.00713813 0.0071938  0.00725015 0.00730651 0.00735611 0.00740624]
record_num_new:
 337152.0
all_loss 1307816.8386802673
all_loss 1307020.100845337
all_loss 1306204.2620048523
all_loss 1305423.3424568176
all_loss 1304694.195602417
all_loss 1303961.1798057556
all_loss 1303204.7144546509
all_loss 1302538.3658447266
all_loss 1301818.4832382202
all_loss 1301128.3878364563
eval ...
~~~~~~~~~~~~~ testing next item epoch: 69 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00164884 0.0038884  0.00626104 0.00826041 0.01044155 0.01239386
 0.01421797 0.01618651 0.01798952 0.01981688 0.02174322 0.0235722
 0.02534275 0.02709545 0.02888061 0.0304483  0.03231136 0.03397642
 0.03551166 0.03704365 0.03864542 0.04015631 0.04170778 0.04328683
 0.04490159 0.04652284 0.04801426 0.04933852 0.05093218 0.05244794]
MRR_all_avg_next:
 [0.00164884 0.00276862 0.0035595  0.00405934 0.00449557 0.00482095
 0.00508154 0.00532761 0.00552794 0.00571068 0.0058858  0.00603822
 0.00617441 0.0062996  0.00641862 0.0065166  0.00662619 0.00671869
 0.00679949 0.00687609 0.00695237 0.00702104 0.0070885  0.00715429
 0.00721888 0.00728124 0.00733648 0.00738377 0.00743873 0.00748925]
record_num:
 616192.0
=========== testing next new item epoch: 69 ===========
recall_all_avg_next_new:
 [0.00161945 0.00384396 0.00619898 0.00819808 0.01035735 0.01229712
 0.01414199 0.0161055  0.01791477 0.01970328 0.02163119 0.02344936
 0.02520525 0.02694037 0.02869032 0.03024452 0.03207752 0.03373849
 0.03527192 0.03683502 0.03840701 0.03990485 0.04144718 0.04302807
 0.04462972 0.04622544 0.04769362 0.04901943 0.05060032 0.05211596]
MRR_all_avg_next_new:
 [0.00161945 0.00273171 0.00351671 0.00401649 0.00444834 0.00477164
 0.00503519 0.00528063 0.00548166 0.00566051 0.00583577 0.00598729
 0.00612236 0.00624629 0.00636296 0.00646009 0.00656792 0.00666019
 0.0067409  0.00681905 0.00689391 0.006962   0.00702905 0.00709492
 0.00715899 0.00722036 0.00727474 0.00732209 0.0073766  0.00742713]
record_num_new:
 337152.0
all_loss 1300501.3772697449
all_loss 1299906.870689392
all_loss 1299214.0722503662
all_loss 1298676.3277130127
all_loss 1298083.8604011536
all_loss 1297520.403869629
all_loss 1296894.0710906982
all_loss 1296341.0823669434
all_loss 1295783.6459503174
all_loss 1295325.4954032898
eval ...
~~~~~~~~~~~~~ testing next item epoch: 79 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00158879 0.00395656 0.00641196 0.0084438  0.01043019 0.01243281
 0.01428289 0.01608103 0.01801549 0.01996131 0.02189415 0.02376857
 0.02551964 0.0273048  0.02910294 0.03088161 0.03256128 0.03427341
 0.03585084 0.03731305 0.03876876 0.04050523 0.04212486 0.04360492
 0.04526998 0.04688474 0.04834694 0.04994385 0.0513525  0.05276115]
MRR_all_avg_next:
 [0.00158879 0.00277267 0.00359114 0.0040991  0.00449638 0.00483015
 0.00509445 0.00531921 0.00553415 0.00572874 0.00590445 0.00606065
 0.00619535 0.00632286 0.00644274 0.0065539  0.00665271 0.00674783
 0.00683085 0.00690396 0.00697328 0.00705221 0.00712263 0.0071843
 0.0072509  0.007313   0.00736716 0.00742419 0.00747277 0.00751972]
record_num:
 616192.0
=========== testing next new item epoch: 79 ===========
recall_all_avg_next_new:
 [0.00158089 0.00390032 0.00635322 0.00839087 0.01036624 0.01237721
 0.01422207 0.01603134 0.01795036 0.01986641 0.0217617  0.02361843
 0.02535355 0.02713909 0.02891574 0.03068646 0.03232667 0.03402916
 0.03557446 0.03702188 0.0384693  0.04019552 0.0418031  0.04325645
 0.04492336 0.04651315 0.04798726 0.04957705 0.05099777 0.0524096 ]
MRR_all_avg_next_new:
 [0.00158089 0.0027406  0.00355824 0.00406765 0.00446273 0.00479789
 0.00506144 0.0052876  0.00550082 0.00569243 0.00586472 0.00601945
 0.00615292 0.00628046 0.0063989  0.00650957 0.00660606 0.00670064
 0.00678197 0.00685434 0.00692327 0.00700173 0.00707163 0.00713218
 0.00719886 0.00726001 0.0073146  0.00737138 0.00742037 0.00746743]
record_num_new:
 337152.0
all_loss 1294759.9115028381
all_loss 1294243.6962471008
all_loss 1293756.2117538452
all_loss 1293272.4489250183
all_loss 1292722.1699829102
all_loss 1292333.4897346497
all_loss 1291881.8918876648
all_loss 1291350.5298118591
all_loss 1290885.6222496033
all_loss 1290520.763923645
eval ...
~~~~~~~~~~~~~ testing next item epoch: 89 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00165371 0.00393871 0.00620586 0.00836752 0.01054055 0.01248637
 0.01437214 0.01641209 0.01836116 0.02019176 0.02209052 0.02394384
 0.02587505 0.0276667  0.02945024 0.0312143  0.03298647 0.03482356
 0.03642696 0.03804009 0.03970678 0.04125987 0.04279997 0.04433683
 0.0460733  0.04772538 0.04917136 0.05070335 0.05216556 0.05354338]
MRR_all_avg_next:
 [0.00165371 0.00279621 0.00355192 0.00409234 0.00452694 0.00485125
 0.00512064 0.00537564 0.0055922  0.00577526 0.00594788 0.00610232
 0.00625087 0.00637885 0.00649775 0.006608   0.00671225 0.00681431
 0.0068987  0.00697936 0.00705872 0.00712932 0.00719628 0.00726031
 0.00732977 0.00739331 0.00744687 0.00750158 0.007552   0.00759793]
record_num:
 616192.0
=========== testing next new item epoch: 89 ===========
recall_all_avg_next_new:
 [0.00164021 0.00388549 0.0061456  0.00829893 0.01050861 0.01243653
 0.01432292 0.01635464 0.01826179 0.02009479 0.02199601 0.02383495
 0.0257332  0.02748612 0.02923311 0.03097713 0.03273004 0.03456008
 0.0361736  0.03775448 0.03939766 0.04097262 0.04251198 0.04403948
 0.04575088 0.04738219 0.04885037 0.05035711 0.05181343 0.05320152]
MRR_all_avg_next_new:
 [0.00164021 0.00276285 0.00351622 0.00405455 0.00449649 0.00481781
 0.00508729 0.00534126 0.00555316 0.00573646 0.0059093  0.00606255
 0.00620856 0.00633377 0.00645024 0.00655924 0.00666235 0.00676402
 0.00684894 0.00692799 0.00700623 0.00707782 0.00714475 0.0072084
 0.00727685 0.0073396  0.00739397 0.00744779 0.007498   0.00754427]
record_num_new:
 337152.0
all_loss 1290048.5404510498
all_loss 1289621.2979431152
all_loss 1289252.0164146423
all_loss 1288818.5839233398
all_loss 1288441.3524017334
all_loss 1287965.421661377
all_loss 1287608.03207016
all_loss 1287240.3002166748
all_loss 1286844.77526474
all_loss 1286495.4135894775
eval ...
~~~~~~~~~~~~~ testing next item epoch: 99 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00162287 0.00410262 0.00625292 0.00845678 0.01057625 0.01256589
 0.0144971  0.01649973 0.01844393 0.02041571 0.02238426 0.0243171
 0.02614607 0.02799452 0.02980727 0.03155835 0.03329157 0.03492905
 0.03648863 0.03821861 0.0398431  0.04148707 0.04311968 0.04483992
 0.0463427  0.04803535 0.04950567 0.05097437 0.05235381 0.05397831]
MRR_all_avg_next:
 [0.00162287 0.00286274 0.00357951 0.00413048 0.00455437 0.00488598
 0.00516187 0.00541219 0.00562822 0.00582539 0.00600435 0.00616542
 0.00630611 0.00643814 0.00655899 0.00666844 0.00677039 0.00686136
 0.00694345 0.00702994 0.0071073  0.00718203 0.00725301 0.00732469
 0.0073848  0.0074499  0.00750436 0.00755681 0.00760438 0.00765853]
record_num:
 616192.0
=========== testing next new item epoch: 99 ===========
recall_all_avg_next_new:
 [0.00160462 0.00403972 0.00621085 0.00845316 0.01053827 0.01251068
 0.01444156 0.01642286 0.01834781 0.02030242 0.02227185 0.02417011
 0.02597048 0.02779755 0.02960386 0.03131822 0.03302665 0.03464609
 0.03619732 0.03792058 0.03955189 0.04116838 0.04279375 0.04449328
 0.04600299 0.04767286 0.04913807 0.05057659 0.05199139 0.05359304]
MRR_all_avg_next_new:
 [0.00160462 0.00282217 0.00354588 0.00410646 0.00452348 0.00485221
 0.00512805 0.00537572 0.0055896  0.00578506 0.0059641  0.00612229
 0.00626078 0.00639128 0.0065117  0.00661885 0.00671935 0.00680932
 0.00689096 0.00697712 0.0070548  0.00712828 0.00719895 0.00726976
 0.00733015 0.00739438 0.00744864 0.00750002 0.00754881 0.00760219]
record_num_new:
 337152.0
------------- end top_n_item is: 50 -----------------
------------- end top_n_item is: 50 -----------------
xiami
============================================
+++++++++++++ start top_n_item is: 10 ++++++++++++++++
+++++++++++++ start top_n_item is: 10 ++++++++++++++++
init hrm ... 
init data_generation
------------------------------
Test records (next-new):218593
------------------------------
Test records (next-item):612641
building model ... 
running ... 
2022-07-08 18:59:12.005990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:5e:00.0)
2022-07-08 18:59:12.006045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:1) -> (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:b1:00.0)
all_loss 3011032.6581573486
eval ...
~~~~~~~~~~~~~ testing next item epoch: 0 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00044881 0.00075073 0.00099227 0.00141986 0.00173484 0.00237296
 0.00280545 0.00307963 0.00345663 0.00379119 0.00407027 0.00443421
 0.00472961 0.00498583 0.00527144 0.00558152 0.00596505 0.00630614
 0.00663255 0.00690346 0.00721028 0.00748773 0.00784024 0.00813074
 0.0083984  0.00868563 0.00904468 0.00937272 0.00970075 0.01007775]
MRR_all_avg_next:
 [0.00044881 0.00059977 0.00068028 0.00078718 0.00085018 0.00095653
 0.00101831 0.00105259 0.00109447 0.00112793 0.0011533  0.00118363
 0.00120635 0.00122465 0.00124369 0.00126308 0.00128564 0.00130459
 0.00132176 0.00133531 0.00134992 0.00136253 0.00137786 0.00138996
 0.00140067 0.00141172 0.00142501 0.00143673 0.00144804 0.00146061]
record_num:
 612736.0
=========== testing next new item epoch: 0 ===========
recall_all_avg_next_new:
 [0.00044826 0.00076387 0.00100172 0.00145455 0.00177016 0.00238309
 0.00281305 0.00307834 0.00345342 0.00379647 0.00408464 0.00444599
 0.0047433  0.00500403 0.00530134 0.0056078  0.00598287 0.0063305
 0.00665984 0.00694343 0.00725446 0.00752891 0.00790398 0.00820587
 0.00847117 0.00875933 0.00910696 0.00942714 0.00975648 0.01014527]
MRR_all_avg_next_new:
 [0.00044826 0.00060606 0.00068535 0.00079856 0.00086168 0.00096383
 0.00102525 0.00105842 0.00110009 0.0011344  0.00116059 0.00119071
 0.00121358 0.0012322  0.00125202 0.00127117 0.00129324 0.00131255
 0.00132988 0.00134406 0.00135887 0.00137135 0.00138766 0.00140024
 0.00141085 0.00142193 0.00143481 0.00144624 0.0014576  0.00147056]
record_num_new:
 218624.0
all_loss 2618047.7727737427
all_loss 2398793.4228668213
all_loss 2180020.2671966553
all_loss 1990516.2474060059
all_loss 1839086.458847046
all_loss 1720916.4802780151
all_loss 1629680.224143982
all_loss 1559772.127708435
all_loss 1506535.0766677856
eval ...
~~~~~~~~~~~~~ testing next item epoch: 9 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00144108 0.00294091 0.00448154 0.00576594 0.00725761 0.00862851
 0.01002879 0.01128545 0.01279181 0.01405826 0.01523331 0.01648671
 0.0175769  0.01883356 0.0199515  0.02102863 0.022189   0.02319596
 0.02439223 0.02540572 0.02654651 0.0275094  0.02847719 0.02952495
 0.03042909 0.03140994 0.03242506 0.03331941 0.03416806 0.03501834]
MRR_all_avg_next:
 [0.00144108 0.00219099 0.00270454 0.00302564 0.00332397 0.00355245
 0.00375249 0.00390958 0.00407695 0.00420359 0.00431042 0.00441487
 0.00449873 0.00458849 0.00466302 0.00473034 0.0047986  0.00485454
 0.0049175  0.00496818 0.0050225  0.00506627 0.00510834 0.005152
 0.00518817 0.00522589 0.00526349 0.00529543 0.00532469 0.00535304]
record_num:
 612736.0
=========== testing next new item epoch: 9 ===========
recall_all_avg_next_new:
 [0.00145913 0.00298229 0.00452832 0.00581821 0.00735052 0.00874103
 0.01013155 0.01138942 0.01288971 0.0141613  0.01535513 0.016613
 0.01771077 0.01894577 0.02005269 0.0211276  0.022326   0.02334144
 0.02456272 0.02560561 0.02673997 0.02771425 0.02866108 0.02969482
 0.03061421 0.03160678 0.03261307 0.03349587 0.03434664 0.03520199]
MRR_all_avg_next_new:
 [0.00145913 0.00222071 0.00273605 0.00305852 0.00336499 0.00359674
 0.00379538 0.00395262 0.00411932 0.00424647 0.00435501 0.00445983
 0.00454427 0.00463249 0.00470628 0.00477346 0.00484396 0.00490037
 0.00496465 0.00501679 0.00507081 0.00511509 0.00515626 0.00519933
 0.00523611 0.00527428 0.00531156 0.00534308 0.00537242 0.00540093]
record_num_new:
 218624.0
all_loss 1465822.9023017883
all_loss 1434267.787197113
all_loss 1409669.3202056885
all_loss 1389889.3266868591
all_loss 1373924.3542480469
all_loss 1360770.071964264
all_loss 1349794.1560707092
all_loss 1340509.0660591125
all_loss 1332673.2320327759
all_loss 1325745.41664505
eval ...
~~~~~~~~~~~~~ testing next item epoch: 19 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00129746 0.00260797 0.0039446  0.00523227 0.00677453 0.00817644
 0.00951307 0.01094925 0.01215532 0.01353274 0.01493629 0.01632514
 0.01753447 0.01873564 0.01999066 0.02123427 0.02246971 0.02382592
 0.02515765 0.0263474  0.02750614 0.02866324 0.02973548 0.03077671
 0.03186854 0.03289508 0.03388898 0.03496286 0.03598777 0.03698983]
MRR_all_avg_next:
 [0.00129746 0.00195272 0.00239826 0.00272018 0.00302863 0.00326228
 0.00345323 0.00363275 0.00376676 0.0039045  0.00403209 0.00414783
 0.00424086 0.00432666 0.00441032 0.00448805 0.00456072 0.00463607
 0.00470616 0.00476565 0.00482082 0.00487342 0.00492004 0.00496342
 0.0050071  0.00504658 0.00508339 0.00512174 0.00515708 0.00519049]
record_num:
 612736.0
=========== testing next new item epoch: 19 ===========
recall_all_avg_next_new:
 [0.00130818 0.00261179 0.00396114 0.00526017 0.00681993 0.00824246
 0.0096284  0.01107381 0.01228593 0.01369017 0.01509441 0.01646663
 0.01767418 0.01886801 0.02014417 0.02140204 0.02264619 0.02398639
 0.02531744 0.02651127 0.02764564 0.0288166  0.0299098  0.03097556
 0.03206876 0.03311622 0.03411336 0.03517912 0.03621286 0.03725117]
MRR_all_avg_next_new:
 [0.00130818 0.00195999 0.00240977 0.00273453 0.00304648 0.00328357
 0.00348156 0.00366223 0.00379692 0.00393734 0.004065   0.00417935
 0.00427224 0.00435751 0.00444259 0.00452121 0.00459439 0.00466885
 0.0047389  0.00479859 0.00485261 0.00490584 0.00495337 0.00499777
 0.0050415  0.00508179 0.00511872 0.00515678 0.00519243 0.00522704]
record_num_new:
 218624.0
all_loss 1319719.3580513
all_loss 1314525.4033927917
all_loss 1309729.4810447693
all_loss 1305543.5992393494
all_loss 1301648.4583740234
all_loss 1298277.3092842102
all_loss 1295088.1327323914
all_loss 1292153.5533561707
all_loss 1289498.4683113098
all_loss 1286978.2341384888
eval ...
~~~~~~~~~~~~~ testing next item epoch: 29 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00108366 0.00246762 0.00373897 0.00526165 0.00682513 0.00832006
 0.0098868  0.01113367 0.0124295  0.01368452 0.0152121  0.01663522
 0.017949   0.01921219 0.02052434 0.02195073 0.02327103 0.02467784
 0.02600631 0.02714056 0.02837764 0.02961634 0.03062167 0.03181631
 0.03311214 0.03424966 0.035317   0.03642025 0.03749249 0.03861043]
MRR_all_avg_next:
 [0.00108366 0.00177564 0.00219942 0.00258009 0.00289279 0.00314195
 0.00336577 0.00352162 0.00366561 0.00379111 0.00392998 0.00404857
 0.00414963 0.00423986 0.00432734 0.00441649 0.00449415 0.00457231
 0.00464223 0.00469894 0.00475785 0.00481415 0.00485786 0.00490764
 0.00495947 0.00500322 0.00504275 0.00508216 0.00511913 0.00515639]
record_num:
 612736.0
=========== testing next new item epoch: 29 ===========
recall_all_avg_next_new:
 [0.0010932  0.00247914 0.00375073 0.00527389 0.00687482 0.00838883
 0.00996231 0.01124762 0.01255123 0.01379995 0.01533683 0.01676394
 0.01808127 0.01935744 0.02065647 0.02206528 0.02338261 0.02480972
 0.02614992 0.02732545 0.02854673 0.02978173 0.03079717 0.031991
 0.03330375 0.03447471 0.03554047 0.03663825 0.037704   0.03880178]
MRR_all_avg_next_new:
 [0.0010932  0.00178617 0.00221003 0.00259083 0.00291101 0.00316335
 0.00338813 0.00354879 0.00369364 0.00381851 0.00395823 0.00407715
 0.00417849 0.00426964 0.00435624 0.00444429 0.00452178 0.00460107
 0.0046716  0.00473038 0.00478854 0.00484467 0.00488882 0.00493856
 0.00499108 0.00503611 0.00507558 0.00511479 0.00515154 0.00518813]
record_num_new:
 218624.0
all_loss 1284706.8442840576
all_loss 1282485.8114776611
all_loss 1280449.7041778564
all_loss 1278600.503604889
all_loss 1276720.035823822
all_loss 1275119.7631263733
all_loss 1273500.5876197815
all_loss 1271957.5652923584
all_loss 1270528.8119277954
all_loss 1269157.6146736145
eval ...
~~~~~~~~~~~~~ testing next item epoch: 39 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00101838 0.00229299 0.00370633 0.00526001 0.00672231 0.008307
 0.00970728 0.01116141 0.01262371 0.01397339 0.01538509 0.01673967
 0.01816933 0.01947331 0.02062552 0.02205191 0.02340649 0.02460113
 0.02590349 0.02708671 0.02834173 0.02965551 0.03071633 0.03178204
 0.03309092 0.03451894 0.03572991 0.03674829 0.03787275 0.03899232]
MRR_all_avg_next:
 [0.00101838 0.00165569 0.0021268  0.00251522 0.00280768 0.0030718
 0.00327184 0.0034536  0.00361608 0.00375105 0.00387938 0.00399227
 0.00410224 0.00419538 0.0042722  0.00436134 0.00444103 0.00450739
 0.00457594 0.0046351  0.00469486 0.00475458 0.0048007  0.00484511
 0.00489746 0.00495239 0.00499724 0.00503361 0.00507238 0.0051097 ]
record_num:
 612736.0
=========== testing next new item epoch: 39 ===========
recall_all_avg_next_new:
 [0.00102002 0.00230533 0.00372786 0.00528762 0.00677419 0.00836596
 0.00981137 0.01127049 0.01274791 0.01408354 0.01549235 0.01683255
 0.01824136 0.01958156 0.0207388  0.02217048 0.02353356 0.02473653
 0.02604014 0.02726599 0.02850556 0.02984119 0.03090695 0.03200015
 0.03330833 0.03475831 0.03597501 0.03701789 0.03816141 0.03927748]
MRR_all_avg_next_new:
 [0.00102002 0.00166267 0.00213685 0.00252679 0.0028241  0.0030894
 0.00329588 0.00347828 0.00364243 0.003776   0.00390407 0.00401575
 0.00412412 0.00421985 0.004297   0.00438648 0.00446666 0.00453349
 0.00460211 0.0046634  0.00472242 0.00478314 0.00482947 0.00487502
 0.00492735 0.00498312 0.00502818 0.00506543 0.00510486 0.00514206]
record_num_new:
 218624.0
all_loss 1267878.8453178406
all_loss 1266597.808933258
all_loss 1265425.914051056
all_loss 1264286.1025161743
all_loss 1263184.3145141602
all_loss 1262174.0071144104
all_loss 1261083.1885032654
all_loss 1260172.648929596
all_loss 1259232.3511810303
all_loss 1258405.0642547607
eval ...
~~~~~~~~~~~~~ testing next item epoch: 49 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.0010755  0.00232237 0.0036541  0.00521921 0.00675332 0.00823356
 0.00982152 0.01110919 0.01249641 0.01403867 0.01533287 0.01671193
 0.01794084 0.01926768 0.02065    0.02203886 0.02347993 0.02485736
 0.02615319 0.02743433 0.02864039 0.02970447 0.03116677 0.03257194
 0.03364255 0.03478986 0.03611506 0.03731623 0.03834767 0.03944766]
MRR_all_avg_next:
 [0.0010755  0.00169894 0.00214285 0.00253413 0.00284095 0.00308765
 0.00331451 0.00347546 0.0036296  0.00378383 0.00390148 0.0040164
 0.00411093 0.00420571 0.00429786 0.00438467 0.00446943 0.00454596
 0.00461416 0.00467822 0.00473565 0.00478402 0.00484759 0.00490614
 0.00494897 0.00499309 0.00504218 0.00508507 0.00512064 0.00515731]
record_num:
 612736.0
=========== testing next new item epoch: 49 ===========
recall_all_avg_next_new:
 [0.0010749  0.0023099  0.0036684  0.00524188 0.00680163 0.00829735
 0.009912   0.0112156  0.0125924  0.01412013 0.01540544 0.01676852
 0.01801266 0.01934829 0.02076625 0.02214761 0.02359302 0.02496981
 0.02626885 0.02756331 0.02877543 0.02985948 0.03131861 0.03270913
 0.03378403 0.03494584 0.03626775 0.0374753  0.03850446 0.03962968]
MRR_all_avg_next_new:
 [0.0010749  0.0016924  0.00214524 0.00253861 0.00285056 0.00309984
 0.00333051 0.00349346 0.00364643 0.00379921 0.00391605 0.00402964
 0.00412535 0.00422075 0.00431528 0.00440162 0.00448664 0.00456313
 0.0046315  0.00469622 0.00475394 0.00480322 0.00486666 0.00492459
 0.00496759 0.00501228 0.00506124 0.00510436 0.00513985 0.00517736]
record_num_new:
 218624.0
all_loss 1257426.4829444885
all_loss 1256687.4399604797
all_loss 1255871.641658783
all_loss 1255016.690826416
all_loss 1254291.5250282288
all_loss 1253553.682975769
all_loss 1252796.8100852966
all_loss 1252152.4305343628
all_loss 1251454.7630958557
all_loss 1250878.1797981262
eval ...
~~~~~~~~~~~~~ testing next item epoch: 59 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00110978 0.00228483 0.00342235 0.00500215 0.00662439 0.00808668
 0.00959957 0.0110945  0.01250294 0.01406478 0.01534756 0.01680822
 0.01814648 0.01947005 0.02092092 0.0221025  0.0233102  0.02471374
 0.02586922 0.02712261 0.0285849  0.02981055 0.03101988 0.03229613
 0.03346302 0.03459075 0.03590617 0.03714487 0.03853372 0.03976101]
MRR_all_avg_next:
 [0.00110978 0.00169731 0.00207648 0.00247143 0.00279588 0.00303959
 0.00325572 0.00344258 0.00359908 0.00375526 0.00387188 0.0039936
 0.00409654 0.00419108 0.00428781 0.00436166 0.0044327  0.00451067
 0.00457149 0.00463416 0.00470379 0.0047595  0.00481208 0.00486526
 0.00491193 0.00495531 0.00500403 0.00504827 0.00509616 0.00513707]
record_num:
 612736.0
=========== testing next new item epoch: 59 ===========
recall_all_avg_next_new:
 [0.0011115  0.00230075 0.00347629 0.00505434 0.00667356 0.00814183
 0.00967872 0.01116986 0.01256953 0.01412471 0.01541459 0.01688287
 0.01823222 0.01957699 0.02102239 0.02223452 0.02346952 0.0248829
 0.02604472 0.02728429 0.02874799 0.02998756 0.03120883 0.032485
 0.03365138 0.03479947 0.0361351  0.03737467 0.03874232 0.03996359]
MRR_all_avg_next_new:
 [0.0011115  0.00170613 0.00209797 0.00249248 0.00281633 0.00306104
 0.00328059 0.00346699 0.00362251 0.00377802 0.00389529 0.00401764
 0.00412144 0.00421749 0.00431385 0.00438961 0.00446226 0.00454078
 0.00460193 0.00466391 0.00473361 0.00478995 0.00484305 0.00489622
 0.00494288 0.00498704 0.0050365  0.00508077 0.00512793 0.00516864]
record_num_new:
 218624.0
all_loss 1250178.099723816
all_loss 1249552.3174552917
all_loss 1248982.0696411133
all_loss 1248415.9431724548
all_loss 1247818.606552124
all_loss 1247277.7789649963
all_loss 1246749.436164856
all_loss 1246157.2701454163
all_loss 1245736.144153595
all_loss 1245237.1844406128
eval ...
~~~~~~~~~~~~~ testing next item epoch: 69 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00111467 0.00243988 0.0035725  0.00503479 0.00661786 0.00813727
 0.00952449 0.01122833 0.0125519  0.01413659 0.01569191 0.01699427
 0.01857896 0.02004615 0.02130771 0.02263944 0.02387488 0.02511685
 0.02657262 0.02790598 0.02947925 0.03085015 0.03215741 0.0333651
 0.03438185 0.03546715 0.03664058 0.03767528 0.03884218 0.04004661]
MRR_all_avg_next:
 [0.00111467 0.00177727 0.00215482 0.00252039 0.002837   0.00309024
 0.00328841 0.00350139 0.00364845 0.00380692 0.00394832 0.00405685
 0.00417875 0.00428355 0.00436765 0.00445088 0.00452356 0.00459255
 0.00466917 0.00473584 0.00481076 0.00487307 0.00492991 0.00498023
 0.0050209  0.00506264 0.0051061  0.00514306 0.00518329 0.00522344]
record_num:
 612736.0
=========== testing next new item epoch: 69 ===========
recall_all_avg_next_new:
 [0.00112522 0.00244712 0.00359979 0.00507721 0.00667356 0.00819215
 0.00959181 0.01130708 0.01266558 0.01427108 0.01583083 0.01712987
 0.0186942  0.02017162 0.02145236 0.02279256 0.02404128 0.02526713
 0.0267354  0.02809847 0.02964908 0.03103502 0.0323432  0.03356448
 0.03458449 0.03569142 0.03686695 0.03789611 0.03908994 0.04028835]
MRR_all_avg_next_new:
 [0.00112522 0.00178617 0.00217039 0.00253975 0.00285902 0.00311212
 0.00331207 0.00352648 0.00367742 0.00383797 0.00397977 0.00408802
 0.00420835 0.00431388 0.00439927 0.00448303 0.00455648 0.00462459
 0.00470186 0.00477002 0.00484385 0.00490685 0.00496373 0.00501462
 0.00505542 0.00509799 0.00514153 0.00517828 0.00521945 0.0052594 ]
record_num_new:
 218624.0
all_loss 1244673.900505066
all_loss 1244328.8512306213
all_loss 1243796.2563171387
all_loss 1243359.4610862732
all_loss 1242886.9607963562
all_loss 1242458.481994629
all_loss 1242022.3210601807
all_loss 1241668.685623169
all_loss 1241190.7174682617
all_loss 1240820.089389801
eval ...
~~~~~~~~~~~~~ testing next item epoch: 79 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00114405 0.00230279 0.00351701 0.00495809 0.00645955 0.00785983
 0.00924379 0.01070608 0.01235442 0.01389832 0.01523984 0.0167103
 0.01805019 0.01961693 0.02096009 0.02232609 0.0237737  0.02500424
 0.02631149 0.02763833 0.02894885 0.03036707 0.03163842 0.03286081
 0.03415664 0.03534312 0.03666506 0.03792824 0.03915389 0.04041055]
MRR_all_avg_next:
 [0.00114405 0.00172342 0.00212816 0.00248843 0.00278872 0.0030221
 0.00321981 0.0034026  0.00358575 0.00374013 0.00386209 0.00398463
 0.0040877  0.00419961 0.00428915 0.00437453 0.00445968 0.00452804
 0.00459685 0.00466319 0.00472559 0.00479006 0.00484533 0.00489627
 0.0049481  0.00499373 0.0050427  0.00508781 0.00513007 0.00517196]
record_num:
 612736.0
=========== testing next new item epoch: 79 ===========
recall_all_avg_next_new:
 [0.00114352 0.00232362 0.0035632  0.0050086  0.00650432 0.00789941
 0.00928077 0.0107399  0.01244145 0.01397834 0.01532311 0.01683255
 0.01819105 0.01974623 0.02109558 0.02246322 0.02392235 0.02517564
 0.02647925 0.02781488 0.02914593 0.03057761 0.03184005 0.03306133
 0.03436036 0.03554505 0.03685323 0.03813397 0.03935981 0.04060853]
MRR_all_avg_next_new:
 [0.00114352 0.00173357 0.00214676 0.00250811 0.00280726 0.00303977
 0.00323711 0.0034195  0.00360856 0.00376225 0.0038845  0.00401029
 0.00411479 0.00422587 0.00431583 0.00440131 0.00448714 0.00455676
 0.00462538 0.00469216 0.00475554 0.00482062 0.00487551 0.00492639
 0.00497835 0.00502392 0.00507237 0.00511811 0.00516038 0.005202  ]
record_num_new:
 218624.0
all_loss 1240524.6663856506
all_loss 1240064.2958602905
all_loss 1239708.5156326294
all_loss 1239280.0944404602
all_loss 1238955.4873809814
all_loss 1238586.1817741394
all_loss 1238287.5145568848
all_loss 1238010.5873069763
all_loss 1237656.0877609253
all_loss 1237315.5934524536
eval ...
~~~~~~~~~~~~~ testing next item epoch: 89 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00101838 0.00239092 0.00354802 0.00509028 0.00654279 0.00796265
 0.00962241 0.01123975 0.01293542 0.01440261 0.01579147 0.01702364
 0.01850552 0.01982093 0.02119183 0.02246155 0.02370678 0.02516908
 0.02660363 0.02797453 0.02926219 0.03055965 0.03181631 0.03288529
 0.03427251 0.03574949 0.03696208 0.0382367  0.03957169 0.04068473]
MRR_all_avg_next:
 [0.00101838 0.00170465 0.00209035 0.00247592 0.00276642 0.00300306
 0.00324017 0.00344234 0.00363075 0.00377746 0.00390372 0.00400641
 0.0041204  0.00421435 0.00430575 0.0043851  0.00445835 0.00453959
 0.00461509 0.00468364 0.00474496 0.00480393 0.00485857 0.00490311
 0.0049586  0.00501541 0.00506032 0.00510584 0.00515187 0.00518897]
record_num:
 612736.0
=========== testing next new item epoch: 89 ===========
recall_all_avg_next_new:
 [0.00102459 0.00240138 0.00359521 0.00513667 0.00660495 0.00804578
 0.00971531 0.01130251 0.01304065 0.01452722 0.01591774 0.01714359
 0.01862559 0.01994292 0.02131971 0.02260502 0.02384459 0.02531287
 0.02678114 0.02817623 0.02945697 0.03077887 0.03201844 0.0330842
 0.03446099 0.03596129 0.03718713 0.03845415 0.0397852  0.04090585]
MRR_all_avg_next_new:
 [0.00102459 0.00171299 0.00211093 0.0024963  0.00278995 0.00303009
 0.00326859 0.00346699 0.00366012 0.00380878 0.00393519 0.00403734
 0.00415134 0.00424544 0.00433722 0.00441755 0.00449047 0.00457204
 0.00464932 0.00471907 0.00478006 0.00484015 0.00489404 0.00493845
 0.00499352 0.00505122 0.00509663 0.00514188 0.00518777 0.00522513]
record_num_new:
 218624.0
all_loss 1236972.7236862183
all_loss 1236608.7948760986
all_loss 1236334.796409607
all_loss 1236173.9199943542
all_loss 1235734.3136291504
all_loss 1235465.9567070007
all_loss 1235190.375717163
all_loss 1234919.027053833
all_loss 1234650.459060669
all_loss 1234344.1813316345
eval ...
~~~~~~~~~~~~~ testing next item epoch: 99 ~~~~~~~~~~~~~
recall_all_avg_next:
 [0.00104613 0.00238112 0.00362636 0.00504622 0.00662928 0.00808015
 0.00955877 0.01126423 0.012924   0.01424431 0.01582084 0.01721133
 0.01868341 0.020242   0.02156394 0.02292341 0.02412458 0.02552486
 0.02669502 0.02787661 0.02940581 0.03074734 0.03199747 0.03316273
 0.03441939 0.03583436 0.03703063 0.03828566 0.03951783 0.04066678]
MRR_all_avg_next:
 [0.00104613 0.00171363 0.0021287  0.00248367 0.00280028 0.00304209
 0.00325332 0.00346651 0.00365093 0.00378296 0.00392628 0.00404215
 0.00415539 0.00426672 0.00435485 0.00443981 0.00451047 0.00458826
 0.00464985 0.00470893 0.00478175 0.00484273 0.00489708 0.00494563
 0.0049959  0.00505032 0.00509463 0.00513945 0.00518194 0.00522024]
record_num:
 612736.0
=========== testing next new item epoch: 99 ===========
recall_all_avg_next_new:
 [0.00105661 0.00239681 0.00367297 0.00509551 0.00667813 0.00814641
 0.00961925 0.0113574  0.01301321 0.01435341 0.01595433 0.0173174
 0.01880397 0.0203866  0.02170393 0.02305785 0.02427913 0.02566049
 0.02685433 0.02803901 0.02956674 0.03090237 0.03216481 0.03335407
 0.03460736 0.0360299  0.03722373 0.0384633  0.03967542 0.04082351]
MRR_all_avg_next_new:
 [0.00105661 0.00172671 0.0021521  0.00250773 0.00282426 0.00306897
 0.00327937 0.00349664 0.00368062 0.00381464 0.00396018 0.00407377
 0.00418812 0.00430117 0.00438899 0.00447361 0.00454545 0.00462219
 0.00468502 0.00474426 0.00481701 0.00487772 0.00493261 0.00498216
 0.00503229 0.005087   0.00513122 0.00517549 0.00521729 0.00525556]
record_num_new:
 218624.0
------------- end top_n_item is: 10 -----------------
------------- end top_n_item is: 10 -----------------
